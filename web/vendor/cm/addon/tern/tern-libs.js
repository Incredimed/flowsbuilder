!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.acorn=t.acorn||{})}(this,function(t){"use strict";function e(t,e){for(var r=65536,n=0;n<e.length;n+=2){if((r+=e[n])>t)return!1;if((r+=e[n+1])>=t)return!0}}function r(t,r){return t<65?36===t:t<91||(t<97?95===t:t<123||(t<=65535?t>=170&&E.test(String.fromCharCode(t)):!1!==r&&e(t,S)))}function n(t,r){return t<48?36===t:t<58||!(t<65)&&(t<91||(t<97?95===t:t<123||(t<=65535?t>=170&&A.test(String.fromCharCode(t)):!1!==r&&(e(t,S)||e(t,P)))))}function s(t,e){return new N(t,{beforeExpr:!0,binop:e})}function i(t,e){return void 0===e&&(e={}),e.keyword=t,I[t]=new N(t,e)}function o(t){return 10===t||13===t||8232===t||8233==t}function a(t){return"[object Array]"===Object.prototype.toString.call(t)}function p(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function u(t,e){for(var r=1,n=0;;){F.lastIndex=n;var s=F.exec(t);if(!(s&&s.index<e))return new D(r,e-n);++r,n=s.index+s[0].length}}function h(t){var e={};for(var r in V)e[r]=t&&p(t,r)?t[r]:V[r];if(null==e.allowReserved&&(e.allowReserved=e.ecmaVersion<5),a(e.onToken)){var n=e.onToken;e.onToken=function(t){return n.push(t)}}return a(e.onComment)&&(e.onComment=c(e,e.onComment)),e}function c(t,e){return function(r,n,s,i,o,a){var p={type:r?"Block":"Line",value:n,start:s,end:i};t.locations&&(p.loc=new M(this,o,a)),t.ranges&&(p.range=[s,i]),e.push(p)}}function l(t){return new RegExp("^("+t.replace(/ /g,"|")+")$")}function f(t,e,r,n){return t.type=e,t.end=r,this.options.locations&&(t.loc.end=n),this.options.ranges&&(t.range[1]=r),t}function d(t,e,r,n){try{return new RegExp(t,e)}catch(t){if(void 0!==r)throw t instanceof SyntaxError&&n.raise(r,"Error parsing regular expression: "+t.message),t}}function y(t){return t<=65535?String.fromCharCode(t):(t-=65536,String.fromCharCode(55296+(t>>10),56320+(1023&t)))}function m(t,e){return new q(e,t).parse()}function g(t,e,r){var n=new q(r,t,e);return n.nextToken(),n.parseExpression()}function v(t,e){return new q(e,t)}var x={3:"abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile",5:"class enum extends super const export import",6:"enum",7:"enum",strict:"implements interface let package private protected public static yield",strictBind:"eval arguments"},b="break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this",k={5:b,6:b+" const class extends export import super"},T="ªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽͿΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԯԱ-Ֆՙա-ևא-תװ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࢠ-ࢴࢶ-ࢽऄ-हऽॐक़-ॡॱ-ঀঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡૹଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-హఽౘ-ౚౠౡಀಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೞೠೡೱೲഅ-ഌഎ-ഐഒ-ഺഽൎൔ-ൖൟ-ൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏽᏸ-ᏽᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛮ-ᛸᜀ-ᜌᜎ-ᜑᜠ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡷᢀ-ᢨᢪᢰ-ᣵᤀ-ᤞᥐ-ᥭᥰ-ᥴᦀ-ᦫᦰ-ᧉᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭋᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᲀ-ᲈᳩ-ᳬᳮ-ᳱᳵᳶᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕ℘-ℝℤΩℨK-ℹℼ-ℿⅅ-ⅉⅎⅠ-ↈⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞ々-〇〡-〩〱-〵〸-〼ぁ-ゖ゛-ゟァ-ヺー-ヿㄅ-ㄭㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿕ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚝꚠ-ꛯꜗ-ꜟꜢ-ꞈꞋ-ꞮꞰ-ꞷꟷ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꣽꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꧠ-ꧤꧦ-ꧯꧺ-ꧾꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꩾ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꬰ-ꭚꭜ-ꭥꭰ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ",w="‌‍·̀-ͯ·҃-֑҇-ׇֽֿׁׂׅׄؐ-ًؚ-٩ٰۖ-ۜ۟-۪ۤۧۨ-ۭ۰-۹ܑܰ-݊ަ-ް߀-߉߫-߳ࠖ-࠙ࠛ-ࠣࠥ-ࠧࠩ-࡙࠭-࡛ࣔ-ࣣ࣡-ःऺ-़ा-ॏ॑-ॗॢॣ०-९ঁ-ঃ়া-ৄেৈো-্ৗৢৣ০-৯ਁ-ਃ਼ਾ-ੂੇੈੋ-੍ੑ੦-ੱੵઁ-ઃ઼ા-ૅે-ૉો-્ૢૣ૦-૯ଁ-ଃ଼ା-ୄେୈୋ-୍ୖୗୢୣ୦-୯ஂா-ூெ-ைொ-்ௗ௦-௯ఀ-ఃా-ౄె-ైొ-్ౕౖౢౣ౦-౯ಁ-ಃ಼ಾ-ೄೆ-ೈೊ-್ೕೖೢೣ೦-೯ഁ-ഃാ-ൄെ-ൈൊ-്ൗൢൣ൦-൯ංඃ්ා-ුූෘ-ෟ෦-෯ෲෳัิ-ฺ็-๎๐-๙ັິ-ູົຼ່-ໍ໐-໙༘༙༠-༩༹༵༷༾༿ཱ-྄྆྇ྍ-ྗྙ-ྼ࿆ါ-ှ၀-၉ၖ-ၙၞ-ၠၢ-ၤၧ-ၭၱ-ၴႂ-ႍႏ-ႝ፝-፟፩-፱ᜒ-᜔ᜲ-᜴ᝒᝓᝲᝳ឴-៓៝០-៩᠋-᠍᠐-᠙ᢩᤠ-ᤫᤰ-᤻᥆-᥏᧐-᧚ᨗ-ᨛᩕ-ᩞ᩠-᩿᩼-᪉᪐-᪙᪰-᪽ᬀ-ᬄ᬴-᭄᭐-᭙᭫-᭳ᮀ-ᮂᮡ-ᮭ᮰-᮹᯦-᯳ᰤ-᰷᱀-᱉᱐-᱙᳐-᳔᳒-᳨᳭ᳲ-᳴᳸᳹᷀-᷵᷻-᷿‿⁀⁔⃐-⃥⃜⃡-⃰⳯-⵿⳱ⷠ-〪ⷿ-゙゚〯꘠-꘩꙯ꙴ-꙽ꚞꚟ꛰꛱ꠂ꠆ꠋꠣ-ꠧꢀꢁꢴ-ꣅ꣐-꣙꣠-꣱꤀-꤉ꤦ-꤭ꥇ-꥓ꦀ-ꦃ꦳-꧀꧐-꧙ꧥ꧰-꧹ꨩ-ꨶꩃꩌꩍ꩐-꩙ꩻ-ꩽꪰꪲ-ꪴꪷꪸꪾ꪿꫁ꫫ-ꫯꫵ꫶ꯣ-ꯪ꯬꯭꯰-꯹ﬞ︀-️︠-︯︳︴﹍-﹏０-９＿",E=new RegExp("["+T+"]"),A=new RegExp("["+T+w+"]");T=w=null;var S=[0,11,2,25,2,18,2,1,2,14,3,13,35,122,70,52,268,28,4,48,48,31,17,26,6,37,11,29,3,35,5,7,2,4,43,157,19,35,5,35,5,39,9,51,157,310,10,21,11,7,153,5,3,0,2,43,2,1,4,0,3,22,11,22,10,30,66,18,2,1,11,21,11,25,71,55,7,1,65,0,16,3,2,2,2,26,45,28,4,28,36,7,2,27,28,53,11,21,11,18,14,17,111,72,56,50,14,50,785,52,76,44,33,24,27,35,42,34,4,0,13,47,15,3,22,0,2,0,36,17,2,24,85,6,2,0,2,3,2,14,2,9,8,46,39,7,3,1,3,21,2,6,2,1,2,4,4,0,19,0,13,4,159,52,19,3,54,47,21,1,2,0,185,46,42,3,37,47,21,0,60,42,86,25,391,63,32,0,449,56,264,8,2,36,18,0,50,29,881,921,103,110,18,195,2749,1070,4050,582,8634,568,8,30,114,29,19,47,17,3,32,20,6,18,881,68,12,0,67,12,65,0,32,6124,20,754,9486,1,3071,106,6,12,4,8,8,9,5991,84,2,70,2,1,3,0,3,1,3,3,2,11,2,0,2,6,2,64,2,3,3,7,2,6,2,27,2,3,2,4,2,0,4,6,2,339,3,24,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,7,4149,196,60,67,1213,3,2,26,2,1,2,0,3,0,2,9,2,3,2,0,2,0,7,0,5,0,2,0,2,0,2,2,2,1,2,0,3,0,2,0,2,0,2,0,2,0,2,1,2,0,3,3,2,6,2,3,2,3,2,0,2,9,2,16,6,2,2,4,2,16,4421,42710,42,4148,12,221,3,5761,10591,541],P=[509,0,227,0,150,4,294,9,1368,2,2,1,6,3,41,2,5,0,166,1,1306,2,54,14,32,9,16,3,46,10,54,9,7,2,37,13,2,9,52,0,13,2,49,13,10,2,4,9,83,11,7,0,161,11,6,9,7,3,57,0,2,6,3,1,3,2,10,0,11,1,3,6,4,4,193,17,10,9,87,19,13,9,214,6,3,8,28,1,83,16,16,9,82,12,9,9,84,14,5,9,423,9,838,7,2,7,17,9,57,21,2,13,19882,9,135,4,60,6,26,9,1016,45,17,3,19723,1,5319,4,4,5,9,7,3,6,31,3,149,2,1418,49,513,54,5,49,9,0,15,0,23,4,2,14,1361,6,2,16,3,6,2,1,2,4,2214,6,110,6,6,9,792487,239],N=function(t,e){void 0===e&&(e={}),this.label=t,this.keyword=e.keyword,this.beforeExpr=!!e.beforeExpr,this.startsExpr=!!e.startsExpr,this.isLoop=!!e.isLoop,this.isAssign=!!e.isAssign,this.prefix=!!e.prefix,this.postfix=!!e.postfix,this.binop=e.binop||null,this.updateContext=null},C={beforeExpr:!0},L={startsExpr:!0},I={},O={num:new N("num",L),regexp:new N("regexp",L),string:new N("string",L),name:new N("name",L),eof:new N("eof"),bracketL:new N("[",{beforeExpr:!0,startsExpr:!0}),bracketR:new N("]"),braceL:new N("{",{beforeExpr:!0,startsExpr:!0}),braceR:new N("}"),parenL:new N("(",{beforeExpr:!0,startsExpr:!0}),parenR:new N(")"),comma:new N(",",C),semi:new N(";",C),colon:new N(":",C),dot:new N("."),question:new N("?",C),arrow:new N("=>",C),template:new N("template"),ellipsis:new N("...",C),backQuote:new N("`",L),dollarBraceL:new N("${",{beforeExpr:!0,startsExpr:!0}),eq:new N("=",{beforeExpr:!0,isAssign:!0}),assign:new N("_=",{beforeExpr:!0,isAssign:!0}),incDec:new N("++/--",{prefix:!0,postfix:!0,startsExpr:!0}),prefix:new N("prefix",{beforeExpr:!0,prefix:!0,startsExpr:!0}),logicalOR:s("||",1),logicalAND:s("&&",2),bitwiseOR:s("|",3),bitwiseXOR:s("^",4),bitwiseAND:s("&",5),equality:s("==/!=",6),relational:s("</>",7),bitShift:s("<</>>",8),plusMin:new N("+/-",{beforeExpr:!0,binop:9,prefix:!0,startsExpr:!0}),modulo:s("%",10),star:s("*",10),slash:s("/",10),starstar:new N("**",{beforeExpr:!0}),_break:i("break"),_case:i("case",C),_catch:i("catch"),_continue:i("continue"),_debugger:i("debugger"),_default:i("default",C),_do:i("do",{isLoop:!0,beforeExpr:!0}),_else:i("else",C),_finally:i("finally"),_for:i("for",{isLoop:!0}),_function:i("function",L),_if:i("if"),_return:i("return",C),_switch:i("switch"),_throw:i("throw",C),_try:i("try"),_var:i("var"),_const:i("const"),_while:i("while",{isLoop:!0}),_with:i("with"),_new:i("new",{beforeExpr:!0,startsExpr:!0}),_this:i("this",L),_super:i("super",L),_class:i("class"),_extends:i("extends",C),_export:i("export"),_import:i("import"),_null:i("null",L),_true:i("true",L),_false:i("false",L),_in:i("in",{beforeExpr:!0,binop:7}),_instanceof:i("instanceof",{beforeExpr:!0,binop:7}),_typeof:i("typeof",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_void:i("void",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_delete:i("delete",{beforeExpr:!0,prefix:!0,startsExpr:!0})},_=/\r\n?|\n|\u2028|\u2029/,F=new RegExp(_.source,"g"),j=/[\u1680\u180e\u2000-\u200a\u202f\u205f\u3000\ufeff]/,R=/(?:\s|\/\/.*|\/\*[^]*?\*\/)*/g,D=function(t,e){this.line=t,this.column=e};D.prototype.offset=function(t){return new D(this.line,this.column+t)};var M=function(t,e,r){this.start=e,this.end=r,null!==t.sourceFile&&(this.source=t.sourceFile)},V={ecmaVersion:6,sourceType:"script",onInsertedSemicolon:null,onTrailingComma:null,allowReserved:null,allowReturnOutsideFunction:!1,allowImportExportEverywhere:!1,allowHashBang:!1,locations:!1,onToken:null,onComment:null,ranges:!1,program:null,sourceFile:null,directSourceFile:null,preserveParens:!1,plugins:{}},B={},q=function(t,e,r){this.options=t=h(t),this.sourceFile=t.sourceFile,this.keywords=l(k[t.ecmaVersion>=6?6:5]);var n=t.allowReserved?"":x[t.ecmaVersion]+("module"==t.sourceType?" await":"");this.reservedWords=l(n);var s=(n?n+" ":"")+x.strict;this.reservedWordsStrict=l(s),this.reservedWordsStrictBind=l(s+" "+x.strictBind),this.input=String(e),this.containsEsc=!1,this.loadPlugins(t.plugins),r?(this.pos=r,this.lineStart=Math.max(0,this.input.lastIndexOf("\n",r)),this.curLine=this.input.slice(0,this.lineStart).split(_).length):(this.pos=this.lineStart=0,this.curLine=1),this.type=O.eof,this.value=null,this.start=this.end=this.pos,this.startLoc=this.endLoc=this.curPosition(),this.lastTokEndLoc=this.lastTokStartLoc=null,this.lastTokStart=this.lastTokEnd=this.pos,this.context=this.initialContext(),this.exprAllowed=!0,this.strict=this.inModule="module"===t.sourceType,this.potentialArrowAt=-1,this.inFunction=this.inGenerator=!1,this.labels=[],0===this.pos&&t.allowHashBang&&"#!"===this.input.slice(0,2)&&this.skipLineComment(2)};q.prototype.isKeyword=function(t){return this.keywords.test(t)},q.prototype.isReservedWord=function(t){return this.reservedWords.test(t)},q.prototype.extend=function(t,e){this[t]=e(this[t])},q.prototype.loadPlugins=function(t){var e=this;for(var r in t){var n=B[r];if(!n)throw new Error("Plugin '"+r+"' not found");n(e,t[r])}},q.prototype.parse=function(){var t=this.options.program||this.startNode();return this.nextToken(),this.parseTopLevel(t)};var U=q.prototype;U.isUseStrict=function(t){return this.options.ecmaVersion>=5&&"ExpressionStatement"===t.type&&"Literal"===t.expression.type&&"use strict"===t.expression.raw.slice(1,-1)},U.eat=function(t){return this.type===t&&(this.next(),!0)},U.isContextual=function(t){return this.type===O.name&&this.value===t},U.eatContextual=function(t){return this.value===t&&this.eat(O.name)},U.expectContextual=function(t){this.eatContextual(t)||this.unexpected()},U.canInsertSemicolon=function(){return this.type===O.eof||this.type===O.braceR||_.test(this.input.slice(this.lastTokEnd,this.start))},U.insertSemicolon=function(){if(this.canInsertSemicolon())return this.options.onInsertedSemicolon&&this.options.onInsertedSemicolon(this.lastTokEnd,this.lastTokEndLoc),!0},U.semicolon=function(){this.eat(O.semi)||this.insertSemicolon()||this.unexpected()},U.afterTrailingComma=function(t){if(this.type==t)return this.options.onTrailingComma&&this.options.onTrailingComma(this.lastTokStart,this.lastTokStartLoc),this.next(),!0},U.expect=function(t){this.eat(t)||this.unexpected()},U.unexpected=function(t){this.raise(null!=t?t:this.start,"Unexpected token")};var W=function(){this.shorthandAssign=0,this.trailingComma=0};U.checkPatternErrors=function(t,e){var r=t&&t.trailingComma;if(!e)return!!r;r&&this.raise(r,"Comma is not permitted after the rest element")},U.checkExpressionErrors=function(t,e){var r=t&&t.shorthandAssign;if(!e)return!!r;r&&this.raise(r,"Shorthand property assignments are valid only in destructuring patterns")};var z=q.prototype;z.parseTopLevel=function(t){var e=this,r=!0;for(t.body||(t.body=[]);this.type!==O.eof;){var n=e.parseStatement(!0,!0);t.body.push(n),r&&(e.isUseStrict(n)&&e.setStrict(!0),r=!1)}return this.next(),this.options.ecmaVersion>=6&&(t.sourceType=this.options.sourceType),this.finishNode(t,"Program")};var G={kind:"loop"},$={kind:"switch"};z.isLet=function(){if(this.type!==O.name||this.options.ecmaVersion<6||"let"!=this.value)return!1;R.lastIndex=this.pos;var t=R.exec(this.input),e=this.pos+t[0].length,s=this.input.charCodeAt(e);if(91===s||123==s)return!0;if(r(s,!0)){for(var i=e+1;n(this.input.charCodeAt(i),!0);++i);var o=this.input.slice(e,i);if(!this.isKeyword(o))return!0}return!1},z.parseStatement=function(t,e){var r,n=this.type,s=this.startNode();switch(this.isLet()&&(n=O._var,r="let"),n){case O._break:case O._continue:return this.parseBreakContinueStatement(s,n.keyword);case O._debugger:return this.parseDebuggerStatement(s);case O._do:return this.parseDoStatement(s);case O._for:return this.parseForStatement(s);case O._function:return!t&&this.options.ecmaVersion>=6&&this.unexpected(),this.parseFunctionStatement(s);case O._class:return t||this.unexpected(),this.parseClass(s,!0);case O._if:return this.parseIfStatement(s);case O._return:return this.parseReturnStatement(s);case O._switch:return this.parseSwitchStatement(s);case O._throw:return this.parseThrowStatement(s);case O._try:return this.parseTryStatement(s);case O._const:case O._var:return r=r||this.value,t||"var"==r||this.unexpected(),this.parseVarStatement(s,r);case O._while:return this.parseWhileStatement(s);case O._with:return this.parseWithStatement(s);case O.braceL:return this.parseBlock();case O.semi:return this.parseEmptyStatement(s);case O._export:case O._import:return this.options.allowImportExportEverywhere||(e||this.raise(this.start,"'import' and 'export' may only appear at the top level"),this.inModule||this.raise(this.start,"'import' and 'export' may appear only with 'sourceType: module'")),n===O._import?this.parseImport(s):this.parseExport(s);default:var i=this.value,o=this.parseExpression();return n===O.name&&"Identifier"===o.type&&this.eat(O.colon)?this.parseLabeledStatement(s,i,o):this.parseExpressionStatement(s,o)}},z.parseBreakContinueStatement=function(t,e){var r=this,n="break"==e;this.next(),this.eat(O.semi)||this.insertSemicolon()?t.label=null:this.type!==O.name?this.unexpected():(t.label=this.parseIdent(),this.semicolon());for(var s=0;s<this.labels.length;++s){var i=r.labels[s];if(null==t.label||i.name===t.label.name){if(null!=i.kind&&(n||"loop"===i.kind))break;if(t.label&&n)break}}return s===this.labels.length&&this.raise(t.start,"Unsyntactic "+e),this.finishNode(t,n?"BreakStatement":"ContinueStatement")},z.parseDebuggerStatement=function(t){return this.next(),this.semicolon(),this.finishNode(t,"DebuggerStatement")},z.parseDoStatement=function(t){return this.next(),this.labels.push(G),t.body=this.parseStatement(!1),this.labels.pop(),this.expect(O._while),t.test=this.parseParenExpression(),this.options.ecmaVersion>=6?this.eat(O.semi):this.semicolon(),this.finishNode(t,"DoWhileStatement")},z.parseForStatement=function(t){if(this.next(),this.labels.push(G),this.expect(O.parenL),this.type===O.semi)return this.parseFor(t,null);var e=this.isLet();if(this.type===O._var||this.type===O._const||e){var r=this.startNode(),n=e?"let":this.value;return this.next(),this.parseVar(r,!0,n),this.finishNode(r,"VariableDeclaration"),!(this.type===O._in||this.options.ecmaVersion>=6&&this.isContextual("of"))||1!==r.declarations.length||"var"!==n&&r.declarations[0].init?this.parseFor(t,r):this.parseForIn(t,r)}var s=new W,i=this.parseExpression(!0,s);return this.type===O._in||this.options.ecmaVersion>=6&&this.isContextual("of")?(this.checkPatternErrors(s,!0),this.toAssignable(i),this.checkLVal(i),this.parseForIn(t,i)):(this.checkExpressionErrors(s,!0),this.parseFor(t,i))},z.parseFunctionStatement=function(t){return this.next(),this.parseFunction(t,!0)},z.parseIfStatement=function(t){return this.next(),t.test=this.parseParenExpression(),t.consequent=this.parseStatement(!1),t.alternate=this.eat(O._else)?this.parseStatement(!1):null,this.finishNode(t,"IfStatement")},z.parseReturnStatement=function(t){return this.inFunction||this.options.allowReturnOutsideFunction||this.raise(this.start,"'return' outside of function"),this.next(),this.eat(O.semi)||this.insertSemicolon()?t.argument=null:(t.argument=this.parseExpression(),this.semicolon()),this.finishNode(t,"ReturnStatement")},z.parseSwitchStatement=function(t){var e=this;this.next(),t.discriminant=this.parseParenExpression(),t.cases=[],this.expect(O.braceL),this.labels.push($);for(var r,n=!1;this.type!=O.braceR;)if(e.type===O._case||e.type===O._default){var s=e.type===O._case;r&&e.finishNode(r,"SwitchCase"),t.cases.push(r=e.startNode()),r.consequent=[],e.next(),s?r.test=e.parseExpression():(n&&e.raiseRecoverable(e.lastTokStart,"Multiple default clauses"),n=!0,r.test=null),e.expect(O.colon)}else r||e.unexpected(),r.consequent.push(e.parseStatement(!0));return r&&this.finishNode(r,"SwitchCase"),this.next(),this.labels.pop(),this.finishNode(t,"SwitchStatement")},z.parseThrowStatement=function(t){return this.next(),_.test(this.input.slice(this.lastTokEnd,this.start))&&this.raise(this.lastTokEnd,"Illegal newline after throw"),t.argument=this.parseExpression(),this.semicolon(),this.finishNode(t,"ThrowStatement")};var H=[];z.parseTryStatement=function(t){if(this.next(),t.block=this.parseBlock(),t.handler=null,this.type===O._catch){var e=this.startNode();this.next(),this.expect(O.parenL),e.param=this.parseBindingAtom(),this.checkLVal(e.param,!0),this.expect(O.parenR),e.body=this.parseBlock(),t.handler=this.finishNode(e,"CatchClause")}return t.finalizer=this.eat(O._finally)?this.parseBlock():null,t.handler||t.finalizer||this.raise(t.start,"Missing catch or finally clause"),this.finishNode(t,"TryStatement")},z.parseVarStatement=function(t,e){return this.next(),this.parseVar(t,!1,e),this.semicolon(),this.finishNode(t,"VariableDeclaration")},z.parseWhileStatement=function(t){return this.next(),t.test=this.parseParenExpression(),this.labels.push(G),t.body=this.parseStatement(!1),this.labels.pop(),this.finishNode(t,"WhileStatement")},z.parseWithStatement=function(t){return this.strict&&this.raise(this.start,"'with' in strict mode"),this.next(),t.object=this.parseParenExpression(),t.body=this.parseStatement(!1),this.finishNode(t,"WithStatement")},z.parseEmptyStatement=function(t){return this.next(),this.finishNode(t,"EmptyStatement")},z.parseLabeledStatement=function(t,e,r){for(var n=this,s=0;s<this.labels.length;++s)n.labels[s].name===e&&n.raise(r.start,"Label '"+e+"' is already declared");for(var i=this.type.isLoop?"loop":this.type===O._switch?"switch":null,o=this.labels.length-1;o>=0;o--){var a=n.labels[o];if(a.statementStart!=t.start)break;a.statementStart=n.start,a.kind=i}return this.labels.push({name:e,kind:i,statementStart:this.start}),t.body=this.parseStatement(!0),this.labels.pop(),t.label=r,this.finishNode(t,"LabeledStatement")},z.parseExpressionStatement=function(t,e){return t.expression=e,this.semicolon(),this.finishNode(t,"ExpressionStatement")},z.parseBlock=function(t){var e,r=this,n=this.startNode(),s=!0;for(n.body=[],this.expect(O.braceL);!this.eat(O.braceR);){var i=r.parseStatement(!0);n.body.push(i),s&&t&&r.isUseStrict(i)&&(e=r.strict,r.setStrict(r.strict=!0)),s=!1}return!1===e&&this.setStrict(!1),this.finishNode(n,"BlockStatement")},z.parseFor=function(t,e){return t.init=e,this.expect(O.semi),t.test=this.type===O.semi?null:this.parseExpression(),this.expect(O.semi),t.update=this.type===O.parenR?null:this.parseExpression(),this.expect(O.parenR),t.body=this.parseStatement(!1),this.labels.pop(),this.finishNode(t,"ForStatement")},z.parseForIn=function(t,e){var r=this.type===O._in?"ForInStatement":"ForOfStatement";return this.next(),t.left=e,t.right=this.parseExpression(),this.expect(O.parenR),t.body=this.parseStatement(!1),this.labels.pop(),this.finishNode(t,r)},z.parseVar=function(t,e,r){var n=this;for(t.declarations=[],t.kind=r;;){var s=n.startNode();if(n.parseVarId(s),n.eat(O.eq)?s.init=n.parseMaybeAssign(e):"const"!==r||n.type===O._in||n.options.ecmaVersion>=6&&n.isContextual("of")?"Identifier"==s.id.type||e&&(n.type===O._in||n.isContextual("of"))?s.init=null:n.raise(n.lastTokEnd,"Complex binding patterns require an initialization value"):n.unexpected(),t.declarations.push(n.finishNode(s,"VariableDeclarator")),!n.eat(O.comma))break}return t},z.parseVarId=function(t){t.id=this.parseBindingAtom(),this.checkLVal(t.id,!0)},z.parseFunction=function(t,e,r){this.initFunction(t),this.options.ecmaVersion>=6&&(t.generator=this.eat(O.star));var n=this.inGenerator;return this.inGenerator=t.generator,(e||this.type===O.name)&&(t.id=this.parseIdent()),this.parseFunctionParams(t),this.parseFunctionBody(t,r),this.inGenerator=n,this.finishNode(t,e?"FunctionDeclaration":"FunctionExpression")},z.parseFunctionParams=function(t){this.expect(O.parenL),t.params=this.parseBindingList(O.parenR,!1,!1,!0)},z.parseClass=function(t,e){var r=this;this.next(),this.parseClassId(t,e),this.parseClassSuper(t);var n=this.startNode(),s=!1;for(n.body=[],this.expect(O.braceL);!this.eat(O.braceR);)if(!r.eat(O.semi)){var i=r.startNode(),o=r.eat(O.star),a=r.type===O.name&&"static"===r.value;r.parsePropertyName(i),i.static=a&&r.type!==O.parenL,i.static&&(o&&r.unexpected(),o=r.eat(O.star),r.parsePropertyName(i)),i.kind="method";var p=!1;if(!i.computed){var u=i.key;o||"Identifier"!==u.type||r.type===O.parenL||"get"!==u.name&&"set"!==u.name||(p=!0,i.kind=u.name,u=r.parsePropertyName(i)),!i.static&&("Identifier"===u.type&&"constructor"===u.name||"Literal"===u.type&&"constructor"===u.value)&&(s&&r.raise(u.start,"Duplicate constructor in the same class"),p&&r.raise(u.start,"Constructor can't have get/set modifier"),o&&r.raise(u.start,"Constructor can't be a generator"),i.kind="constructor",s=!0)}if(r.parseClassMethod(n,i,o),p){var h="get"===i.kind?0:1;if(i.value.params.length!==h){var c=i.value.start;"get"===i.kind?r.raiseRecoverable(c,"getter should have no params"):r.raiseRecoverable(c,"setter should have exactly one param")}"set"===i.kind&&"RestElement"===i.value.params[0].type&&r.raise(i.value.params[0].start,"Setter cannot use rest params")}}return t.body=this.finishNode(n,"ClassBody"),this.finishNode(t,e?"ClassDeclaration":"ClassExpression")},z.parseClassMethod=function(t,e,r){e.value=this.parseMethod(r),t.body.push(this.finishNode(e,"MethodDefinition"))},z.parseClassId=function(t,e){t.id=this.type===O.name?this.parseIdent():e?this.unexpected():null},z.parseClassSuper=function(t){t.superClass=this.eat(O._extends)?this.parseExprSubscripts():null},z.parseExport=function(t){var e=this;if(this.next(),this.eat(O.star))return this.expectContextual("from"),t.source=this.type===O.string?this.parseExprAtom():this.unexpected(),this.semicolon(),this.finishNode(t,"ExportAllDeclaration");if(this.eat(O._default)){var r=this.type==O.parenL,n=this.parseMaybeAssign(),s=!0;return r||"FunctionExpression"!=n.type&&"ClassExpression"!=n.type||(s=!1,n.id&&(n.type="FunctionExpression"==n.type?"FunctionDeclaration":"ClassDeclaration")),t.declaration=n,s&&this.semicolon(),this.finishNode(t,"ExportDefaultDeclaration")}if(this.shouldParseExportStatement())t.declaration=this.parseStatement(!0),t.specifiers=[],t.source=null;else{if(t.declaration=null,t.specifiers=this.parseExportSpecifiers(),this.eatContextual("from"))t.source=this.type===O.string?this.parseExprAtom():this.unexpected();else{for(var i=0;i<t.specifiers.length;i++)(e.keywords.test(t.specifiers[i].local.name)||e.reservedWords.test(t.specifiers[i].local.name))&&e.unexpected(t.specifiers[i].local.start);t.source=null}this.semicolon()}return this.finishNode(t,"ExportNamedDeclaration")},z.shouldParseExportStatement=function(){return this.type.keyword||this.isLet()},z.parseExportSpecifiers=function(){var t=this,e=[],r=!0;for(this.expect(O.braceL);!this.eat(O.braceR);){if(r)r=!1;else if(t.expect(O.comma),t.afterTrailingComma(O.braceR))break;var n=t.startNode();n.local=t.parseIdent(t.type===O._default),n.exported=t.eatContextual("as")?t.parseIdent(!0):n.local,e.push(t.finishNode(n,"ExportSpecifier"))}return e},z.parseImport=function(t){return this.next(),this.type===O.string?(t.specifiers=H,t.source=this.parseExprAtom()):(t.specifiers=this.parseImportSpecifiers(),this.expectContextual("from"),t.source=this.type===O.string?this.parseExprAtom():this.unexpected()),this.semicolon(),this.finishNode(t,"ImportDeclaration")},z.parseImportSpecifiers=function(){var t=this,e=[],r=!0;if(this.type===O.name){var n=this.startNode();if(n.local=this.parseIdent(),this.checkLVal(n.local,!0),e.push(this.finishNode(n,"ImportDefaultSpecifier")),!this.eat(O.comma))return e}if(this.type===O.star){var s=this.startNode();return this.next(),this.expectContextual("as"),s.local=this.parseIdent(),this.checkLVal(s.local,!0),e.push(this.finishNode(s,"ImportNamespaceSpecifier")),e}for(this.expect(O.braceL);!this.eat(O.braceR);){if(r)r=!1;else if(t.expect(O.comma),t.afterTrailingComma(O.braceR))break;var i=t.startNode();i.imported=t.parseIdent(!0),t.eatContextual("as")?i.local=t.parseIdent():(i.local=i.imported,t.isKeyword(i.local.name)&&t.unexpected(i.local.start),t.reservedWordsStrict.test(i.local.name)&&t.raise(i.local.start,"The keyword '"+i.local.name+"' is reserved")),t.checkLVal(i.local,!0),e.push(t.finishNode(i,"ImportSpecifier"))}return e};var Q=q.prototype;Q.toAssignable=function(t,e){var r=this;if(this.options.ecmaVersion>=6&&t)switch(t.type){case"Identifier":case"ObjectPattern":case"ArrayPattern":break;case"ObjectExpression":t.type="ObjectPattern";for(var n=0;n<t.properties.length;n++){var s=t.properties[n];"init"!==s.kind&&r.raise(s.key.start,"Object pattern can't contain getter or setter"),r.toAssignable(s.value,e)}break;case"ArrayExpression":t.type="ArrayPattern",this.toAssignableList(t.elements,e);break;case"AssignmentExpression":if("="!==t.operator){this.raise(t.left.end,"Only '=' operator can be used for specifying default value.");break}t.type="AssignmentPattern",delete t.operator;case"AssignmentPattern":"YieldExpression"===t.right.type&&this.raise(t.right.start,"Yield expression cannot be a default value");break;case"ParenthesizedExpression":t.expression=this.toAssignable(t.expression,e);break;case"MemberExpression":if(!e)break;default:this.raise(t.start,"Assigning to rvalue")}return t},Q.toAssignableList=function(t,e){var r=this,n=t.length;if(n){var s=t[n-1];if(s&&"RestElement"==s.type)--n;else if(s&&"SpreadElement"==s.type){s.type="RestElement";var i=s.argument;this.toAssignable(i,e),"Identifier"!==i.type&&"MemberExpression"!==i.type&&"ArrayPattern"!==i.type&&this.unexpected(i.start),--n}e&&s&&"RestElement"===s.type&&"Identifier"!==s.argument.type&&this.unexpected(s.argument.start)}for(var o=0;o<n;o++){var a=t[o];a&&r.toAssignable(a,e)}return t},Q.parseSpread=function(t){var e=this.startNode();return this.next(),e.argument=this.parseMaybeAssign(!1,t),this.finishNode(e,"SpreadElement")},Q.parseRest=function(t){var e=this.startNode();return this.next(),e.argument=t?this.type===O.name?this.parseIdent():this.unexpected():this.type===O.name||this.type===O.bracketL?this.parseBindingAtom():this.unexpected(),this.finishNode(e,"RestElement")},Q.parseBindingAtom=function(){if(this.options.ecmaVersion<6)return this.parseIdent();switch(this.type){case O.name:return this.parseIdent();case O.bracketL:var t=this.startNode();return this.next(),t.elements=this.parseBindingList(O.bracketR,!0,!0),this.finishNode(t,"ArrayPattern");case O.braceL:return this.parseObj(!0);default:this.unexpected()}},Q.parseBindingList=function(t,e,r,n){for(var s=this,i=[],o=!0;!this.eat(t);)if(o?o=!1:s.expect(O.comma),e&&s.type===O.comma)i.push(null);else{if(r&&s.afterTrailingComma(t))break;if(s.type===O.ellipsis){var a=s.parseRest(n);s.parseBindingListItem(a),i.push(a),s.type===O.comma&&s.raise(s.start,"Comma is not permitted after the rest element"),s.expect(t);break}var p=s.parseMaybeDefault(s.start,s.startLoc);s.parseBindingListItem(p),i.push(p)}return i},Q.parseBindingListItem=function(t){return t},Q.parseMaybeDefault=function(t,e,r){if(r=r||this.parseBindingAtom(),this.options.ecmaVersion<6||!this.eat(O.eq))return r;var n=this.startNodeAt(t,e);return n.left=r,n.right=this.parseMaybeAssign(),this.finishNode(n,"AssignmentPattern")},Q.checkLVal=function(t,e,r){var n=this;switch(t.type){case"Identifier":this.strict&&this.reservedWordsStrictBind.test(t.name)&&this.raiseRecoverable(t.start,(e?"Binding ":"Assigning to ")+t.name+" in strict mode"),r&&(p(r,t.name)&&this.raiseRecoverable(t.start,"Argument name clash"),r[t.name]=!0);break;case"MemberExpression":e&&this.raiseRecoverable(t.start,(e?"Binding":"Assigning to")+" member expression");break;case"ObjectPattern":for(var s=0;s<t.properties.length;s++)n.checkLVal(t.properties[s].value,e,r);break;case"ArrayPattern":for(var i=0;i<t.elements.length;i++){var o=t.elements[i];o&&n.checkLVal(o,e,r)}break;case"AssignmentPattern":this.checkLVal(t.left,e,r);break;case"RestElement":this.checkLVal(t.argument,e,r);break;case"ParenthesizedExpression":this.checkLVal(t.expression,e,r);break;default:this.raise(t.start,(e?"Binding":"Assigning to")+" rvalue")}};var Y=q.prototype;Y.checkPropClash=function(t,e){if(!(this.options.ecmaVersion>=6&&(t.computed||t.method||t.shorthand))){var r,n=t.key;switch(n.type){case"Identifier":r=n.name;break;case"Literal":r=String(n.value);break;default:return}var s=t.kind;if(this.options.ecmaVersion>=6)return void("__proto__"===r&&"init"===s&&(e.proto&&this.raiseRecoverable(n.start,"Redefinition of __proto__ property"),e.proto=!0));r="$"+r;var i=e[r];if(i){var o="init"!==s;(!this.strict&&!o||!i[s])&&o^i.init||this.raiseRecoverable(n.start,"Redefinition of property")}else i=e[r]={init:!1,get:!1,set:!1};i[s]=!0}},Y.parseExpression=function(t,e){var r=this,n=this.start,s=this.startLoc,i=this.parseMaybeAssign(t,e);if(this.type===O.comma){var o=this.startNodeAt(n,s);for(o.expressions=[i];this.eat(O.comma);)o.expressions.push(r.parseMaybeAssign(t,e));return this.finishNode(o,"SequenceExpression")}return i},Y.parseMaybeAssign=function(t,e,r){if(this.inGenerator&&this.isContextual("yield"))return this.parseYield();var n=!1;e||(e=new W,n=!0);var s=this.start,i=this.startLoc;this.type!=O.parenL&&this.type!=O.name||(this.potentialArrowAt=this.start);var o=this.parseMaybeConditional(t,e);if(r&&(o=r.call(this,o,s,i)),this.type.isAssign){this.checkPatternErrors(e,!0),n||W.call(e);var a=this.startNodeAt(s,i);return a.operator=this.value,a.left=this.type===O.eq?this.toAssignable(o):o,e.shorthandAssign=0,this.checkLVal(o),this.next(),a.right=this.parseMaybeAssign(t),this.finishNode(a,"AssignmentExpression")}return n&&this.checkExpressionErrors(e,!0),o},Y.parseMaybeConditional=function(t,e){var r=this.start,n=this.startLoc,s=this.parseExprOps(t,e);if(this.checkExpressionErrors(e))return s;if(this.eat(O.question)){var i=this.startNodeAt(r,n);return i.test=s,i.consequent=this.parseMaybeAssign(),this.expect(O.colon),i.alternate=this.parseMaybeAssign(t),this.finishNode(i,"ConditionalExpression")}return s},Y.parseExprOps=function(t,e){var r=this.start,n=this.startLoc,s=this.parseMaybeUnary(e,!1);return this.checkExpressionErrors(e)?s:this.parseExprOp(s,r,n,-1,t)},Y.parseExprOp=function(t,e,r,n,s){var i=this.type.binop;if(null!=i&&(!s||this.type!==O._in)&&i>n){var o=this.type===O.logicalOR||this.type===O.logicalAND,a=this.value;this.next();var p=this.start,u=this.startLoc,h=this.parseExprOp(this.parseMaybeUnary(null,!1),p,u,i,s),c=this.buildBinary(e,r,t,h,a,o);return this.parseExprOp(c,e,r,n,s)}return t},Y.buildBinary=function(t,e,r,n,s,i){var o=this.startNodeAt(t,e);return o.left=r,o.operator=s,o.right=n,this.finishNode(o,i?"LogicalExpression":"BinaryExpression")},Y.parseMaybeUnary=function(t,e){var r,n=this,s=this.start,i=this.startLoc;if(this.type.prefix){var o=this.startNode(),a=this.type===O.incDec;o.operator=this.value,o.prefix=!0,this.next(),o.argument=this.parseMaybeUnary(null,!0),this.checkExpressionErrors(t,!0),a?this.checkLVal(o.argument):this.strict&&"delete"===o.operator&&"Identifier"===o.argument.type?this.raiseRecoverable(o.start,"Deleting local variable in strict mode"):e=!0,
r=this.finishNode(o,a?"UpdateExpression":"UnaryExpression")}else{if(r=this.parseExprSubscripts(t),this.checkExpressionErrors(t))return r;for(;this.type.postfix&&!this.canInsertSemicolon();){var p=n.startNodeAt(s,i);p.operator=n.value,p.prefix=!1,p.argument=r,n.checkLVal(r),n.next(),r=n.finishNode(p,"UpdateExpression")}}return!e&&this.eat(O.starstar)?this.buildBinary(s,i,r,this.parseMaybeUnary(null,!1),"**",!1):r},Y.parseExprSubscripts=function(t){var e=this.start,r=this.startLoc,n=this.parseExprAtom(t),s="ArrowFunctionExpression"===n.type&&")"!==this.input.slice(this.lastTokStart,this.lastTokEnd);return this.checkExpressionErrors(t)||s?n:this.parseSubscripts(n,e,r)},Y.parseSubscripts=function(t,e,r,n){for(var s=this;;)if(s.eat(O.dot)){var i=s.startNodeAt(e,r);i.object=t,i.property=s.parseIdent(!0),i.computed=!1,t=s.finishNode(i,"MemberExpression")}else if(s.eat(O.bracketL)){var o=s.startNodeAt(e,r);o.object=t,o.property=s.parseExpression(),o.computed=!0,s.expect(O.bracketR),t=s.finishNode(o,"MemberExpression")}else if(!n&&s.eat(O.parenL)){var a=s.startNodeAt(e,r);a.callee=t,a.arguments=s.parseExprList(O.parenR,!1),t=s.finishNode(a,"CallExpression")}else{if(s.type!==O.backQuote)return t;var p=s.startNodeAt(e,r);p.tag=t,p.quasi=s.parseTemplate(),t=s.finishNode(p,"TaggedTemplateExpression")}},Y.parseExprAtom=function(t){var e,r=this.potentialArrowAt==this.start;switch(this.type){case O._super:this.inFunction||this.raise(this.start,"'super' outside of function or class");case O._this:var n=this.type===O._this?"ThisExpression":"Super";return e=this.startNode(),this.next(),this.finishNode(e,n);case O.name:var s=this.start,i=this.startLoc,o=this.parseIdent(this.type!==O.name);return r&&!this.canInsertSemicolon()&&this.eat(O.arrow)?this.parseArrowExpression(this.startNodeAt(s,i),[o]):o;case O.regexp:var a=this.value;return e=this.parseLiteral(a.value),e.regex={pattern:a.pattern,flags:a.flags},e;case O.num:case O.string:return this.parseLiteral(this.value);case O._null:case O._true:case O._false:return e=this.startNode(),e.value=this.type===O._null?null:this.type===O._true,e.raw=this.type.keyword,this.next(),this.finishNode(e,"Literal");case O.parenL:return this.parseParenAndDistinguishExpression(r);case O.bracketL:return e=this.startNode(),this.next(),e.elements=this.parseExprList(O.bracketR,!0,!0,t),this.finishNode(e,"ArrayExpression");case O.braceL:return this.parseObj(!1,t);case O._function:return e=this.startNode(),this.next(),this.parseFunction(e,!1);case O._class:return this.parseClass(this.startNode(),!1);case O._new:return this.parseNew();case O.backQuote:return this.parseTemplate();default:this.unexpected()}},Y.parseLiteral=function(t){var e=this.startNode();return e.value=t,e.raw=this.input.slice(this.start,this.end),this.next(),this.finishNode(e,"Literal")},Y.parseParenExpression=function(){this.expect(O.parenL);var t=this.parseExpression();return this.expect(O.parenR),t},Y.parseParenAndDistinguishExpression=function(t){var e,r=this,n=this.start,s=this.startLoc;if(this.options.ecmaVersion>=6){this.next();for(var i,o,a=this.start,p=this.startLoc,u=[],h=!0,c=new W;this.type!==O.parenR;){if(h?h=!1:r.expect(O.comma),r.type===O.ellipsis){i=r.start,u.push(r.parseParenItem(r.parseRest()));break}r.type!==O.parenL||o||(o=r.start),u.push(r.parseMaybeAssign(!1,c,r.parseParenItem))}var l=this.start,f=this.startLoc;if(this.expect(O.parenR),t&&!this.canInsertSemicolon()&&this.eat(O.arrow))return this.checkPatternErrors(c,!0),o&&this.unexpected(o),this.parseParenArrowList(n,s,u);u.length||this.unexpected(this.lastTokStart),i&&this.unexpected(i),this.checkExpressionErrors(c,!0),u.length>1?(e=this.startNodeAt(a,p),e.expressions=u,this.finishNodeAt(e,"SequenceExpression",l,f)):e=u[0]}else e=this.parseParenExpression();if(this.options.preserveParens){var d=this.startNodeAt(n,s);return d.expression=e,this.finishNode(d,"ParenthesizedExpression")}return e},Y.parseParenItem=function(t){return t},Y.parseParenArrowList=function(t,e,r){return this.parseArrowExpression(this.startNodeAt(t,e),r)};var K=[];Y.parseNew=function(){var t=this.startNode(),e=this.parseIdent(!0);if(this.options.ecmaVersion>=6&&this.eat(O.dot))return t.meta=e,t.property=this.parseIdent(!0),"target"!==t.property.name&&this.raiseRecoverable(t.property.start,"The only valid meta property for new is new.target"),this.inFunction||this.raiseRecoverable(t.start,"new.target can only be used in functions"),this.finishNode(t,"MetaProperty");var r=this.start,n=this.startLoc;return t.callee=this.parseSubscripts(this.parseExprAtom(),r,n,!0),this.eat(O.parenL)?t.arguments=this.parseExprList(O.parenR,!1):t.arguments=K,this.finishNode(t,"NewExpression")},Y.parseTemplateElement=function(){var t=this.startNode();return t.value={raw:this.input.slice(this.start,this.end).replace(/\r\n?/g,"\n"),cooked:this.value},this.next(),t.tail=this.type===O.backQuote,this.finishNode(t,"TemplateElement")},Y.parseTemplate=function(){var t=this,e=this.startNode();this.next(),e.expressions=[];var r=this.parseTemplateElement();for(e.quasis=[r];!r.tail;)t.expect(O.dollarBraceL),e.expressions.push(t.parseExpression()),t.expect(O.braceR),e.quasis.push(r=t.parseTemplateElement());return this.next(),this.finishNode(e,"TemplateLiteral")},Y.parseObj=function(t,e){var r=this,n=this.startNode(),s=!0,i={};for(n.properties=[],this.next();!this.eat(O.braceR);){if(s)s=!1;else if(r.expect(O.comma),r.afterTrailingComma(O.braceR))break;var o,a,p,u=r.startNode();r.options.ecmaVersion>=6&&(u.method=!1,u.shorthand=!1,(t||e)&&(a=r.start,p=r.startLoc),t||(o=r.eat(O.star))),r.parsePropertyName(u),r.parsePropertyValue(u,t,o,a,p,e),r.checkPropClash(u,i),n.properties.push(r.finishNode(u,"Property"))}return this.finishNode(n,t?"ObjectPattern":"ObjectExpression")},Y.parsePropertyValue=function(t,e,r,n,s,i){if(this.eat(O.colon))t.value=e?this.parseMaybeDefault(this.start,this.startLoc):this.parseMaybeAssign(!1,i),t.kind="init";else if(this.options.ecmaVersion>=6&&this.type===O.parenL)e&&this.unexpected(),t.kind="init",t.method=!0,t.value=this.parseMethod(r);else if(this.options.ecmaVersion>=5&&!t.computed&&"Identifier"===t.key.type&&("get"===t.key.name||"set"===t.key.name)&&this.type!=O.comma&&this.type!=O.braceR){(r||e)&&this.unexpected(),t.kind=t.key.name,this.parsePropertyName(t),t.value=this.parseMethod(!1);var o="get"===t.kind?0:1;if(t.value.params.length!==o){var a=t.value.start;"get"===t.kind?this.raiseRecoverable(a,"getter should have no params"):this.raiseRecoverable(a,"setter should have exactly one param")}"set"===t.kind&&"RestElement"===t.value.params[0].type&&this.raiseRecoverable(t.value.params[0].start,"Setter cannot use rest params")}else this.options.ecmaVersion>=6&&!t.computed&&"Identifier"===t.key.type?((this.keywords.test(t.key.name)||(this.strict?this.reservedWordsStrictBind:this.reservedWords).test(t.key.name)||this.inGenerator&&"yield"==t.key.name)&&this.raiseRecoverable(t.key.start,"'"+t.key.name+"' can not be used as shorthand property"),t.kind="init",e?t.value=this.parseMaybeDefault(n,s,t.key):this.type===O.eq&&i?(i.shorthandAssign||(i.shorthandAssign=this.start),t.value=this.parseMaybeDefault(n,s,t.key)):t.value=t.key,t.shorthand=!0):this.unexpected()},Y.parsePropertyName=function(t){if(this.options.ecmaVersion>=6){if(this.eat(O.bracketL))return t.computed=!0,t.key=this.parseMaybeAssign(),this.expect(O.bracketR),t.key;t.computed=!1}return t.key=this.type===O.num||this.type===O.string?this.parseExprAtom():this.parseIdent(!0)},Y.initFunction=function(t){t.id=null,this.options.ecmaVersion>=6&&(t.generator=!1,t.expression=!1)},Y.parseMethod=function(t){var e=this.startNode(),r=this.inGenerator;return this.inGenerator=t,this.initFunction(e),this.expect(O.parenL),e.params=this.parseBindingList(O.parenR,!1,!1),this.options.ecmaVersion>=6&&(e.generator=t),this.parseFunctionBody(e,!1),this.inGenerator=r,this.finishNode(e,"FunctionExpression")},Y.parseArrowExpression=function(t,e){var r=this.inGenerator;return this.inGenerator=!1,this.initFunction(t),t.params=this.toAssignableList(e,!0),this.parseFunctionBody(t,!0),this.inGenerator=r,this.finishNode(t,"ArrowFunctionExpression")},Y.parseFunctionBody=function(t,e){var r=e&&this.type!==O.braceL;if(r)t.body=this.parseMaybeAssign(),t.expression=!0;else{var n=this.inFunction,s=this.labels;this.inFunction=!0,this.labels=[],t.body=this.parseBlock(!0),t.expression=!1,this.inFunction=n,this.labels=s}var i=!r&&t.body.body.length&&this.isUseStrict(t.body.body[0])?t.body.body[0]:null;if(this.strict||i){var o=this.strict;this.strict=!0,t.id&&this.checkLVal(t.id,!0),this.checkParams(t,i),this.strict=o}else e&&this.checkParams(t,i)},Y.checkParams=function(t,e){for(var r=this,n={},s=0;s<t.params.length;s++)e&&r.options.ecmaVersion>=7&&"Identifier"!==t.params[s].type&&r.raiseRecoverable(e.start,"Illegal 'use strict' directive in function with non-simple parameter list"),r.checkLVal(t.params[s],!0,n)},Y.parseExprList=function(t,e,r,n){for(var s=this,i=[],o=!0;!this.eat(t);){if(o)o=!1;else if(s.expect(O.comma),e&&s.afterTrailingComma(t))break;var a;r&&s.type===O.comma?a=null:s.type===O.ellipsis?(a=s.parseSpread(n),s.type===O.comma&&n&&!n.trailingComma&&(n.trailingComma=s.lastTokStart)):a=s.parseMaybeAssign(!1,n),i.push(a)}return i},Y.parseIdent=function(t){var e=this.startNode();return t&&"never"==this.options.allowReserved&&(t=!1),this.type===O.name?(!t&&(this.strict?this.reservedWordsStrict:this.reservedWords).test(this.value)&&(this.options.ecmaVersion>=6||-1==this.input.slice(this.start,this.end).indexOf("\\"))&&this.raiseRecoverable(this.start,"The keyword '"+this.value+"' is reserved"),!t&&this.inGenerator&&"yield"===this.value&&this.raiseRecoverable(this.start,"Can not use 'yield' as identifier inside a generator"),e.name=this.value):t&&this.type.keyword?e.name=this.type.keyword:this.unexpected(),this.next(),this.finishNode(e,"Identifier")},Y.parseYield=function(){var t=this.startNode();return this.next(),this.type==O.semi||this.canInsertSemicolon()||this.type!=O.star&&!this.type.startsExpr?(t.delegate=!1,t.argument=null):(t.delegate=this.eat(O.star),t.argument=this.parseMaybeAssign()),this.finishNode(t,"YieldExpression")};var X=q.prototype;X.raise=function(t,e){var r=u(this.input,t);e+=" ("+r.line+":"+r.column+")";var n=new SyntaxError(e);throw n.pos=t,n.loc=r,n.raisedAt=this.pos,n},X.raiseRecoverable=X.raise,X.curPosition=function(){if(this.options.locations)return new D(this.curLine,this.pos-this.lineStart)};var Z=function(t,e,r){this.type="",this.start=e,this.end=0,t.options.locations&&(this.loc=new M(t,r)),t.options.directSourceFile&&(this.sourceFile=t.options.directSourceFile),t.options.ranges&&(this.range=[e,0])},J=q.prototype;J.startNode=function(){return new Z(this,this.start,this.startLoc)},J.startNodeAt=function(t,e){return new Z(this,t,e)},J.finishNode=function(t,e){return f.call(this,t,e,this.lastTokEnd,this.lastTokEndLoc)},J.finishNodeAt=function(t,e,r,n){return f.call(this,t,e,r,n)};var tt=function(t,e,r,n){this.token=t,this.isExpr=!!e,this.preserveSpace=!!r,this.override=n},et={b_stat:new tt("{",!1),b_expr:new tt("{",!0),b_tmpl:new tt("${",!0),p_stat:new tt("(",!1),p_expr:new tt("(",!0),q_tmpl:new tt("`",!0,!0,function(t){return t.readTmplToken()}),f_expr:new tt("function",!0)},rt=q.prototype;rt.initialContext=function(){return[et.b_stat]},rt.braceIsBlock=function(t){if(t===O.colon){var e=this.curContext();if(e===et.b_stat||e===et.b_expr)return!e.isExpr}return t===O._return?_.test(this.input.slice(this.lastTokEnd,this.start)):t===O._else||t===O.semi||t===O.eof||t===O.parenR||(t==O.braceL?this.curContext()===et.b_stat:!this.exprAllowed)},rt.updateContext=function(t){var e,r=this.type;r.keyword&&t==O.dot?this.exprAllowed=!1:(e=r.updateContext)?e.call(this,t):this.exprAllowed=r.beforeExpr},O.parenR.updateContext=O.braceR.updateContext=function(){if(1==this.context.length)return void(this.exprAllowed=!0);var t=this.context.pop();t===et.b_stat&&this.curContext()===et.f_expr?(this.context.pop(),this.exprAllowed=!1):this.exprAllowed=t===et.b_tmpl||!t.isExpr},O.braceL.updateContext=function(t){this.context.push(this.braceIsBlock(t)?et.b_stat:et.b_expr),this.exprAllowed=!0},O.dollarBraceL.updateContext=function(){this.context.push(et.b_tmpl),this.exprAllowed=!0},O.parenL.updateContext=function(t){var e=t===O._if||t===O._for||t===O._with||t===O._while;this.context.push(e?et.p_stat:et.p_expr),this.exprAllowed=!0},O.incDec.updateContext=function(){},O._function.updateContext=function(t){t.beforeExpr&&t!==O.semi&&t!==O._else&&(t!==O.colon&&t!==O.braceL||this.curContext()!==et.b_stat)&&this.context.push(et.f_expr),this.exprAllowed=!1},O.backQuote.updateContext=function(){this.curContext()===et.q_tmpl?this.context.pop():this.context.push(et.q_tmpl),this.exprAllowed=!1};var nt=function(t){this.type=t.type,this.value=t.value,this.start=t.start,this.end=t.end,t.options.locations&&(this.loc=new M(t,t.startLoc,t.endLoc)),t.options.ranges&&(this.range=[t.start,t.end])},st=q.prototype,it="object"==typeof Packages&&"[object JavaPackage]"==Object.prototype.toString.call(Packages);st.next=function(){this.options.onToken&&this.options.onToken(new nt(this)),this.lastTokEnd=this.end,this.lastTokStart=this.start,this.lastTokEndLoc=this.endLoc,this.lastTokStartLoc=this.startLoc,this.nextToken()},st.getToken=function(){return this.next(),new nt(this)},"undefined"!=typeof Symbol&&(st[Symbol.iterator]=function(){var t=this;return{next:function(){var e=t.getToken();return{done:e.type===O.eof,value:e}}}}),st.setStrict=function(t){var e=this;if(this.strict=t,this.type===O.num||this.type===O.string){if(this.pos=this.start,this.options.locations)for(;this.pos<this.lineStart;)e.lineStart=e.input.lastIndexOf("\n",e.lineStart-2)+1,--e.curLine;this.nextToken()}},st.curContext=function(){return this.context[this.context.length-1]},st.nextToken=function(){var t=this.curContext();return t&&t.preserveSpace||this.skipSpace(),this.start=this.pos,this.options.locations&&(this.startLoc=this.curPosition()),this.pos>=this.input.length?this.finishToken(O.eof):t.override?t.override(this):void this.readToken(this.fullCharCodeAtPos())},st.readToken=function(t){return r(t,this.options.ecmaVersion>=6)||92===t?this.readWord():this.getTokenFromCode(t)},st.fullCharCodeAtPos=function(){var t=this.input.charCodeAt(this.pos);return t<=55295||t>=57344?t:(t<<10)+this.input.charCodeAt(this.pos+1)-56613888},st.skipBlockComment=function(){var t=this,e=this.options.onComment&&this.curPosition(),r=this.pos,n=this.input.indexOf("*/",this.pos+=2);if(-1===n&&this.raise(this.pos-2,"Unterminated comment"),this.pos=n+2,this.options.locations){F.lastIndex=r;for(var s;(s=F.exec(this.input))&&s.index<this.pos;)++t.curLine,t.lineStart=s.index+s[0].length}this.options.onComment&&this.options.onComment(!0,this.input.slice(r+2,n),r,this.pos,e,this.curPosition())},st.skipLineComment=function(t){for(var e=this,r=this.pos,n=this.options.onComment&&this.curPosition(),s=this.input.charCodeAt(this.pos+=t);this.pos<this.input.length&&10!==s&&13!==s&&8232!==s&&8233!==s;)++e.pos,s=e.input.charCodeAt(e.pos);this.options.onComment&&this.options.onComment(!1,this.input.slice(r+t,this.pos),r,this.pos,n,this.curPosition())},st.skipSpace=function(){var t=this;t:for(;this.pos<this.input.length;){var e=t.input.charCodeAt(t.pos);switch(e){case 32:case 160:++t.pos;break;case 13:10===t.input.charCodeAt(t.pos+1)&&++t.pos;case 10:case 8232:case 8233:++t.pos,t.options.locations&&(++t.curLine,t.lineStart=t.pos);break;case 47:switch(t.input.charCodeAt(t.pos+1)){case 42:t.skipBlockComment();break;case 47:t.skipLineComment(2);break;default:break t}break;default:if(!(e>8&&e<14||e>=5760&&j.test(String.fromCharCode(e))))break t;++t.pos}}},st.finishToken=function(t,e){this.end=this.pos,this.options.locations&&(this.endLoc=this.curPosition());var r=this.type;this.type=t,this.value=e,this.updateContext(r)},st.readToken_dot=function(){var t=this.input.charCodeAt(this.pos+1);if(t>=48&&t<=57)return this.readNumber(!0);var e=this.input.charCodeAt(this.pos+2);return this.options.ecmaVersion>=6&&46===t&&46===e?(this.pos+=3,this.finishToken(O.ellipsis)):(++this.pos,this.finishToken(O.dot))},st.readToken_slash=function(){var t=this.input.charCodeAt(this.pos+1);return this.exprAllowed?(++this.pos,this.readRegexp()):61===t?this.finishOp(O.assign,2):this.finishOp(O.slash,1)},st.readToken_mult_modulo_exp=function(t){var e=this.input.charCodeAt(this.pos+1),r=1,n=42===t?O.star:O.modulo;return this.options.ecmaVersion>=7&&42===e&&(++r,n=O.starstar,e=this.input.charCodeAt(this.pos+2)),61===e?this.finishOp(O.assign,r+1):this.finishOp(n,r)},st.readToken_pipe_amp=function(t){var e=this.input.charCodeAt(this.pos+1);return e===t?this.finishOp(124===t?O.logicalOR:O.logicalAND,2):61===e?this.finishOp(O.assign,2):this.finishOp(124===t?O.bitwiseOR:O.bitwiseAND,1)},st.readToken_caret=function(){return 61===this.input.charCodeAt(this.pos+1)?this.finishOp(O.assign,2):this.finishOp(O.bitwiseXOR,1)},st.readToken_plus_min=function(t){var e=this.input.charCodeAt(this.pos+1);return e===t?45==e&&62==this.input.charCodeAt(this.pos+2)&&_.test(this.input.slice(this.lastTokEnd,this.pos))?(this.skipLineComment(3),this.skipSpace(),this.nextToken()):this.finishOp(O.incDec,2):61===e?this.finishOp(O.assign,2):this.finishOp(O.plusMin,1)},st.readToken_lt_gt=function(t){var e=this.input.charCodeAt(this.pos+1),r=1;return e===t?(r=62===t&&62===this.input.charCodeAt(this.pos+2)?3:2,61===this.input.charCodeAt(this.pos+r)?this.finishOp(O.assign,r+1):this.finishOp(O.bitShift,r)):33==e&&60==t&&45==this.input.charCodeAt(this.pos+2)&&45==this.input.charCodeAt(this.pos+3)?(this.inModule&&this.unexpected(),this.skipLineComment(4),this.skipSpace(),this.nextToken()):(61===e&&(r=2),this.finishOp(O.relational,r))},st.readToken_eq_excl=function(t){var e=this.input.charCodeAt(this.pos+1);return 61===e?this.finishOp(O.equality,61===this.input.charCodeAt(this.pos+2)?3:2):61===t&&62===e&&this.options.ecmaVersion>=6?(this.pos+=2,this.finishToken(O.arrow)):this.finishOp(61===t?O.eq:O.prefix,1)},st.getTokenFromCode=function(t){switch(t){case 46:return this.readToken_dot();case 40:return++this.pos,this.finishToken(O.parenL);case 41:return++this.pos,this.finishToken(O.parenR);case 59:return++this.pos,this.finishToken(O.semi);case 44:return++this.pos,this.finishToken(O.comma);case 91:return++this.pos,this.finishToken(O.bracketL);case 93:return++this.pos,this.finishToken(O.bracketR);case 123:return++this.pos,this.finishToken(O.braceL);case 125:return++this.pos,this.finishToken(O.braceR);case 58:return++this.pos,this.finishToken(O.colon);case 63:return++this.pos,this.finishToken(O.question);case 96:if(this.options.ecmaVersion<6)break;return++this.pos,this.finishToken(O.backQuote);case 48:var e=this.input.charCodeAt(this.pos+1);if(120===e||88===e)return this.readRadixNumber(16);if(this.options.ecmaVersion>=6){if(111===e||79===e)return this.readRadixNumber(8);if(98===e||66===e)return this.readRadixNumber(2)}case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.readNumber(!1);case 34:case 39:return this.readString(t);case 47:return this.readToken_slash();case 37:case 42:return this.readToken_mult_modulo_exp(t);case 124:case 38:return this.readToken_pipe_amp(t);case 94:return this.readToken_caret();case 43:case 45:return this.readToken_plus_min(t);case 60:case 62:return this.readToken_lt_gt(t);case 61:case 33:return this.readToken_eq_excl(t);case 126:return this.finishOp(O.prefix,1)}this.raise(this.pos,"Unexpected character '"+y(t)+"'")},st.finishOp=function(t,e){var r=this.input.slice(this.pos,this.pos+e);return this.pos+=e,this.finishToken(t,r)};var ot=!!d("￿","u");st.readRegexp=function(){for(var t,e,r=this,n=this.pos;;){r.pos>=r.input.length&&r.raise(n,"Unterminated regular expression");var s=r.input.charAt(r.pos);if(_.test(s)&&r.raise(n,"Unterminated regular expression"),t)t=!1;else{if("["===s)e=!0;else if("]"===s&&e)e=!1;else if("/"===s&&!e)break;t="\\"===s}++r.pos}var i=this.input.slice(n,this.pos);++this.pos;var o=this.readWord1(),a=i,p="";if(o){var u=/^[gim]*$/;this.options.ecmaVersion>=6&&(u=/^[gimuy]*$/),u.test(o)||this.raise(n,"Invalid regular expression flag"),o.indexOf("u")>=0&&(ot?p="u":(a=a.replace(/\\u\{([0-9a-fA-F]+)\}/g,function(t,e,s){return e=Number("0x"+e),e>1114111&&r.raise(n+s+3,"Code point out of bounds"),"x"}),a=a.replace(/\\u([a-fA-F0-9]{4})|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"),p=p.replace("u","")))}var h=null;return it||(d(a,p,n,this),h=d(i,o)),this.finishToken(O.regexp,{pattern:i,flags:o,value:h})},st.readInt=function(t,e){for(var r=this,n=this.pos,s=0,i=0,o=null==e?1/0:e;i<o;++i){var a,p=r.input.charCodeAt(r.pos);if((a=p>=97?p-97+10:p>=65?p-65+10:p>=48&&p<=57?p-48:1/0)>=t)break;++r.pos,s=s*t+a}return this.pos===n||null!=e&&this.pos-n!==e?null:s},st.readRadixNumber=function(t){this.pos+=2;var e=this.readInt(t);return null==e&&this.raise(this.start+2,"Expected number in radix "+t),r(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(O.num,e)},st.readNumber=function(t){var e=this.pos,n=!1,s=48===this.input.charCodeAt(this.pos);t||null!==this.readInt(10)||this.raise(e,"Invalid number");var i=this.input.charCodeAt(this.pos);46===i&&(++this.pos,this.readInt(10),n=!0,i=this.input.charCodeAt(this.pos)),69!==i&&101!==i||(i=this.input.charCodeAt(++this.pos),43!==i&&45!==i||++this.pos,null===this.readInt(10)&&this.raise(e,"Invalid number"),n=!0),r(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number");var o,a=this.input.slice(e,this.pos);return n?o=parseFloat(a):s&&1!==a.length?/[89]/.test(a)||this.strict?this.raise(e,"Invalid number"):o=parseInt(a,8):o=parseInt(a,10),this.finishToken(O.num,o)},st.readCodePoint=function(){var t,e=this.input.charCodeAt(this.pos);if(123===e){this.options.ecmaVersion<6&&this.unexpected();var r=++this.pos;t=this.readHexChar(this.input.indexOf("}",this.pos)-this.pos),++this.pos,t>1114111&&this.raise(r,"Code point out of bounds")}else t=this.readHexChar(4);return t},st.readString=function(t){for(var e=this,r="",n=++this.pos;;){e.pos>=e.input.length&&e.raise(e.start,"Unterminated string constant");var s=e.input.charCodeAt(e.pos);if(s===t)break;92===s?(r+=e.input.slice(n,e.pos),r+=e.readEscapedChar(!1),n=e.pos):(o(s)&&e.raise(e.start,"Unterminated string constant"),++e.pos)}return r+=this.input.slice(n,this.pos++),this.finishToken(O.string,r)},st.readTmplToken=function(){for(var t=this,e="",r=this.pos;;){t.pos>=t.input.length&&t.raise(t.start,"Unterminated template");var n=t.input.charCodeAt(t.pos);if(96===n||36===n&&123===t.input.charCodeAt(t.pos+1))return t.pos===t.start&&t.type===O.template?36===n?(t.pos+=2,t.finishToken(O.dollarBraceL)):(++t.pos,t.finishToken(O.backQuote)):(e+=t.input.slice(r,t.pos),t.finishToken(O.template,e));if(92===n)e+=t.input.slice(r,t.pos),e+=t.readEscapedChar(!0),r=t.pos;else if(o(n)){switch(e+=t.input.slice(r,t.pos),++t.pos,n){case 13:10===t.input.charCodeAt(t.pos)&&++t.pos;case 10:e+="\n";break;default:e+=String.fromCharCode(n)}t.options.locations&&(++t.curLine,t.lineStart=t.pos),r=t.pos}else++t.pos}},st.readEscapedChar=function(t){var e=this.input.charCodeAt(++this.pos);switch(++this.pos,e){case 110:return"\n";case 114:return"\r";case 120:return String.fromCharCode(this.readHexChar(2));case 117:return y(this.readCodePoint());case 116:return"\t";case 98:return"\b";case 118:return"\v";case 102:return"\f";case 13:10===this.input.charCodeAt(this.pos)&&++this.pos;case 10:return this.options.locations&&(this.lineStart=this.pos,++this.curLine),"";default:if(e>=48&&e<=55){var r=this.input.substr(this.pos-1,3).match(/^[0-7]+/)[0],n=parseInt(r,8);return n>255&&(r=r.slice(0,-1),n=parseInt(r,8)),"0"!==r&&(this.strict||t)&&this.raise(this.pos-2,"Octal literal in strict mode"),this.pos+=r.length-1,String.fromCharCode(n)}return String.fromCharCode(e)}},st.readHexChar=function(t){var e=this.pos,r=this.readInt(16,t);return null===r&&this.raise(e,"Bad character escape sequence"),r},st.readWord1=function(){var t=this;this.containsEsc=!1;for(var e="",s=!0,i=this.pos,o=this.options.ecmaVersion>=6;this.pos<this.input.length;){var a=t.fullCharCodeAtPos();if(n(a,o))t.pos+=a<=65535?1:2;else{if(92!==a)break;t.containsEsc=!0,e+=t.input.slice(i,t.pos);var p=t.pos;117!=t.input.charCodeAt(++t.pos)&&t.raise(t.pos,"Expecting Unicode escape sequence \\uXXXX"),++t.pos;var u=t.readCodePoint();(s?r:n)(u,o)||t.raise(p,"Invalid Unicode escape"),e+=y(u),i=t.pos}s=!1}return e+this.input.slice(i,this.pos)},st.readWord=function(){var t=this.readWord1(),e=O.name;return(this.options.ecmaVersion>=6||!this.containsEsc)&&this.keywords.test(t)&&(e=I[t]),this.finishToken(e,t)};t.version="3.3.0",t.parse=m,t.parseExpressionAt=g,t.tokenizer=v,t.Parser=q,t.plugins=B,t.defaultOptions=V,t.Position=D,t.SourceLocation=M,t.getLineInfo=u,t.Node=Z,t.TokenType=N,t.tokTypes=O,t.TokContext=tt,t.tokContexts=et,t.isIdentifierChar=n,t.isIdentifierStart=r,t.Token=nt,t.isNewLine=o,t.lineBreak=_,t.lineBreakG=F,Object.defineProperty(t,"__esModule",{value:!0})}),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("./acorn.js")):"function"==typeof define&&define.amd?define(["exports","./acorn.js"],e):e((t.acorn=t.acorn||{},t.acorn.loose=t.acorn.loose||{}),t.acorn)}(this,function(t,e){"use strict";function r(t){return t<14&&t>8||32===t||160===t||e.isNewLine(t)}function n(t){return"✖"==t.name}function s(t,e){var r=new a(t,e);return r.next(),r.parseTopLevel()}var i="default"in e?e.default:e,o={},a=function(t,r){if(void 0===r&&(r={}),this.toks=e.tokenizer(t,r),this.options=this.toks.options,this.input=this.toks.input,this.tok=this.last={type:e.tokTypes.eof,start:0,end:0},this.options.locations){var n=this.toks.curPosition();this.tok.loc=new e.SourceLocation(this.toks,n,n)}this.ahead=[],this.context=[],this.curIndent=0,this.curLineStart=0,this.nextLineStart=this.lineEnd(this.curLineStart)+1,this.options.pluginsLoose=r.pluginsLoose||{},this.loadPlugins(this.options.pluginsLoose)};a.prototype.startNode=function(){return new e.Node(this.toks,this.tok.start,this.options.locations?this.tok.loc.start:null)},a.prototype.storeCurrentPos=function(){return this.options.locations?[this.tok.start,this.tok.loc.start]:this.tok.start},a.prototype.startNodeAt=function(t){return this.options.locations?new e.Node(this.toks,t[0],t[1]):new e.Node(this.toks,t)},a.prototype.finishNode=function(t,e){return t.type=e,t.end=this.last.end,this.options.locations&&(t.loc.end=this.last.loc.end),this.options.ranges&&(t.range[1]=this.last.end),t},a.prototype.dummyNode=function(t){var r=this.startNode();return r.type=t,r.end=r.start,this.options.locations&&(r.loc.end=r.loc.start),this.options.ranges&&(r.range[1]=r.start),this.last={type:e.tokTypes.name,start:r.start,end:r.start,loc:r.loc},r},a.prototype.dummyIdent=function(){var t=this.dummyNode("Identifier");return t.name="✖",t},a.prototype.dummyString=function(){var t=this.dummyNode("Literal");return t.value=t.raw="✖",t},a.prototype.eat=function(t){return this.tok.type===t&&(this.next(),!0)},a.prototype.isContextual=function(t){return this.tok.type===e.tokTypes.name&&this.tok.value===t},a.prototype.eatContextual=function(t){return this.tok.value===t&&this.eat(e.tokTypes.name)},a.prototype.canInsertSemicolon=function(){return this.tok.type===e.tokTypes.eof||this.tok.type===e.tokTypes.braceR||e.lineBreak.test(this.input.slice(this.last.end,this.tok.start))},a.prototype.semicolon=function(){return this.eat(e.tokTypes.semi)},a.prototype.expect=function(t){var e=this;if(this.eat(t))return!0;for(var r=1;r<=2;r++)if(e.lookAhead(r).type==t){for(var n=0;n<r;n++)e.next();return!0}},a.prototype.pushCx=function(){this.context.push(this.curIndent)},a.prototype.popCx=function(){this.curIndent=this.context.pop()},a.prototype.lineEnd=function(t){for(;t<this.input.length&&!e.isNewLine(this.input.charCodeAt(t));)++t;return t},a.prototype.indentationAfter=function(t){for(var e=this,r=0;;++t){var n=e.input.charCodeAt(t);if(32===n)++r;else{if(9!==n)return r;r+=e.options.tabSize}}},a.prototype.closes=function(t,r,n,s){return this.tok.type===t||this.tok.type===e.tokTypes.eof||n!=this.curLineStart&&this.curIndent<r&&this.tokenStartsLine()&&(!s||this.nextLineStart>=this.input.length||this.indentationAfter(this.nextLineStart)<r)},a.prototype.tokenStartsLine=function(){for(var t=this,e=this.tok.start-1;e>=this.curLineStart;--e){var r=t.input.charCodeAt(e);if(9!==r&&32!==r)return!1}return!0},a.prototype.extend=function(t,e){this[t]=e(this[t])},a.prototype.loadPlugins=function(t){var e=this;for(var r in t){var n=o[r];if(!n)throw new Error("Plugin '"+r+"' not found");n(e,t[r])}};var p=a.prototype;p.next=function(){var t=this;if(this.last=this.tok,this.ahead.length?this.tok=this.ahead.shift():this.tok=this.readToken(),this.tok.start>=this.nextLineStart){for(;this.tok.start>=this.nextLineStart;)t.curLineStart=t.nextLineStart,t.nextLineStart=t.lineEnd(t.curLineStart)+1;this.curIndent=this.indentationAfter(this.curLineStart)}},p.readToken=function(){for(var t=this;;)try{return t.toks.next(),t.toks.type===e.tokTypes.dot&&"."===t.input.substr(t.toks.end,1)&&t.options.ecmaVersion>=6&&(t.toks.end++,t.toks.type=e.tokTypes.ellipsis),new e.Token(t.toks)}catch(p){if(!(p instanceof SyntaxError))throw p;var n=p.message,s=p.raisedAt,i=!0;if(/unterminated/i.test(n))if(s=t.lineEnd(p.pos+1),/string/.test(n))i={start:p.pos,end:s,type:e.tokTypes.string,value:t.input.slice(p.pos+1,s)};else if(/regular expr/i.test(n)){var o=t.input.slice(p.pos,s);try{o=new RegExp(o)}catch(t){}i={start:p.pos,end:s,type:e.tokTypes.regexp,value:o}}else i=!!/template/.test(n)&&{start:p.pos,end:s,type:e.tokTypes.template,value:t.input.slice(p.pos,s)};else if(/invalid (unicode|regexp|number)|expecting unicode|octal literal|is reserved|directly after number|expected number in radix/i.test(n))for(;s<this.input.length&&!r(this.input.charCodeAt(s));)++s;else if(/character escape|expected hexadecimal/i.test(n))for(;s<this.input.length;){var a=t.input.charCodeAt(s++);if(34===a||39===a||e.isNewLine(a))break}else if(/unexpected character/i.test(n))s++,i=!1;else{if(!/regular expression/i.test(n))throw p;i=!0}if(t.resetTo(s),!0===i&&(i={start:s,end:s,type:e.tokTypes.name,value:"✖"}),i)return t.options.locations&&(i.loc=new e.SourceLocation(t.toks,e.getLineInfo(t.input,i.start),e.getLineInfo(t.input,i.end))),i}},p.resetTo=function(t){var r=this;this.toks.pos=t;var n=this.input.charAt(t-1);if(this.toks.exprAllowed=!n||/[\[\{\(,;:?\/*=+\-~!|&%^<>]/.test(n)||/[enwfd]/.test(n)&&/\b(keywords|case|else|return|throw|new|in|(instance|type)of|delete|void)$/.test(this.input.slice(t-10,t)),this.options.locations){this.toks.curLine=1,this.toks.lineStart=e.lineBreakG.lastIndex=0;for(var s;(s=e.lineBreakG.exec(this.input))&&s.index<t;)++r.toks.curLine,r.toks.lineStart=s.index+s[0].length}},p.lookAhead=function(t){for(var e=this;t>this.ahead.length;)e.ahead.push(e.readToken());return this.ahead[t-1]};var u=a.prototype;u.parseTopLevel=function(){var t=this,r=this.startNodeAt(this.options.locations?[0,e.getLineInfo(this.input,0)]:0);for(r.body=[];this.tok.type!==e.tokTypes.eof;)r.body.push(t.parseStatement());return this.last=this.tok,this.options.ecmaVersion>=6&&(r.sourceType=this.options.sourceType),this.finishNode(r,"Program")},u.parseStatement=function(){var t,r=this,s=this.tok.type,i=this.startNode();switch(this.toks.isLet()&&(s=e.tokTypes._var,t="let"),s){case e.tokTypes._break:case e.tokTypes._continue:this.next();var o=s===e.tokTypes._break;return this.semicolon()||this.canInsertSemicolon()?i.label=null:(i.label=this.tok.type===e.tokTypes.name?this.parseIdent():null,this.semicolon()),this.finishNode(i,o?"BreakStatement":"ContinueStatement");case e.tokTypes._debugger:return this.next(),this.semicolon(),this.finishNode(i,"DebuggerStatement");case e.tokTypes._do:return this.next(),i.body=this.parseStatement(),i.test=this.eat(e.tokTypes._while)?this.parseParenExpression():this.dummyIdent(),this.semicolon(),this.finishNode(i,"DoWhileStatement")
;case e.tokTypes._for:if(this.next(),this.pushCx(),this.expect(e.tokTypes.parenL),this.tok.type===e.tokTypes.semi)return this.parseFor(i,null);var a=this.toks.isLet();if(a||this.tok.type===e.tokTypes._var||this.tok.type===e.tokTypes._const){var p=this.parseVar(!0,a?"let":this.tok.value);return 1!==p.declarations.length||this.tok.type!==e.tokTypes._in&&!this.isContextual("of")?this.parseFor(i,p):this.parseForIn(i,p)}var u=this.parseExpression(!0);return this.tok.type===e.tokTypes._in||this.isContextual("of")?this.parseForIn(i,this.toAssignable(u)):this.parseFor(i,u);case e.tokTypes._function:return this.next(),this.parseFunction(i,!0);case e.tokTypes._if:return this.next(),i.test=this.parseParenExpression(),i.consequent=this.parseStatement(),i.alternate=this.eat(e.tokTypes._else)?this.parseStatement():null,this.finishNode(i,"IfStatement");case e.tokTypes._return:return this.next(),this.eat(e.tokTypes.semi)||this.canInsertSemicolon()?i.argument=null:(i.argument=this.parseExpression(),this.semicolon()),this.finishNode(i,"ReturnStatement");case e.tokTypes._switch:var h=this.curIndent,c=this.curLineStart;this.next(),i.discriminant=this.parseParenExpression(),i.cases=[],this.pushCx(),this.expect(e.tokTypes.braceL);for(var l;!this.closes(e.tokTypes.braceR,h,c,!0);)if(r.tok.type===e.tokTypes._case||r.tok.type===e.tokTypes._default){var f=r.tok.type===e.tokTypes._case;l&&r.finishNode(l,"SwitchCase"),i.cases.push(l=r.startNode()),l.consequent=[],r.next(),l.test=f?r.parseExpression():null,r.expect(e.tokTypes.colon)}else l||(i.cases.push(l=r.startNode()),l.consequent=[],l.test=null),l.consequent.push(r.parseStatement());return l&&this.finishNode(l,"SwitchCase"),this.popCx(),this.eat(e.tokTypes.braceR),this.finishNode(i,"SwitchStatement");case e.tokTypes._throw:return this.next(),i.argument=this.parseExpression(),this.semicolon(),this.finishNode(i,"ThrowStatement");case e.tokTypes._try:if(this.next(),i.block=this.parseBlock(),i.handler=null,this.tok.type===e.tokTypes._catch){var d=this.startNode();this.next(),this.expect(e.tokTypes.parenL),d.param=this.toAssignable(this.parseExprAtom(),!0),this.expect(e.tokTypes.parenR),d.body=this.parseBlock(),i.handler=this.finishNode(d,"CatchClause")}return i.finalizer=this.eat(e.tokTypes._finally)?this.parseBlock():null,i.handler||i.finalizer?this.finishNode(i,"TryStatement"):i.block;case e.tokTypes._var:case e.tokTypes._const:return this.parseVar(!1,t||this.tok.value);case e.tokTypes._while:return this.next(),i.test=this.parseParenExpression(),i.body=this.parseStatement(),this.finishNode(i,"WhileStatement");case e.tokTypes._with:return this.next(),i.object=this.parseParenExpression(),i.body=this.parseStatement(),this.finishNode(i,"WithStatement");case e.tokTypes.braceL:return this.parseBlock();case e.tokTypes.semi:return this.next(),this.finishNode(i,"EmptyStatement");case e.tokTypes._class:return this.parseClass(!0);case e.tokTypes._import:return this.parseImport();case e.tokTypes._export:return this.parseExport();default:var y=this.parseExpression();return n(y)?(this.next(),this.tok.type===e.tokTypes.eof?this.finishNode(i,"EmptyStatement"):this.parseStatement()):s===e.tokTypes.name&&"Identifier"===y.type&&this.eat(e.tokTypes.colon)?(i.body=this.parseStatement(),i.label=y,this.finishNode(i,"LabeledStatement")):(i.expression=y,this.semicolon(),this.finishNode(i,"ExpressionStatement"))}},u.parseBlock=function(){var t=this,r=this.startNode();this.pushCx(),this.expect(e.tokTypes.braceL);var n=this.curIndent,s=this.curLineStart;for(r.body=[];!this.closes(e.tokTypes.braceR,n,s,!0);)r.body.push(t.parseStatement());return this.popCx(),this.eat(e.tokTypes.braceR),this.finishNode(r,"BlockStatement")},u.parseFor=function(t,r){return t.init=r,t.test=t.update=null,this.eat(e.tokTypes.semi)&&this.tok.type!==e.tokTypes.semi&&(t.test=this.parseExpression()),this.eat(e.tokTypes.semi)&&this.tok.type!==e.tokTypes.parenR&&(t.update=this.parseExpression()),this.popCx(),this.expect(e.tokTypes.parenR),t.body=this.parseStatement(),this.finishNode(t,"ForStatement")},u.parseForIn=function(t,r){var n=this.tok.type===e.tokTypes._in?"ForInStatement":"ForOfStatement";return this.next(),t.left=r,t.right=this.parseExpression(),this.popCx(),this.expect(e.tokTypes.parenR),t.body=this.parseStatement(),this.finishNode(t,n)},u.parseVar=function(t,r){var n=this,s=this.startNode();s.kind=r,this.next(),s.declarations=[];do{var i=n.startNode();i.id=n.options.ecmaVersion>=6?n.toAssignable(n.parseExprAtom(),!0):n.parseIdent(),i.init=n.eat(e.tokTypes.eq)?n.parseMaybeAssign(t):null,s.declarations.push(n.finishNode(i,"VariableDeclarator"))}while(this.eat(e.tokTypes.comma));if(!s.declarations.length){var o=this.startNode();o.id=this.dummyIdent(),s.declarations.push(this.finishNode(o,"VariableDeclarator"))}return t||this.semicolon(),this.finishNode(s,"VariableDeclaration")},u.parseClass=function(t){var r=this,s=this.startNode();this.next(),this.tok.type===e.tokTypes.name?s.id=this.parseIdent():s.id=t?this.dummyIdent():null,s.superClass=this.eat(e.tokTypes._extends)?this.parseExpression():null,s.body=this.startNode(),s.body.body=[],this.pushCx();var i=this.curIndent+1,o=this.curLineStart;for(this.eat(e.tokTypes.braceL),this.curIndent+1<i&&(i=this.curIndent,o=this.curLineStart);!this.closes(e.tokTypes.braceR,i,o);)if(!r.semicolon()){var a,p=r.startNode();r.options.ecmaVersion>=6&&(p.static=!1,a=r.eat(e.tokTypes.star)),r.parsePropertyName(p),n(p.key)?(n(r.parseMaybeAssign())&&r.next(),r.eat(e.tokTypes.comma)):("Identifier"!==p.key.type||p.computed||"static"!==p.key.name||r.tok.type==e.tokTypes.parenL||r.tok.type==e.tokTypes.braceL?p.static=!1:(p.static=!0,a=r.eat(e.tokTypes.star),r.parsePropertyName(p)),r.options.ecmaVersion>=5&&"Identifier"===p.key.type&&!p.computed&&("get"===p.key.name||"set"===p.key.name)&&r.tok.type!==e.tokTypes.parenL&&r.tok.type!==e.tokTypes.braceL?(p.kind=p.key.name,r.parsePropertyName(p),p.value=r.parseMethod(!1)):(p.computed||p.static||a||!("Identifier"===p.key.type&&"constructor"===p.key.name||"Literal"===p.key.type&&"constructor"===p.key.value)?p.kind="method":p.kind="constructor",p.value=r.parseMethod(a)),s.body.body.push(r.finishNode(p,"MethodDefinition")))}return this.popCx(),this.eat(e.tokTypes.braceR)||(this.last.end=this.tok.start,this.options.locations&&(this.last.loc.end=this.tok.loc.start)),this.semicolon(),this.finishNode(s.body,"ClassBody"),this.finishNode(s,t?"ClassDeclaration":"ClassExpression")},u.parseFunction=function(t,r){return this.initFunction(t),this.options.ecmaVersion>=6&&(t.generator=this.eat(e.tokTypes.star)),this.tok.type===e.tokTypes.name?t.id=this.parseIdent():r&&(t.id=this.dummyIdent()),t.params=this.parseFunctionParams(),t.body=this.parseBlock(),this.finishNode(t,r?"FunctionDeclaration":"FunctionExpression")},u.parseExport=function(){var t=this.startNode();if(this.next(),this.eat(e.tokTypes.star))return t.source=this.eatContextual("from")?this.parseExprAtom():this.dummyString(),this.finishNode(t,"ExportAllDeclaration");if(this.eat(e.tokTypes._default)){var r=this.parseMaybeAssign();if(r.id)switch(r.type){case"FunctionExpression":r.type="FunctionDeclaration";break;case"ClassExpression":r.type="ClassDeclaration"}return t.declaration=r,this.semicolon(),this.finishNode(t,"ExportDefaultDeclaration")}return this.tok.type.keyword||this.toks.isLet()?(t.declaration=this.parseStatement(),t.specifiers=[],t.source=null):(t.declaration=null,t.specifiers=this.parseExportSpecifierList(),t.source=this.eatContextual("from")?this.parseExprAtom():null,this.semicolon()),this.finishNode(t,"ExportNamedDeclaration")},u.parseImport=function(){var t=this.startNode();if(this.next(),this.tok.type===e.tokTypes.string)t.specifiers=[],t.source=this.parseExprAtom(),t.kind="";else{var r;this.tok.type===e.tokTypes.name&&"from"!==this.tok.value&&(r=this.startNode(),r.local=this.parseIdent(),this.finishNode(r,"ImportDefaultSpecifier"),this.eat(e.tokTypes.comma)),t.specifiers=this.parseImportSpecifierList(),t.source=this.eatContextual("from")&&this.tok.type==e.tokTypes.string?this.parseExprAtom():this.dummyString(),r&&t.specifiers.unshift(r)}return this.semicolon(),this.finishNode(t,"ImportDeclaration")},u.parseImportSpecifierList=function(){var t=this,r=[];if(this.tok.type===e.tokTypes.star){var s=this.startNode();this.next(),s.local=this.eatContextual("as")?this.parseIdent():this.dummyIdent(),r.push(this.finishNode(s,"ImportNamespaceSpecifier"))}else{var i=this.curIndent,o=this.curLineStart,a=this.nextLineStart;for(this.pushCx(),this.eat(e.tokTypes.braceL),this.curLineStart>a&&(a=this.curLineStart);!this.closes(e.tokTypes.braceR,i+(this.curLineStart<=a?1:0),o);){var p=t.startNode();if(t.eat(e.tokTypes.star))p.local=t.eatContextual("as")?t.parseIdent():t.dummyIdent(),t.finishNode(p,"ImportNamespaceSpecifier");else{if(t.isContextual("from"))break;if(p.imported=t.parseIdent(),n(p.imported))break;p.local=t.eatContextual("as")?t.parseIdent():p.imported,t.finishNode(p,"ImportSpecifier")}r.push(p),t.eat(e.tokTypes.comma)}this.eat(e.tokTypes.braceR),this.popCx()}return r},u.parseExportSpecifierList=function(){var t=this,r=[],s=this.curIndent,i=this.curLineStart,o=this.nextLineStart;for(this.pushCx(),this.eat(e.tokTypes.braceL),this.curLineStart>o&&(o=this.curLineStart);!this.closes(e.tokTypes.braceR,s+(this.curLineStart<=o?1:0),i)&&!t.isContextual("from");){var a=t.startNode();if(a.local=t.parseIdent(),n(a.local))break;a.exported=t.eatContextual("as")?t.parseIdent():a.local,t.finishNode(a,"ExportSpecifier"),r.push(a),t.eat(e.tokTypes.comma)}return this.eat(e.tokTypes.braceR),this.popCx(),r};var h=a.prototype;h.checkLVal=function(t){if(!t)return t;switch(t.type){case"Identifier":case"MemberExpression":return t;case"ParenthesizedExpression":return t.expression=this.checkLVal(t.expression),t;default:return this.dummyIdent()}},h.parseExpression=function(t){var r=this,n=this.storeCurrentPos(),s=this.parseMaybeAssign(t);if(this.tok.type===e.tokTypes.comma){var i=this.startNodeAt(n);for(i.expressions=[s];this.eat(e.tokTypes.comma);)i.expressions.push(r.parseMaybeAssign(t));return this.finishNode(i,"SequenceExpression")}return s},h.parseParenExpression=function(){this.pushCx(),this.expect(e.tokTypes.parenL);var t=this.parseExpression();return this.popCx(),this.expect(e.tokTypes.parenR),t},h.parseMaybeAssign=function(t){if(this.toks.isContextual("yield")){var r=this.startNode();return this.next(),this.semicolon()||this.canInsertSemicolon()||this.tok.type!=e.tokTypes.star&&!this.tok.type.startsExpr?(r.delegate=!1,r.argument=null):(r.delegate=this.eat(e.tokTypes.star),r.argument=this.parseMaybeAssign()),this.finishNode(r,"YieldExpression")}var n=this.storeCurrentPos(),s=this.parseMaybeConditional(t);if(this.tok.type.isAssign){var i=this.startNodeAt(n);return i.operator=this.tok.value,i.left=this.tok.type===e.tokTypes.eq?this.toAssignable(s):this.checkLVal(s),this.next(),i.right=this.parseMaybeAssign(t),this.finishNode(i,"AssignmentExpression")}return s},h.parseMaybeConditional=function(t){var r=this.storeCurrentPos(),n=this.parseExprOps(t);if(this.eat(e.tokTypes.question)){var s=this.startNodeAt(r);return s.test=n,s.consequent=this.parseMaybeAssign(),s.alternate=this.expect(e.tokTypes.colon)?this.parseMaybeAssign(t):this.dummyIdent(),this.finishNode(s,"ConditionalExpression")}return n},h.parseExprOps=function(t){var e=this.storeCurrentPos(),r=this.curIndent,n=this.curLineStart;return this.parseExprOp(this.parseMaybeUnary(!1),e,-1,t,r,n)},h.parseExprOp=function(t,r,n,s,i,o){if(this.curLineStart!=o&&this.curIndent<i&&this.tokenStartsLine())return t;var a=this.tok.type.binop;if(null!=a&&(!s||this.tok.type!==e.tokTypes._in)&&a>n){var p=this.startNodeAt(r);if(p.left=t,p.operator=this.tok.value,this.next(),this.curLineStart!=o&&this.curIndent<i&&this.tokenStartsLine())p.right=this.dummyIdent();else{var u=this.storeCurrentPos();p.right=this.parseExprOp(this.parseMaybeUnary(!1),u,a,s,i,o)}return this.finishNode(p,/&&|\|\|/.test(p.operator)?"LogicalExpression":"BinaryExpression"),this.parseExprOp(p,r,n,s,i,o)}return t},h.parseMaybeUnary=function(t){var r,n=this,s=this.storeCurrentPos();if(this.tok.type.prefix){var i=this.startNode(),o=this.tok.type===e.tokTypes.incDec;o||(t=!0),i.operator=this.tok.value,i.prefix=!0,this.next(),i.argument=this.parseMaybeUnary(!0),o&&(i.argument=this.checkLVal(i.argument)),r=this.finishNode(i,o?"UpdateExpression":"UnaryExpression")}else if(this.tok.type===e.tokTypes.ellipsis){var a=this.startNode();this.next(),a.argument=this.parseMaybeUnary(t),r=this.finishNode(a,"SpreadElement")}else for(r=this.parseExprSubscripts();this.tok.type.postfix&&!this.canInsertSemicolon();){var p=n.startNodeAt(s);p.operator=n.tok.value,p.prefix=!1,p.argument=n.checkLVal(r),n.next(),r=n.finishNode(p,"UpdateExpression")}if(!t&&this.eat(e.tokTypes.starstar)){var u=this.startNodeAt(s);return u.operator="**",u.left=r,u.right=this.parseMaybeUnary(!1),this.finishNode(u,"BinaryExpression")}return r},h.parseExprSubscripts=function(){var t=this.storeCurrentPos();return this.parseSubscripts(this.parseExprAtom(),t,!1,this.curIndent,this.curLineStart)},h.parseSubscripts=function(t,r,n,s,i){for(var o=this;;){if(o.curLineStart!=i&&o.curIndent<=s&&o.tokenStartsLine()){if(o.tok.type!=e.tokTypes.dot||o.curIndent!=s)return t;--s}if(o.eat(e.tokTypes.dot)){var a=o.startNodeAt(r);a.object=t,o.curLineStart!=i&&o.curIndent<=s&&o.tokenStartsLine()?a.property=o.dummyIdent():a.property=o.parsePropertyAccessor()||o.dummyIdent(),a.computed=!1,t=o.finishNode(a,"MemberExpression")}else if(o.tok.type==e.tokTypes.bracketL){o.pushCx(),o.next();var p=o.startNodeAt(r);p.object=t,p.property=o.parseExpression(),p.computed=!0,o.popCx(),o.expect(e.tokTypes.bracketR),t=o.finishNode(p,"MemberExpression")}else if(n||o.tok.type!=e.tokTypes.parenL){if(o.tok.type!=e.tokTypes.backQuote)return t;var u=o.startNodeAt(r);u.tag=t,u.quasi=o.parseTemplate(),t=o.finishNode(u,"TaggedTemplateExpression")}else{var h=o.startNodeAt(r);h.callee=t,h.arguments=o.parseExprList(e.tokTypes.parenR),t=o.finishNode(h,"CallExpression")}}},h.parseExprAtom=function(){var t;switch(this.tok.type){case e.tokTypes._this:case e.tokTypes._super:var r=this.tok.type===e.tokTypes._this?"ThisExpression":"Super";return t=this.startNode(),this.next(),this.finishNode(t,r);case e.tokTypes.name:var s=this.storeCurrentPos(),i=this.parseIdent();return this.eat(e.tokTypes.arrow)?this.parseArrowExpression(this.startNodeAt(s),[i]):i;case e.tokTypes.regexp:t=this.startNode();var o=this.tok.value;return t.regex={pattern:o.pattern,flags:o.flags},t.value=o.value,t.raw=this.input.slice(this.tok.start,this.tok.end),this.next(),this.finishNode(t,"Literal");case e.tokTypes.num:case e.tokTypes.string:return t=this.startNode(),t.value=this.tok.value,t.raw=this.input.slice(this.tok.start,this.tok.end),this.next(),this.finishNode(t,"Literal");case e.tokTypes._null:case e.tokTypes._true:case e.tokTypes._false:return t=this.startNode(),t.value=this.tok.type===e.tokTypes._null?null:this.tok.type===e.tokTypes._true,t.raw=this.tok.type.keyword,this.next(),this.finishNode(t,"Literal");case e.tokTypes.parenL:var a=this.storeCurrentPos();this.next();var p=this.parseExpression();if(this.expect(e.tokTypes.parenR),this.eat(e.tokTypes.arrow))return this.parseArrowExpression(this.startNodeAt(a),p.expressions||(n(p)?[]:[p]));if(this.options.preserveParens){var u=this.startNodeAt(a);u.expression=p,p=this.finishNode(u,"ParenthesizedExpression")}return p;case e.tokTypes.bracketL:return t=this.startNode(),t.elements=this.parseExprList(e.tokTypes.bracketR,!0),this.finishNode(t,"ArrayExpression");case e.tokTypes.braceL:return this.parseObj();case e.tokTypes._class:return this.parseClass();case e.tokTypes._function:return t=this.startNode(),this.next(),this.parseFunction(t,!1);case e.tokTypes._new:return this.parseNew();case e.tokTypes.backQuote:return this.parseTemplate();default:return this.dummyIdent()}},h.parseNew=function(){var t=this.startNode(),r=this.curIndent,n=this.curLineStart,s=this.parseIdent(!0);if(this.options.ecmaVersion>=6&&this.eat(e.tokTypes.dot))return t.meta=s,t.property=this.parseIdent(!0),this.finishNode(t,"MetaProperty");var i=this.storeCurrentPos();return t.callee=this.parseSubscripts(this.parseExprAtom(),i,!0,r,n),this.tok.type==e.tokTypes.parenL?t.arguments=this.parseExprList(e.tokTypes.parenR):t.arguments=[],this.finishNode(t,"NewExpression")},h.parseTemplateElement=function(){var t=this.startNode();return t.value={raw:this.input.slice(this.tok.start,this.tok.end).replace(/\r\n?/g,"\n"),cooked:this.tok.value},this.next(),t.tail=this.tok.type===e.tokTypes.backQuote,this.finishNode(t,"TemplateElement")},h.parseTemplate=function(){var t=this,r=this.startNode();this.next(),r.expressions=[];var n=this.parseTemplateElement();for(r.quasis=[n];!n.tail;)t.next(),r.expressions.push(t.parseExpression()),t.expect(e.tokTypes.braceR)?n=t.parseTemplateElement():(n=t.startNode(),n.value={cooked:"",raw:""},n.tail=!0,t.finishNode(n,"TemplateElement")),r.quasis.push(n);return this.expect(e.tokTypes.backQuote),this.finishNode(r,"TemplateLiteral")},h.parseObj=function(){var t=this,r=this.startNode();r.properties=[],this.pushCx();var s=this.curIndent+1,i=this.curLineStart;for(this.eat(e.tokTypes.braceL),this.curIndent+1<s&&(s=this.curIndent,i=this.curLineStart);!this.closes(e.tokTypes.braceR,s,i);){var o,a,p=t.startNode();if(t.options.ecmaVersion>=6&&(a=t.storeCurrentPos(),p.method=!1,p.shorthand=!1,o=t.eat(e.tokTypes.star)),t.parsePropertyName(p),n(p.key))n(t.parseMaybeAssign())&&t.next(),t.eat(e.tokTypes.comma);else{if(t.eat(e.tokTypes.colon))p.kind="init",p.value=t.parseMaybeAssign();else if(t.options.ecmaVersion>=6&&(t.tok.type===e.tokTypes.parenL||t.tok.type===e.tokTypes.braceL))p.kind="init",p.method=!0,p.value=t.parseMethod(o);else if(t.options.ecmaVersion>=5&&"Identifier"===p.key.type&&!p.computed&&("get"===p.key.name||"set"===p.key.name)&&t.tok.type!=e.tokTypes.comma&&t.tok.type!=e.tokTypes.braceR)p.kind=p.key.name,t.parsePropertyName(p),p.value=t.parseMethod(!1);else{if(p.kind="init",t.options.ecmaVersion>=6)if(t.eat(e.tokTypes.eq)){var u=t.startNodeAt(a);u.operator="=",u.left=p.key,u.right=t.parseMaybeAssign(),p.value=t.finishNode(u,"AssignmentExpression")}else p.value=p.key;else p.value=t.dummyIdent();p.shorthand=!0}r.properties.push(t.finishNode(p,"Property")),t.eat(e.tokTypes.comma)}}return this.popCx(),this.eat(e.tokTypes.braceR)||(this.last.end=this.tok.start,this.options.locations&&(this.last.loc.end=this.tok.loc.start)),this.finishNode(r,"ObjectExpression")},h.parsePropertyName=function(t){if(this.options.ecmaVersion>=6){if(this.eat(e.tokTypes.bracketL))return t.computed=!0,t.key=this.parseExpression(),void this.expect(e.tokTypes.bracketR);t.computed=!1}var r=this.tok.type===e.tokTypes.num||this.tok.type===e.tokTypes.string?this.parseExprAtom():this.parseIdent();t.key=r||this.dummyIdent()},h.parsePropertyAccessor=function(){if(this.tok.type===e.tokTypes.name||this.tok.type.keyword)return this.parseIdent()},h.parseIdent=function(){var t=this.tok.type===e.tokTypes.name?this.tok.value:this.tok.type.keyword;if(!t)return this.dummyIdent();var r=this.startNode();return this.next(),r.name=t,this.finishNode(r,"Identifier")},h.initFunction=function(t){t.id=null,t.params=[],this.options.ecmaVersion>=6&&(t.generator=!1,t.expression=!1)},h.toAssignable=function(t,e){var r=this;if(!t||"Identifier"==t.type||"MemberExpression"==t.type&&!e);else if("ParenthesizedExpression"==t.type)t.expression=this.toAssignable(t.expression,e);else{if(this.options.ecmaVersion<6)return this.dummyIdent();if("ObjectExpression"==t.type){t.type="ObjectPattern";for(var n=t.properties,s=0;s<n.length;s++)n[s].value=r.toAssignable(n[s].value,e)}else if("ArrayExpression"==t.type)t.type="ArrayPattern",this.toAssignableList(t.elements,e);else if("SpreadElement"==t.type)t.type="RestElement",t.argument=this.toAssignable(t.argument,e);else{if("AssignmentExpression"!=t.type)return this.dummyIdent();t.type="AssignmentPattern",delete t.operator}}return t},h.toAssignableList=function(t,e){for(var r=this,n=0;n<t.length;n++)t[n]=r.toAssignable(t[n],e);return t},h.parseFunctionParams=function(t){return t=this.parseExprList(e.tokTypes.parenR),this.toAssignableList(t,!0)},h.parseMethod=function(t){var r=this.startNode();return this.initFunction(r),r.params=this.parseFunctionParams(),r.generator=t||!1,r.expression=this.options.ecmaVersion>=6&&this.tok.type!==e.tokTypes.braceL,r.body=r.expression?this.parseMaybeAssign():this.parseBlock(),this.finishNode(r,"FunctionExpression")},h.parseArrowExpression=function(t,r){return this.initFunction(t),t.params=this.toAssignableList(r,!0),t.expression=this.tok.type!==e.tokTypes.braceL,t.body=t.expression?this.parseMaybeAssign():this.parseBlock(),this.finishNode(t,"ArrowFunctionExpression")},h.parseExprList=function(t,r){var s=this;this.pushCx();var i=this.curIndent,o=this.curLineStart,a=[];for(this.next();!this.closes(t,i+1,o);)if(s.eat(e.tokTypes.comma))a.push(r?null:s.dummyIdent());else{var p=s.parseMaybeAssign();if(n(p)){if(s.closes(t,i,o))break;s.next()}else a.push(p);s.eat(e.tokTypes.comma)}return this.popCx(),this.eat(t)||(this.last.end=this.tok.start,this.options.locations&&(this.last.loc.end=this.tok.loc.start)),a},i.defaultOptions.tabSize=4,i.parse_dammit=s,i.LooseParser=a,i.pluginsLoose=o,t.parse_dammit=s,t.LooseParser=a,t.pluginsLoose=o,Object.defineProperty(t,"__esModule",{value:!0})}),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t.acorn=t.acorn||{},t.acorn.walk=t.acorn.walk||{}))}(this,function(t){"use strict";function e(e,r,n,s,i){n||(n=t.base),function t(e,s,i){var o=i||e.type,a=r[o];n[o](e,s,t),a&&a(e,s)}(e,s,i)}function r(e,r,n,s){n||(n=t.base);var i=[];!function t(e,s,o){var a=o||e.type,p=r[a],u=e!=i[i.length-1];u&&i.push(e),n[a](e,s,t),p&&p(e,s||i,i),u&&i.pop()}(e,s)}function n(e,r,n,s,i){var o=n?t.make(n,s):s;!function t(e,r,n){o[n||e.type](e,r,t)}(e,r,i)}function s(t){return"string"==typeof t?function(e){return e==t}:t||function(){return!0}}function i(e,r,n,i,o,a){i=s(i),o||(o=t.base);try{!function t(e,s,a){var p=a||e.type;if((null==r||e.start<=r)&&(null==n||e.end>=n)&&o[p](e,s,t),(null==r||e.start==r)&&(null==n||e.end==n)&&i(p,e))throw new l(e,s)}(e,a)}catch(t){if(t instanceof l)return t;throw t}}function o(e,r,n,i,o){n=s(n),i||(i=t.base);try{!function t(e,s,o){var a=o||e.type;if(!(e.start>r||e.end<r)&&(i[a](e,s,t),n(a,e)))throw new l(e,s)}(e,o)}catch(t){if(t instanceof l)return t;throw t}}function a(e,r,n,i,o){n=s(n),i||(i=t.base);try{!function t(e,s,o){if(!(e.end<r)){var a=o||e.type;if(e.start>=r&&n(a,e))throw new l(e,s);i[a](e,s,t)}}(e,o)}catch(t){if(t instanceof l)return t;throw t}}function p(e,r,n,i,o){n=s(n),i||(i=t.base);var a;return function t(e,s,o){if(!(e.start>r)){var p=o||e.type;e.end<=r&&(!a||a.node.end<e.end)&&n(p,e)&&(a=new l(e,s)),i[p](e,s,t)}}(e,o),a}function u(e,r){r||(r=t.base);var n=f(r);for(var s in e)n[s]=e[s];return n}function h(t,e,r){r(t,e)}function c(t,e,r){}var l=function(t,e){this.node=t,this.state=e},f=Object.create||function(t){function e(){}return e.prototype=t,new e},d={};d.Program=d.BlockStatement=function(t,e,r){for(var n=0;n<t.body.length;++n)r(t.body[n],e,"Statement")},d.Statement=h,d.EmptyStatement=c,d.ExpressionStatement=d.ParenthesizedExpression=function(t,e,r){return r(t.expression,e,"Expression")},d.IfStatement=function(t,e,r){r(t.test,e,"Expression"),r(t.consequent,e,"Statement"),t.alternate&&r(t.alternate,e,"Statement")},d.LabeledStatement=function(t,e,r){return r(t.body,e,"Statement")},d.BreakStatement=d.ContinueStatement=c,d.WithStatement=function(t,e,r){r(t.object,e,"Expression"),r(t.body,e,"Statement")},d.SwitchStatement=function(t,e,r){r(t.discriminant,e,"Expression");for(var n=0;n<t.cases.length;++n){var s=t.cases[n];s.test&&r(s.test,e,"Expression");for(var i=0;i<s.consequent.length;++i)r(s.consequent[i],e,"Statement")}},d.ReturnStatement=d.YieldExpression=function(t,e,r){t.argument&&r(t.argument,e,"Expression")},d.ThrowStatement=d.SpreadElement=function(t,e,r){return r(t.argument,e,"Expression")},d.TryStatement=function(t,e,r){r(t.block,e,"Statement"),t.handler&&r(t.handler,e),t.finalizer&&r(t.finalizer,e,"Statement")},d.CatchClause=function(t,e,r){r(t.param,e,"Pattern"),r(t.body,e,"ScopeBody")},d.WhileStatement=d.DoWhileStatement=function(t,e,r){r(t.test,e,"Expression"),r(t.body,e,"Statement")},d.ForStatement=function(t,e,r){t.init&&r(t.init,e,"ForInit"),t.test&&r(t.test,e,"Expression"),t.update&&r(t.update,e,"Expression"),r(t.body,e,"Statement")},d.ForInStatement=d.ForOfStatement=function(t,e,r){r(t.left,e,"ForInit"),r(t.right,e,"Expression"),r(t.body,e,"Statement")},d.ForInit=function(t,e,r){"VariableDeclaration"==t.type?r(t,e):r(t,e,"Expression")},d.DebuggerStatement=c,d.FunctionDeclaration=function(t,e,r){return r(t,e,"Function")},d.VariableDeclaration=function(t,e,r){for(var n=0;n<t.declarations.length;++n)r(t.declarations[n],e)},d.VariableDeclarator=function(t,e,r){r(t.id,e,"Pattern"),t.init&&r(t.init,e,"Expression")},d.Function=function(t,e,r){t.id&&r(t.id,e,"Pattern");for(var n=0;n<t.params.length;n++)r(t.params[n],e,"Pattern");r(t.body,e,t.expression?"ScopeExpression":"ScopeBody")},d.ScopeBody=function(t,e,r){return r(t,e,"Statement")},d.ScopeExpression=function(t,e,r){return r(t,e,"Expression")},d.Pattern=function(t,e,r){"Identifier"==t.type?r(t,e,"VariablePattern"):"MemberExpression"==t.type?r(t,e,"MemberPattern"):r(t,e)},d.VariablePattern=c,d.MemberPattern=h,d.RestElement=function(t,e,r){return r(t.argument,e,"Pattern")},d.ArrayPattern=function(t,e,r){for(var n=0;n<t.elements.length;++n){var s=t.elements[n];s&&r(s,e,"Pattern")}},d.ObjectPattern=function(t,e,r){for(var n=0;n<t.properties.length;++n)r(t.properties[n].value,e,"Pattern")},d.Expression=h,d.ThisExpression=d.Super=d.MetaProperty=c,d.ArrayExpression=function(t,e,r){for(var n=0;n<t.elements.length;++n){var s=t.elements[n];s&&r(s,e,"Expression")}},d.ObjectExpression=function(t,e,r){for(var n=0;n<t.properties.length;++n)r(t.properties[n],e)},d.FunctionExpression=d.ArrowFunctionExpression=d.FunctionDeclaration,d.SequenceExpression=d.TemplateLiteral=function(t,e,r){for(var n=0;n<t.expressions.length;++n)r(t.expressions[n],e,"Expression")},d.UnaryExpression=d.UpdateExpression=function(t,e,r){r(t.argument,e,"Expression")},d.BinaryExpression=d.LogicalExpression=function(t,e,r){r(t.left,e,"Expression"),r(t.right,e,"Expression")},d.AssignmentExpression=d.AssignmentPattern=function(t,e,r){r(t.left,e,"Pattern"),r(t.right,e,"Expression")},d.ConditionalExpression=function(t,e,r){r(t.test,e,"Expression"),r(t.consequent,e,"Expression"),r(t.alternate,e,"Expression")},d.NewExpression=d.CallExpression=function(t,e,r){if(r(t.callee,e,"Expression"),t.arguments)for(var n=0;n<t.arguments.length;++n)r(t.arguments[n],e,"Expression")},d.MemberExpression=function(t,e,r){r(t.object,e,"Expression"),t.computed&&r(t.property,e,"Expression")},d.ExportNamedDeclaration=d.ExportDefaultDeclaration=function(t,e,r){t.declaration&&r(t.declaration,e,"ExportNamedDeclaration"==t.type||t.declaration.id?"Statement":"Expression"),t.source&&r(t.source,e,"Expression")},d.ExportAllDeclaration=function(t,e,r){r(t.source,e,"Expression")},d.ImportDeclaration=function(t,e,r){for(var n=0;n<t.specifiers.length;n++)r(t.specifiers[n],e);r(t.source,e,"Expression")},d.ImportSpecifier=d.ImportDefaultSpecifier=d.ImportNamespaceSpecifier=d.Identifier=d.Literal=c,d.TaggedTemplateExpression=function(t,e,r){r(t.tag,e,"Expression"),r(t.quasi,e)},d.ClassDeclaration=d.ClassExpression=function(t,e,r){return r(t,e,"Class")},d.Class=function(t,e,r){t.id&&r(t.id,e,"Pattern"),t.superClass&&r(t.superClass,e,"Expression");for(var n=0;n<t.body.body.length;n++)r(t.body.body[n],e)},d.MethodDefinition=d.Property=function(t,e,r){t.computed&&r(t.key,e,"Expression"),r(t.value,e,"Expression")},t.simple=e,t.ancestor=r,t.recursive=n,t.findNodeAt=i,t.findNodeAround=o,t.findNodeAfter=a,t.findNodeBefore=p,t.make=u,t.base=d,Object.defineProperty(t,"__esModule",{value:!0})}),function(t,e){"object"==typeof exports&&"object"==typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t.tern||(t.tern={})).signal={})}(this,function(t){function e(t,e){var r=this._handlers||(this._handlers=Object.create(null));(r[t]||(r[t]=[])).push(e)}function r(t,e){var r=this._handlers&&this._handlers[t];if(r)for(var n=0;n<r.length;++n)if(r[n]==e){r.splice(n,1);break}}function n(t,e){var r=t._handlers&&t._handlers[e];return r&&r.length?r.slice():a}function s(t,e,r,s,i){for(var o=n(this,t),a=0;a<o.length;++a)o[a].call(this,e,r,s,i)}function i(t,e,r,s,i){for(var o=n(this,t),a=0;a<o.length;++a){var p=o[a].call(this,e,r,s,i);if(p)return p}}function o(t){var e=this._handlers&&this._handlers[t];return e&&e.length>0&&e}var a=[];t.mixin=function(t){return t.on=e,t.off=r,t.signal=s,t.signalReturnFirst=i,t.hasHandler=o,t}}),function(t,e){"object"==typeof exports&&"object"==typeof module?e(exports,require("./infer"),require("./signal"),require("acorn"),require("acorn/dist/walk")):"function"==typeof define&&define.amd?define(["exports","./infer","./signal","acorn/dist/acorn","acorn/dist/walk"],e):e(t.tern||(t.tern={}),tern,tern.signal,acorn,acorn.walk)}(this,function(t,e,r,n,s){"use strict";function i(t,e){this.name=t,this.parent=e,this.scope=this.text=this.ast=this.lineOffsets=null}function o(t,r){var n={directSourceFile:r,allowReturnOutsideFunction:!0,allowImportExportEverywhere:!0,ecmaVersion:t.options.ecmaVersion,allowHashBang:!0},s=t.signalReturnFirst("preParse",r.text,n)||r.text,i=e.parse(s,n);return t.signal("postParse",i,s),i}function a(t,r,n){t.text=n.options.stripCRs?r.replace(/\r\n/g,"\n"):r,e.withContext(n.cx,function(){t.ast=o(n,t)}),t.lineOffsets=null}function p(t,r,n){if(r.query&&!Y.hasOwnProperty(r.query.type))return n("No query type '"+r.query.type+"' defined");var s=r.query;s||n(null,{});var i=r.files||[];i.length&&++t.uses;for(var o=0;o<i.length;++o){var a=i[o];a.name=t.normalizeFilename(a.name),"delete"==a.type?t.delFile(a.name):h(t,a.name,null,"full"==a.type?a.text:null)}var p="number"==typeof r.timeout?[r.timeout]:null;if(!s)return void l(t,p,function(){});var u=Y[s.type];if(u.takesFile){if("string"!=typeof s.file)return n(".query.file must be a string");/^#/.test(s.file)||h(t,s.file,null)}l(t,p,function(r){if(r)return n(r);var o=u.takesFile&&g(t,i,s.file);if(u.fullFile&&"part"==o.type)return n("Can't run a "+s.type+" query on a file fragment");e.resetGuessing(),e.withContext(t.cx,function(){var r,i=function(){r=u.run(t,s,o)};try{p?e.withTimeout(p[0],i):i()}catch(e){return t.options.debug&&"TernError"!=e.name&&console.error(e.stack),n(e)}n(null,r)})})}function u(t,r){return e.withContext(t.cx,function(){r.scope=t.cx.topScope,t.signal("beforeLoad",r),e.analyze(r.ast,r.name,r.scope),t.signal("afterLoad",r)}),r}function h(t,e,r,n){var s=t.findFile(e);if(s)return null!=n&&(s.scope&&(t.needsPurge.push(e),s.scope=null),a(s,n,t)),void(x(t,s.parent)>x(t,r)&&(s.parent=r,s.excluded&&(s.excluded=null)));var o=new i(e,r);t.files.push(o),t.fileMap[e]=o,null!=n?a(o,n,t):t.options.async?(t.startAsyncAction(),t.options.getFile(e,function(e,r){a(o,r||"",t),t.finishAsyncAction(e)})):a(o,t.options.getFile(e)||"",t)}function c(t,e,r){var n=function(){t.off("everythingFetched",n),clearTimeout(s),l(t,e,r)};t.on("everythingFetched",n);var s=setTimeout(n,t.options.fetchTimeout)}function l(t,r,n){if(t.pending)return c(t,r,n);var s=t.fetchError;if(s)return t.fetchError=null,n(s);t.needsPurge.length>0&&e.withContext(t.cx,function(){e.purge(t.needsPurge),t.needsPurge.length=0});for(var i=!0,o=0;o<t.files.length;){for(var a=[];o<t.files.length;++o){var p=t.files[o];null==p.text?i=!1:null!=p.scope||p.excluded||a.push(p)}a.sort(function(e,r){return x(t,e.parent)-x(t,r.parent)});for(var h=0;h<a.length;h++){var p=a[h];if(p.parent&&!k(t,p))p.excluded=!0;else if(r){var l=+new Date;try{e.withTimeout(r[0],function(){u(t,p)})}catch(s){if(s instanceof e.TimedOut)return n(s);throw s}
r[0]-=+new Date-l}else u(t,p)}}i?n():c(t,r,n)}function f(t){var e=t.indexOf("\n");return e<0?t:t.slice(0,e)}function d(t,e,r){var n=Math.max(0,r-500),s=null;if(!/^\s*$/.test(t))for(;;){var i=e.indexOf(t,n);if(i<0||i>r+500)break;(null==s||Math.abs(s-r)>Math.abs(i-r))&&(s=i),n=i+t.length}return s}function y(t){for(var e=0;t;++e,t=t.prev);return e}function m(t){var e=new Error(t);return e.name="TernError",e}function g(t,r,n){var i=n.match(/^#(\d+)$/);if(!i)return t.findFile(n);var a=r[i[1]];if(!a||"delete"==a.type)throw m("Reference to unknown file "+n);if("full"==a.type)return t.fileMap[a.name];var p=a.backing=t.fileMap[a.name],u=a.offset;a.offsetLines&&(u={line:a.offsetLines,ch:0}),a.offset=u=X(p,null==a.offsetLines?a.offset:{line:a.offsetLines,ch:0},!0);var h,c,l=f(a.text),g=d(l,p.text,u),v=null==g?Math.max(0,p.text.lastIndexOf("\n",u)):g;return e.withContext(t.cx,function(){e.purge(a.name,v,v+a.text.length);var r,n=a.text;if(r=n.match(/(?:"([^"]*)"|([\w$]+))\s*:\s*function\b/)){var i=s.findNodeAround(a.backing.ast,v,"ObjectExpression");i&&i.node.objType&&(h={type:i.node.objType,prop:r[2]||r[1]})}if(g&&(r=l.match(/^(.*?)\bfunction\b/))){for(var u=r[1].length,f="",d=0;d<u;++d)f+=" ";a.text=f+n.slice(u),c=!0}var m=e.scopeAt(p.ast,v,p.scope),x=e.scopeAt(p.ast,v+n.length,p.scope),b=a.scope=y(m)<y(x)?x:m;a.ast=o(t,a),e.analyze(a.ast,a.name,b);t:if(h||c){var k=e.scopeAt(a.ast,l.length,m);if(!k.fnType)break t;if(h){var T=h.type.getProp(h.prop);T.addType(k.fnType)}else if(c){var w=e.scopeAt(p.ast,v+l.length,p.scope);if(w==m||!w.fnType)break t;var E=w.fnType,A=k.fnType;if(!A||A.name!=E.name&&E.name)break t;for(var d=0,S=Math.min(E.args.length,A.args.length);d<S;++d)E.args[d].propagate(A.args[d]);E.self.propagate(A.self),A.retval.propagate(E.retval)}}}),a}function v(t){var e=0;return s.simple(t,{Expression:function(){++e}}),e}function x(t,e){for(var r=0;e;)e=t.fileMap[e].parent,++r;return r}function b(t,e){for(;;){var r=t.fileMap[e.parent];if(!r.parent)break;e=r}return e.name}function k(t,e){var r=b(t,e),n=v(e.ast),s=t.budgets[r];return null==s&&(s=t.budgets[r]=t.options.dependencyBudget),!(s<n)&&(t.budgets[r]=s-n,!0)}function T(t){return"number"==typeof t||"object"==typeof t&&"number"==typeof t.line&&"number"==typeof t.ch}function w(t){if(t.query){if("string"!=typeof t.query.type)return".query.type must be a string";if(t.query.start&&!T(t.query.start))return".query.start must be a position";if(t.query.end&&!T(t.query.end))return".query.end must be a position"}if(t.files){if(!Array.isArray(t.files))return"Files property must be an array";for(var e=0;e<t.files.length;++e){var r=t.files[e];if("object"!=typeof r)return".files[n] must be objects";if("string"!=typeof r.name)return".files[n].name must be a string";if("delete"!=r.type){if("string"!=typeof r.text)return".files[n].text must be a string";if("part"==r.type){if(!T(r.offset)&&"number"!=typeof r.offsetLines)return".files[n].offset must be a position"}else if("full"!=r.type)return'.files[n].type must be "full" or "part"'}}}}function E(t,e){for(var r=t.text,n=t.lineOffsets||(t.lineOffsets=[0]),s=0,i=0,o=Math.min(Math.floor(e/K),n.length-1),s=n[o],i=o*K;i<e;){if(++i,0===(s=r.indexOf("\n",s)+1))return null;i%K==0&&n.push(s)}return s}function A(t,e){if(!t)return{line:0,ch:0};for(var r,n,s=t.lineOffsets||(t.lineOffsets=[0]),i=t.text,o=s.length-1;o>=0;--o)s[o]<=e&&(r=o*K,n=s[o]);for(;;){var a=i.indexOf("\n",n);if(a>=e||a<0)break;n=a+1,++r}return{line:r,ch:e-n}}function S(t){for(var e in t)null==t[e]&&delete t[e];return t}function P(t,e,r){null!=r&&(t[e]=r)}function N(t,e){"string"!=typeof t&&(t=t.name,e=e.name);var r=/^[A-Z]/.test(t);return r==/^[A-Z]/.test(e)?t<e?-1:t==e?0:1:r?1:-1}function C(t,e,r){return"Literal"==t.type&&"string"==typeof t.value&&t.start==e-1&&t.end<=r+1}function L(t,e){for(var r=0;r<t.properties.length;r++){var n=t.properties[r];if(n.key.start<=e&&n.key.end>=e)return n}}function I(t,r,s){function i(e,n,s,i){if((!x&&!1===r.omitObjectPrototype||n!=t.cx.protos.Object||c)&&!(!1!==r.filter&&c&&0!==(r.caseInsensitive?e.toLowerCase():e).indexOf(c)||h&&h.props[e])){var o=et(r,l,e,n&&n.props[e],s);i&&o&&"string"!=typeof o&&i(o)}}if(null==r.end)throw m("missing .query.end field");var o=t.signalReturnFirst("completion",s,r);if(o)return o;for(var a=X(s,r.end),p=a,u=s.text;a&&n.isIdentifierChar(u.charCodeAt(a-1));)--a;if(!1!==r.expandWordForward)for(;p<u.length&&n.isIdentifierChar(u.charCodeAt(p));)++p;var h,c=u.slice(a,p),l=[];r.caseInsensitive&&(c=c.toLowerCase());var f,d,y,g,v,x,b=e.findExpressionAround(s.ast,null,a,s.scope);if(b){var k=b.node;if("MemberExpression"==k.type&&k.object.end<a)v=b;else if(C(k,a,p)){var T=e.parentNode(k,s.ast);"MemberExpression"==T.type&&T.property==k&&(v={node:T,state:b.state})}else if("ObjectExpression"==k.type){var w=L(k,p);w?(x=b,d=g=w.key.name):c||/:\s*$/.test(s.text.slice(0,a))||(x=b,d=g=!0)}}if(x)y=e.typeFromContext(s.ast,x),h=x.node.objType;else if(v)d=v.node.property,d="Literal"==d.type?d.value.slice(1):d.name,v.node=v.node.object,y=e.expressionType(v);else if("."==u.charAt(a-1)){for(var E=a-1;E&&("."==u.charAt(E-1)||n.isIdentifierChar(u.charCodeAt(E-1)));)E--;var A=u.slice(E,a-1);A&&(y=e.def.parsePath(A,s.scope).getObjType(),d=c)}if(null!=d){if(t.cx.completingProperty=d,y&&e.forAllPropertiesOf(y,i),!l.length&&!1!==r.guess&&y&&y.guessProperties&&y.guessProperties(function(t,e,r){t!=d&&"✖"!=t&&i(t,e,r)}),!l.length&&c.length>=2&&!1!==r.guess)for(var d in t.cx.props)i(d,t.cx.props[d][0],0);f="memberCompletion"}else e.forAllLocalsAt(s.ast,a,s.scope,i),r.includeKeywords&&(t.options.ecmaVersion>=6?tt:J).forEach(function(t){i(t,null,0,function(t){t.isKeyword=!0})}),f="variableCompletion";return t.signal(f,s,a,p,i),!1!==r.sort&&l.sort(N),t.cx.completingProperty=null,{start:Z(r,s,a),end:Z(r,s,p),isProperty:!!d,isObjectKey:!!g,completions:l}}function O(t,e){var r=e.prefix,n=[];for(var s in t.cx.props)"<i>"==s||r&&0!==s.indexOf(r)||n.push(s);return!1!==e.sort&&n.sort(N),{completions:n}}function _(t,e){var r,n,s=t.body;return!!s&&(Array.isArray(s)?(r=s[0].start,n=s[s.length-1].end):(r=s.start,n=s.end),r<=e&&n>=e)}function F(t,e,r){var n=rt(t,e,r);if(n)return n;throw m("No expression at the given position.")}function j(t){return t&&(t=t.getType())&&t instanceof e.Obj?t:null}function R(t,r,n,s){var i;s&&(e.resetGuessing(),i=e.expressionType(s));var o=t.hasHandler("typeAt");if(o)for(var a=X(n,r.end),p=0;p<o.length;p++)i=o[p](n,a,s,i);if(!i)throw m("No type found at the given position.");var u;if("ObjectExpression"==s.node.type&&null!=r.end&&(u=L(s.node,X(n,r.end)))){var h=u.key.name,c=j(e.typeFromContext(n.ast,s));if(c&&c.hasProp(h))i=c.hasProp(h);else{var l=j(i);l&&l.hasProp(h)&&(i=l.hasProp(h))}}return i}function D(t,r,n){var s,i=rt(n,r),o=R(t,r,n,i),a=o;if(o=r.preferFunction?o.getFunctionType()||o.getType():o.getType(),i&&("Identifier"==i.node.type?s=i.node.name:"MemberExpression"!=i.node.type||i.node.computed?"MethodDefinition"!=i.node.type||i.node.computed||(s=i.node.key.name):s=i.node.property.name),null!=r.depth&&"number"!=typeof r.depth)throw m(".query.depth must be a number");var p={guess:e.didGuess(),type:e.toString(a,r.depth),name:o&&o.name,exprName:s,doc:a.doc,url:a.url};return o&&B(r,o,p),S(p)}function M(t,e){if(!e)return null;if("full"==t.docFormat)return e;var r=/.\n[\s@\n]/.exec(e);if(r&&(e=e.slice(0,r.index+1)),e=e.replace(/\n\s*/g," "),e.length<100)return e;var n=/[\.!?] [A-Z]/g;n.lastIndex=80;var s=n.exec(e);return s&&(e=e.slice(0,s.index+1)),e}function V(t,r,n){var s=rt(n,r),i=R(t,r,n,s),o={url:i.url,doc:M(r,i.doc),type:e.toString(i)},a=i.getType();return a&&B(r,a,o),S(o)}function B(t,r,n){n.url||(n.url=r.url),n.doc||(n.doc=M(t,r.doc)),n.origin||(n.origin=r.origin);var s,i=e.cx().protos;!n.url&&!n.doc&&r.proto&&(s=r.proto.hasCtor)&&r.proto!=i.Object&&r.proto!=i.Function&&r.proto!=i.Array&&(n.url=s.url,n.doc=M(t,s.doc))}function q(t,r,n){var s=rt(n,r),i=R(t,r,n,s);if(e.didGuess())return{};var o=nt(i),a={url:i.url,doc:M(r,i.doc),origin:i.origin};if(i.types)for(var p=i.types.length-1;p>=0;--p){var u=i.types[p];B(r,u,a),o||(o=nt(u))}if(o&&o.node){var h=o.node.sourceFile||t.fileMap[o.origin],c=Z(r,h,o.node.start),l=Z(r,h,o.node.end);a.start=c,a.end=l,a.file=o.origin;var f=Math.max(0,o.node.start-50);a.contextOffset=o.node.start-f,a.context=h.text.slice(f,f+50)}else o&&(a.file=o.origin,st(t,r,o,a));return S(a)}function U(t,r,n,s,i){function o(t){return function(e,n,s){var o={file:t.name,start:Z(r,t,e.start),end:Z(r,t,e.end)};if(i){for(var u=n;u!=p;u=u.prev){var c=u.hasProp(i);if(c)throw m("Renaming `"+a+"` to `"+i+"` would make a variable at line "+(A(t,e.start).line+1)+" point to the definition at line "+(A(t,c.name.start).line+1))}var l=s[s.length-2];l&&"Property"==l.type&&l.key==l.value&&(o.isShorthand=!0)}h.push(o)}}for(var a=s.node.name,p=s.state;p&&!(a in p.props);p=p.prev);if(!p)throw m("Could not find a definition for "+a);var u,h=[];if(p.originNode){if(u="local",i){for(var c=p.prev;c&&!(i in c.props);c=c.prev);c&&e.findRefs(p.originNode,p,i,c,function(t){throw m("Renaming `"+a+"` to `"+i+"` would shadow the definition used at line "+(A(n,t.start).line+1))})}e.findRefs(p.originNode,p,a,p,o(n))}else if(u="global",r.onlySourceFile)e.findRefs(n.ast,n.scope,a,p,o(n));else for(var l=0;l<t.files.length;++l){var f=t.files[l];e.findRefs(f.ast,f.scope,a,p,o(f))}return{refs:h,type:u,name:a}}function W(t,r,n,s,i){function o(t){return function(e){u.push({file:t.name,start:Z(r,t,e.start),end:Z(r,t,e.end)})}}var a=e.expressionType(s);"MethodDefinition"==s.node.type&&(a=a.propertyOf);var p=a.getObjType();if(!p)throw m("Couldn't determine type of base object.");var u=[];if(r.onlySourceFile)e.findPropRefs(n.ast,n.scope,p,i.name,o(n));else for(var h=0;h<t.files.length;++h){var c=t.files[h];e.findPropRefs(c.ast,c.scope,p,i.name,o(c))}return{refs:u,name:i.name}}function z(t,e,r){var n=F(r,e,!0);if(n&&"Identifier"==n.node.type)return U(t,e,r,n);if(n&&"MemberExpression"==n.node.type&&!n.node.computed){var s=n.node.property;return n.node=n.node.object,W(t,e,r,n,s)}if(n&&"ObjectExpression"==n.node.type)for(var i=X(r,e.end),o=0;o<n.node.properties.length;++o){var a=n.node.properties[o].key;if(a.start<=i&&a.end>=i)return W(t,e,r,n,a)}else if(n&&"MethodDefinition"==n.node.type){var s=n.node.key;return W(t,e,r,n,s)}throw m("Not at a variable or property name.")}function G(t,e,r){if("string"!=typeof e.newName)throw m(".query.newName should be a string");var n=F(r,e);if(!n||"Identifier"!=n.node.type)throw m("Not at a variable.");var s=U(t,e,r,n,e.newName),i=s.refs;delete s.refs,s.files=t.files.map(function(t){return t.name});for(var o=s.changes=[],a=0;a<i.length;++a){var p=i[a];p.isShorthand?p.text=n.node.name+": "+e.newName:p.text=e.newName,o.push(p)}return s}function $(t){return{files:t.files.map(function(t){return t.name})}}var H=Object.create(null);t.registerPlugin=function(t,e){H[t]=e};var Q=t.defaultOptions={debug:!1,async:!1,getFile:function(t,e){this.async&&e(null,null)},normalizeFilename:function(t){return t},defs:[],plugins:{},fetchTimeout:1e3,dependencyBudget:2e4,reuseInstances:!0,stripCRs:!1,ecmaVersion:6,projectDir:"/",parent:null},Y={completions:{takesFile:!0,run:I},properties:{run:O},type:{takesFile:!0,run:D},documentation:{takesFile:!0,run:V},definition:{takesFile:!0,run:q},refs:{takesFile:!0,fullFile:!0,run:z},rename:{takesFile:!0,fullFile:!0,run:G},files:{run:$}};t.defineQueryType=function(t,e){Y[t]=e},i.prototype.asLineChar=function(t){return A(this,t)},(t.Server=function(t){this.cx=null,this.options=t||{};for(var e in Q)t.hasOwnProperty(e)||(t[e]=Q[e]);this.projectDir=t.projectDir.replace(/\\/g,"/"),/\/$/.test(this.projectDir)||(this.projectDir+="/"),this.parent=t.parent,this.handlers=Object.create(null),this.files=[],this.fileMap=Object.create(null),this.needsPurge=[],this.budgets=Object.create(null),this.uses=0,this.pending=0,this.asyncError=null,this.mod={},this.defs=t.defs.slice(0),this.plugins=Object.create(null);for(var r in t.plugins)t.plugins.hasOwnProperty(r)&&this.loadPlugin(r,t.plugins[r]);this.reset()}).prototype=r.mixin({addFile:function(t,e,r){!r||r in this.fileMap||(r=null),t in this.fileMap||(t=this.normalizeFilename(t)),h(this,t,r,e)},delFile:function(t){var e=this.findFile(t);if(e){this.needsPurge.push(e.name);for(var r=0;r<this.files.length;r++)this.files[r]==e?this.files.splice(r--,1):this.files[r].parent==t&&(this.files[r].parent=null);delete this.fileMap[e.name]}},reset:function(){this.signal("reset"),this.cx=new e.Context(this.defs,this),this.uses=0,this.budgets=Object.create(null);for(var t=0;t<this.files.length;++t)this.files[t].scope=null;this.signal("postReset")},request:function(t,e){var r=w(t);if(r)return e(r);var n=this;p(this,t,function(t,r){e(t,r),n.uses>40&&(n.reset(),l(n,null,function(){}))})},findFile:function(t){return this.fileMap[this.normalizeFilename(t)]},flush:function(t){var r=this.cx;l(this,null,function(n){if(n)return t(n);e.withContext(r,t)})},startAsyncAction:function(){++this.pending},finishAsyncAction:function(t){t&&(this.asyncError=t),0==--this.pending&&this.signal("everythingFetched")},addDefs:function(t,e){e?this.defs.unshift(t):this.defs.push(t),this.cx&&this.reset()},deleteDefs:function(t){for(var e=0;e<this.defs.length;e++)if(this.defs[e]["!name"]==t)return this.defs.splice(e,1),void(this.cx&&this.reset())},loadPlugin:function(t,e){if(1==arguments.length&&(e=this.options.plugins[t]||!0),!(t in this.plugins)&&t in H&&e){this.plugins[t]=!0;var r=H[t](this,e);if(r&&(r.defs&&this.addDefs(r.defs,r.loadFirst),r.passes))for(var n in r.passes)r.passes.hasOwnProperty(n)&&this.on(n,r.passes[n])}},normalizeFilename:function(t){var e=this.options.normalizeFilename(t).replace(/\\/g,"/");return 0==e.indexOf(this.projectDir)&&(e=e.slice(this.projectDir.length)),e}});var K=25,X=t.resolvePos=function(t,e,r){if("number"!=typeof e){var n=E(t,e.line);if(null==n){if(!r)throw m("File doesn't contain a line "+e.line);e=t.text.length}else e=n+e.ch}if(e>t.text.length){if(!r)throw m("Position "+e+" is outside of file.");e=t.text.length}return e},Z=t.outputPos=function(t,e,r){if(t.lineCharPositions){var n=A(e,r);return"part"==e.type&&(n.line+=null!=e.offsetLines?e.offsetLines:A(e.backing,e.offset).line),n}return r+("part"==e.type?e.offset:0)},J="break do instanceof typeof case else new var catch finally return void continue for switch while debugger function this with default if throw delete in try".split(" "),tt=J.concat("export class extends const super yield import let static".split(" ")),et=t.addCompletion=function(t,r,n,s,i){for(var o=t.types||t.docs||t.urls||t.origins,a=o||t.depths,p=0;p<r.length;++p){var u=r[p];if((a?u.name:u)==n)return}var h=a?{name:n}:n;if(r.push(h),s&&o){e.resetGuessing();var c=s.getType();h.guess=e.didGuess(),t.types&&(h.type=e.toString(s)),t.docs&&P(h,"doc",M(t,s.doc||c&&c.doc)),t.urls&&P(h,"url",s.url||c&&c.url),t.origins&&P(h,"origin",s.origin||c&&c.origin)}return t.depths&&(h.depth=i||0),h},rt=t.findQueryExpr=function(t,r,n){if(null==r.end)throw m("missing .query.end field");if(r.variable){var s=e.scopeAt(t.ast,X(t,r.end),t.scope);return{node:{type:"Identifier",name:r.variable,start:r.end,end:r.end+1},state:s}}var i=r.start&&X(t,r.start),o=X(t,r.end),a=e.findExpressionAt(t.ast,i,o,t.scope);if(!a){var p=e.findExpressionAround(t.ast,i,o,t.scope);p&&!_(p.node,o)&&("ObjectExpression"==p.node.type||n||(null==i?o:i)-p.node.start<20||p.node.end-o<20)&&(a=p)}return a},nt=t.getSpan=function(t){if(t.origin){if(t.originNode){var e=t.originNode;return/^Function/.test(e.type)&&e.id&&(e=e.id),{origin:t.origin,node:e}}return t.span?{origin:t.origin,span:t.span}:void 0}},st=t.storeSpan=function(t,e,r,n){if(n.origin=r.origin,r.span){var s=/^(\d+)\[(\d+):(\d+)\]-(\d+)\[(\d+):(\d+)\]$/.exec(r.span);n.start=e.lineCharPositions?{line:Number(s[2]),ch:Number(s[3])}:Number(s[1]),n.end=e.lineCharPositions?{line:Number(s[5]),ch:Number(s[6])}:Number(s[4])}else{var i=t.fileMap[r.origin];n.start=Z(e,i,r.node.start),n.end=Z(e,i,r.node.end)}};t.version="0.19.0"}),function(t){"object"==typeof exports&&"object"==typeof module?exports.init=t:"function"==typeof define&&define.amd?define({init:t}):tern.def={init:t}}(function(t,e){"use strict";function r(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function n(t,e,r){return t.call?t(e,r):t}function s(t,r){if("!ret"==r){if(t.retval)return t.retval;var n=new e.AVal;return t.propagate(new e.IsCallee(e.ANull,[],null,n)),n}return t.getProp(r)}function i(t,r,s,i){return function(o,a){for(var p=[],u=0;u<r.length;u++)p.push(n(r[u],o,a));return new e.Fn(t,e.ANull,p,n(s,o,a),i)}}function o(t){return function(r,s){for(var i=new e.AVal,o=0;o<t.length;o++)n(t[o],r,s).propagate(i);return i.maxWeight=1e5,i}}function a(t){return function(r,n){return new e.Arr(t(r,n))}}function p(t){return function(r,s){return new e.Arr(t.map(function(t){return n(t,r,s)}))}}function u(t){if(t instanceof e.Fn&&t.args)for(var r=0;r<t.args.length;++r){var n=t.args[r];n instanceof e.Fn&&n.args&&n.args.length&&h(t,r)}}function h(t,r){l(t,function(n,s){s[r]&&s[r].propagate(new e.IsCallee(e.cx().topScope,t.args[r].args,null,e.ANull))})}function c(t,r,n,s){var i=new b(t,null,n,s).parseType(!1,r,!0);return i instanceof e.AVal?i.types.forEach(u):u(i),i}function l(t,e,r){var n=t.computeRet,s=t.retval;t.computeRet=function(t,i,o){var a=e(t,i,o),p=n?n(t,i,o):s;return r?a:p}}function f(t,r){for(var n=0;n<r.length&&t!=e.ANull;++n){var s=r[n];if("!"==s.charAt(0))if("!proto"==s)t=t instanceof e.Obj&&t.proto||e.ANull;else{var i=t.getFunctionType();if(i)if("!ret"==s)t=i.retval&&i.retval.getType(!1)||e.ANull;else{var o=i.args&&i.args[Number(s.slice(1))];t=o&&o.getType(!1)||e.ANull}else t=e.ANull}else if(t instanceof e.Obj&&("prototype"==s&&t instanceof e.Fn||t.hasProp(s))){var a=t.getProp(s);t=!a||a.isEmpty()?e.ANull:a.types[0]}else t=e.ANull}return t}function d(t){var e=Object.create(t.prototype);return e.props=Object.create(null),e.isShell=!0,e}function y(t){if(!t["!type"]||/^(fn\(|\[|\+)/.test(t["!type"]))return!1;for(var e in t)if("!type"!=e&&"!doc"!=e&&"!url"!=e&&"!span"!=e&&"!data"!=e)return!1;return!0}function m(t,n,s){if(!t){var i=n["!type"];if(i)if(/^fn\(/.test(i))t=d(e.Fn);else if("["==i.charAt(0))t=d(e.Arr);else{if("+"!=i.charAt(0))throw new Error("Invalid !type spec: "+i);t=d(e.Obj)}else t=n["!stdProto"]?e.cx().protos[n["!stdProto"]]:d(e.Obj);t.name=s}for(var o in n)if(r(n,o)&&33!=o.charCodeAt(0)){var a=n[o];if("string"==typeof a||y(a))continue;var p=t.defProp(o);m(p.getObjType(),a,s?s+"."+o:o).propagate(p)}return t}function g(t,n,s){if(t.isShell){delete t.isShell;var i=n["!type"];if(i)c(i,s,t);else{var o=n["!proto"]&&c(n["!proto"]);e.Obj.call(t,!(o instanceof e.Obj)||o,s)}}var a=n["!effects"];if(a&&t instanceof e.Fn)for(var p=0;p<a.length;++p)T(a[p],t);v(n,t);for(var u in n)if(r(n,u)&&33!=u.charCodeAt(0)){var h=n[u],l=t.defProp(u),f=s?s+"."+u:u;if("string"==typeof h)l.isEmpty()&&c(h,f).propagate(l);else{if(y(h)){if(!l.isEmpty())continue;c(h["!type"],f,null,!0).propagate(l)}else g(l.getObjType(),h,f);h["!doc"]&&(l.doc=h["!doc"]),h["!url"]&&(l.url=h["!url"]),h["!span"]&&(l.span=h["!span"])}}return t}function v(t,e){t["!doc"]&&(e.doc=t["!doc"]),t["!url"]&&(e.url=t["!url"]),t["!span"]&&(e.span=t["!span"]),t["!data"]&&(e.metaData=t["!data"])}function x(t,r){var n=e.cx(),s=n.parent;e.addOrigin(n.curOrigin=t["!name"]||"env#"+n.origins.length),n.localDefs=n.definitions[n.curOrigin]=Object.create(null),s&&s.signal("preLoadDef",t),m(r,t);var i=t["!define"];if(i){for(var o in i){var a=i[o];n.localDefs[o]="string"==typeof a?w(a):m(null,a,o)}for(var o in i){var a=i[o];"string"!=typeof a&&g(n.localDefs[o],i[o],o)}}g(r,t),s&&s.signal("postLoadDef",t),n.curOrigin=n.localDefs=null}var b=t.TypeParser=function(t,e,r,n){this.pos=e||0,this.spec=t,this.base=r,this.forceNew=n};b.prototype={eat:function(t){if(1==t.length?this.spec.charAt(this.pos)==t:this.spec.indexOf(t,this.pos)==this.pos)return this.pos+=t.length,!0},word:function(t){for(var e,r="",t=t||/[\w$]/;(e=this.spec.charAt(this.pos))&&t.test(e);)r+=e,++this.pos;return r},error:function(){throw new Error("Unrecognized type spec: "+this.spec+" (at "+this.pos+")")},parseFnType:function(t,r,n,s){var o=[],a=[],p=!1;if(!this.eat(")"))for(var u=0;;++u){var h,c=this.spec.indexOf(": ",this.pos);-1!=c&&(h=this.spec.slice(this.pos,c),/^[$\w?]+$/.test(h)?this.pos=c+2:h=null),a.push(h);var l=this.parseType(t);if(l.call&&(p=!0),o.push(l),!this.eat(", ")){this.eat(")")||this.error();break}}var f,d,y,m;if(this.eat(" -> ")){var g=this.pos;f=this.parseType(!0),f.call&&!p&&(d=f,f=e.ANull,y=g)}else f=e.ANull;return p?i(r,o,f,s):(n&&(m=this.base)?e.Fn.call(this.base,r,e.ANull,o,a,f,s):m=new e.Fn(r,e.ANull,o,a,f,s),d&&(m.computeRet=d),null!=y&&(m.computeRetSource=this.spec.slice(y,this.pos)),m)},parseType:function(t,r,n){var s=this.parseTypeMaybeProp(t,r,n);if(!this.eat("|"))return s;for(var i=[s],a=s.call;;){var p=this.parseTypeMaybeProp(t,r,n);if(i.push(p),p.call&&(a=!0),!this.eat("|"))break}if(a)return o(i);for(var u=new e.AVal,h=0;h<i.length;h++)i[h].propagate(u);return u.maxWeight=1e5,u},parseTypeMaybeProp:function(t,e,r){for(var n=this.parseTypeInner(t,e,r);t&&this.eat(".");)n=this.extendWithProp(n);return n},extendWithProp:function(t){var e=this.word(/[\w<>$!:]/)||this.error();return t.apply?function(r,n){return s(t(r,n),e)}:s(t,e)},parseTypeInner:function(t,r,n){var s;if(this.eat("fn(")||(s=this.eat("fn*(")))return this.parseFnType(t,r,n,s);if(this.eat("[")){for(var i,o=this.parseType(t),u=o.call;this.eat(", ");){i||(i=[o]);var h=this.parseType(t);i.push(h),u=u||h.call}return this.eat("]")||this.error(),u?i?p(i):a(o):n&&this.base?(e.Arr.call(this.base,i||o),this.base):new e.Arr(i||o)}if(this.eat("+")){var c=this.word(/[\w$<>\.:!]/),l=e.cx().localDefs[c+".prototype"];if(!l){var l=w(c);if(!(l instanceof e.Obj))return l;var d=f(l,["prototype"]);d&&(d=d.getObjType())&&(l=d)}if(t&&this.eat("["))return this.parsePoly(l);if(n&&this.base){this.base.proto=l;var r=l.hasCtor&&l.hasCtor.name||l.name;return r&&(this.base.name=r),this.base}return n&&this.forceNew?new e.Obj(l):e.getInstance(l)}if(this.eat(":")){var r=this.word(/[\w$\.]/);return e.getSymbol(r)}if(t&&this.eat("!")){var y=this.word(/\d/);if(y)return y=Number(y),function(t,r){return r[y]||e.ANull};if(this.eat("this"))return function(t){return t};if(this.eat("custom:")){var m=this.word(/[\w$]/);return E[m]||function(){return e.ANull}}return this.fromWord("!"+this.word(/[\w$<>\.!:]/))}return this.eat("?")?e.ANull:this.fromWord(this.word(/[\w$<>\.!:`]/))},fromWord:function(t){var r=e.cx();switch(t){case"number":return r.num;case"string":return r.str;case"bool":return r.bool;case"<top>":return r.topScope}return r.localDefs&&t in r.localDefs?r.localDefs[t]:w(t)},parsePoly:function(t){var r,n="<i>";(r=this.spec.slice(this.pos).match(/^\s*([\w$:]+)\s*=\s*/))&&(n=r[1],this.pos+=r[0].length);var s=this.parseType(!0);if(this.eat("]")||this.error(),s.call)return function(r,i){var o=new e.Obj(t);return s(r,i).propagate(o.defProp(n)),o};var i=new e.Obj(t);return s.propagate(i.defProp(n)),i}};var k,T=t.parseEffect=function(t,r){var s;if(0==t.indexOf("propagate ")){var i=new b(t,10),o=i.parseType(!0);i.eat(" ")||i.error();var a=i.parseType(!0);l(r,function(t,e){n(o,t,e).propagate(n(a,t,e))})}else if(0==t.indexOf("call ")){var p=5==t.indexOf("and return ",5),i=new b(t,p?16:5),u=i.parseType(!0),h=null,c=[];for(i.eat(" this=")&&(h=i.parseType(!0));i.eat(" ");)c.push(i.parseType(!0));l(r,function(t,r){for(var s=n(u,t,r),i=h?n(h,t,r):e.ANull,o=[],a=0;a<c.length;++a)o.push(n(c[a],t,r));var l=p?new e.AVal:e.ANull;return s.propagate(new e.IsCallee(i,o,null,l)),l},p)}else if(s=t.match(/^custom (\S+)\s*(.*)/)){var f=E[s[1]];f&&l(r,s[2]?f(s[2]):f)}else{if(0!=t.indexOf("copy "))throw new Error("Unknown effect type: "+t);var i=new b(t,5),d=i.parseType(!0);i.eat(" ");var y=i.parseType(!0);l(r,function(t,r){var s=n(d,t,r),i=n(y,t,r);s.forAllProps(function(t,r,n){n&&"<i>"!=t&&i.propagate(new e.DefProp(t,r))})})}},w=t.parsePath=function(t,r){var n=e.cx(),s=n.paths[t],i=t;if(null!=s)return s;n.paths[t]=e.ANull;var o=r||k||n.topScope;if(n.localDefs)for(var a in n.localDefs)if(0==t.indexOf(a)){if(t==a)return n.paths[t]=n.localDefs[t];if("."==t.charAt(a.length)){o=n.localDefs[a],t=t.slice(a.length+1);break}}var p=f(o,t.split("."));return n.paths[i]=p==e.ANull?null:p,p};t.load=function(t,r){r||(r=e.cx().topScope);var n=k;k=r;try{x(t,r)}finally{k=n}},t.parse=function(t,r,n){var s=e.cx();r&&(s.origin=r,s.localDefs=s.definitions[r]);try{return"string"==typeof t?c(t,n):g(m(null,t,n),t,n)}finally{r&&(s.origin=s.localDefs=null)}};var E=Object.create(null);e.registerFunction=function(t,e){E[t]=e};var A=e.constraint({construct:function(t,e,r){this.created=t,this.target=e,this.spec=r},addType:function(t){if(t instanceof e.Obj&&this.created++<5){var r=new e.Obj(t),n=this.spec;if(n instanceof e.AVal&&(n=n.getObjType(!1)),n instanceof e.Obj)for(var s in n.props){var i=n.props[s].types[0],o=r.defProp(s);if(i&&i instanceof e.Obj&&i.props.value){var a=i.props.value.getType(!1);a&&o.addType(a)}}this.target.addType(r)}}});e.registerFunction("Object_create",function(t,r,n){if(n&&n.length&&"Literal"==n[0].type&&null==n[0].value)return new e.Obj;var s=new e.AVal;return r[0]&&r[0].propagate(new A(0,s,r[1])),s});var S=e.constraint({construct:function(t){this.target=t},addType:function(t){t instanceof e.Obj&&(t.hasProp("value")?t.getProp("value").propagate(this.target):t.hasProp("get")&&t.getProp("get").propagate(new e.IsCallee(e.ANull,[],null,this.target)))}});e.registerFunction("Object_defineProperty",function(t,r,n){if(n&&n.length>=3&&"Literal"==n[1].type&&"string"==typeof n[1].value){var s=r[0],i=new e.AVal;s.propagate(new e.DefProp(n[1].value,i,n[1])),r[2].propagate(new S(i))}return e.ANull}),e.registerFunction("Object_defineProperties",function(t,r,n){if(r.length>=2){var s=r[0];r[1].forAllProps(function(t,r,i){if(i){var o=new e.AVal;s.propagate(new e.DefProp(t,o,n&&n[1])),r.propagate(new S(o))}})}return e.ANull});var P=e.constraint({construct:function(t,e,r){this.self=t,this.args=e,this.target=r},addType:function(t){if(t instanceof e.Fn){this.target.addType(new e.Fn(t.name,e.ANull,t.args.slice(this.args.length),t.argNames.slice(this.args.length),t.retval,t.generator)),this.self.propagate(t.self);for(var r=0;r<Math.min(t.args.length,this.args.length);++r)this.args[r].propagate(t.args[r])}}});e.registerFunction("Function_bind",function(t,r){if(!r.length)return e.ANull;var n=new e.AVal;return t.propagate(new P(r[0],r.slice(1),n)),n}),e.registerFunction("Array_ctor",function(t,r){var n=new e.Arr;if(1!=r.length||!r[0].hasType(e.cx().num))for(var s=n.getProp("<i>"),i=0;i<r.length;++i)r[i].propagate(s);return n}),e.registerFunction("Promise_ctor",function(t,r,n){var s=e.cx().definitions.ecma6;if(!s||r.length<1)return e.ANull;var i=new e.Obj(s["Promise.prototype"]),o=i.defProp(":t",n&&n[0]),a=new e.AVal;a.propagate(o);var p=new e.Fn("execute",e.ANull,[a],["value"],e.ANull),u=s.Promise_reject;return r[0].propagate(new e.IsCallee(e.ANull,[p,u],null,e.ANull)),i});var N=e.constraint({construct:function(t){this.output=t},addType:function(t){t.constructor==e.Obj&&"Promise"==t.name&&t.hasProp(":t")?t.getProp(":t").propagate(this.output):t.propagate(this.output)}});return e.registerFunction("Promise_then",function(t,r,n){var s=r.length&&r[0].getFunctionType(),i=e.cx().definitions.ecma6;if(!s||!i)return t;var o,a=new e.Obj(i["Promise.prototype"]),p=a.defProp(":t",n&&n[0]);return s.retval.isEmpty()&&(o=t.getType())instanceof e.Obj&&o.hasProp(":t")&&o.getProp(":t").propagate(p,50),s.retval.propagate(new N(p)),a}),e.registerFunction("getOwnPropertySymbols",function(t,r){if(!r.length)return e.ANull;var n=new e.AVal;return r[0].forAllProps(function(t,r,s){s&&":"==t.charAt(0)&&n.addType(e.getSymbol(t.slice(1)))}),n}),e.registerFunction("getSymbol",function(t,r,n){return n.length&&"Literal"==n[0].type&&"string"==typeof n[0].value?e.getSymbol(n[0].value):e.ANull}),t}),function(t){"object"==typeof exports&&"object"==typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(tern.comment||(tern.comment={}))}(function(t){function e(t){return t<14&&t>8||32===t||160===t}function r(t,r){for(;r>0;--r){var n=t.charCodeAt(r-1);if(10==n)break;if(!e(n))return!1}return!0}t.commentsBefore=function(t,n){var s,i=null,o=0;t:for(;n>0;){var a=t.charCodeAt(n-1);if(10==a)for(var p=--n,u=!1;p>0;--p){if(47==(a=t.charCodeAt(p-1))&&47==t.charCodeAt(p-2)){if(!r(t,p-2))break t;var h=t.slice(p,n);!o&&s?i[0]=h+"\n"+i[0]:(i||(i=[])).unshift(h),s=!0,o=0,n=p-2;break}if(10==a){if(!u&&++o>1)break t;break}u||e(a)||(u=!0)}else if(47==a&&42==t.charCodeAt(n-2)){for(var p=n-2;p>1;--p)if(42==t.charCodeAt(p-1)&&47==t.charCodeAt(p-2)){if(!r(t,p-2))break t;(i||(i=[])).unshift(t.slice(p,n-2)),s=!1,o=0;break}n=p-2}else{if(!e(a))break;--n}}return i},t.commentAfter=function(t,r){for(;r<t.length;){var n=t.charCodeAt(r);if(47==n){var s,i=t.charCodeAt(r+1);if(47==i)s=t.indexOf("\n",r+2);else{if(42!=i)return;s=t.indexOf("*/",r+2)}return t.slice(r+2,s<0?t.length:s)}e(n)&&++r}},t.ensureCommentsBefore=function(e,r){return r.hasOwnProperty("commentsBefore")?r.commentsBefore:r.commentsBefore=t.commentsBefore(e,r.start)}}),function(t,e){"object"==typeof exports&&"object"==typeof module?e(exports,require("acorn"),require("acorn/dist/acorn_loose"),require("acorn/dist/walk"),require("./def"),require("./signal")):"function"==typeof define&&define.amd?define(["exports","acorn/dist/acorn","acorn/dist/acorn_loose","acorn/dist/walk","./def","./signal"],e):e(t.tern||(t.tern={}),acorn,acorn,acorn.walk,tern.def,tern.signal)}(this,function(t,e,r,n,s,i){"use strict";function o(t,e){var r=Object.create(t);if(e)for(var n in e)r[n]=e[n];return r}function a(t,e,r){var n=t.getType(!1),s=e.getType(!1);return!n||!s||p(n,s,r)}function p(t,e,r){if(!t||r>=5)return e;if(!t||t==e)return t;if(!e)return t;if(t.constructor!=e.constructor)return!1;if(t.constructor!=bt){if(t.constructor==gt){var n=0,s=0,i=0;for(var o in t.props)n++,o in e.props&&a(t.props[o],e.props[o],r+1)&&i++;for(var o in e.props)s++;return!(n&&s&&i<Math.max(n,s)/2)&&(n>s?t:e)}return t.constructor==xt&&(!!(t.args.length==e.args.length&&t.args.every(function(t,n){return a(t,e.args[n],r+1)})&&a(t.retval,e.retval,r+1)&&a(t.self,e.self,r+1))&&t)}var u=t.getProp("<i>").getType(!1);if(!u)return e;var h=e.getProp("<i>").getType(!1);return!h||p(u,h,r+1)?e:void 0}function u(t){for(var e=0,r=0,n=0,s=null,i=0;i<t.length;++i){var o=t[i];if(o instanceof bt)++e;else if(o instanceof xt)++r;else if(o instanceof gt)++n;else if(o instanceof mt){if(s&&o.name!=s.name)return null;s=o}}if((e&&1)+(r&&1)+(n&&1)+(s&&1)>1)return null;if(s)return s;for(var a=0,p=null,i=0;i<t.length;++i){var o=t[i],u=0;if(e)u=o.getProp("<i>").isEmpty()?1:2;else if(r){u=1;for(var h=0;h<o.args.length;++h)o.args[h].isEmpty()||++u;o.retval.isEmpty()||++u}else n&&(u=o.name?100:2);u>=a&&(a=u,p=o)}return p}function h(t,e){Tt.disabledComputing={fn:t,prev:Tt.disabledComputing};var r=e();return Tt.disabledComputing=Tt.disabledComputing.prev,r}function c(t){var e=t.charCodeAt(0);return e>=48&&e<=57&&!/\D/.test(t)}function l(t){return"__proto__"==t||"✖"==t||vt&&"__iterator__"==t}function f(t,e){(Tt.props[t]||(Tt.props[t]=[])).push(e)}function d(t){return Tt.props[t]}function y(e){if(Tt.workList)return e(Tt.workList);for(var r=[],n=0,s=Tt.workList=function(t,e,s){n<Et-At*r.length&&r.push(t,e,s,n)},i=e(s),o=0;o<r.length;o+=4){if(wt&&+new Date>=wt)throw new t.TimedOut;n=r[o+3]+1,r[o+1].addType(r[o],r[o+2])}return Tt.workList=null,i}function m(t,e,r){var n=Tt.curSuperCtor,s=Tt.curSuper;Tt.curSuperCtor=t,Tt.curSuper=e;var i=r();return Tt.curSuperCtor=n,Tt.curSuper=s,i}function g(t,e){for(;t.isBlock||t.isCatch||!1===e&&t.fnType&&t.fnType.isArrowFn();)t=t.prev;return t}function v(t,e){var r=g(t).fnType;r&&(r.instantiateScore=(r.instantiateScore||0)+e)}function x(t,e){try{return n.simple(t,{Expression:function(){if(--e<=0)throw Pt}}),!0}catch(t){if(t==Pt)return!1;throw t}}function b(t,e){var r=e.instantiateScore
;if(!Tt.disabledComputing&&r&&e.args.length&&x(t,5*r))return v(g(e.originNode.scope.prev),r/2),k(t,e),!0;e.instantiateScore=null}function k(t,e){for(var r=0;r<e.args.length;++r)e.args[r]=new Z;e.self=new Z,e.computeRet=function(r,s){return h(e,function(){var i=Tt.curOrigin;Tt.curOrigin=e.origin;var o=t.scope,a=new St(o.prev,o.originNode);for(var p in o.props)for(var u=a.defProp(p,o.props[p].originNode),h=0;h<s.length;++h)e.argNames[h]==p&&h<s.length&&s[h].propagate(u);for(var c=e.argNames.length!=s.length?e.argNames.slice(0,s.length):e.argNames;c.length<s.length;)c.push("?");if(a.fnType=new xt(e.name,r,s,c,K,e.generator),a.fnType.originNode=e.originNode,e.arguments){var l=a.fnType.arguments=new Z;a.defProp("arguments").addType(new bt(l));for(var h=0;h<s.length;++h)s[h].propagate(l)}return t.scope=a,n.recursive(t.body,a,null,Nt),n.recursive(t.body,a,null,Ot),Tt.curOrigin=i,a.fnType.retval})}}function T(t){function e(t,n,s){if(!(s>3)&&t.forward)for(var i=0;i<t.forward.length;++i){var o=t.forward[i].propagatesTo();if(o){var a,p=n;if(o instanceof Z)a=o;else{if(!(o.target instanceof Z))continue;p+=o.pathExt,a=o.target}if(a==r)return p;var u=e(a,p,s+1);if(u)return u}}}var r=t.retval;if(r!=K&&!t.isArrowFn()){var n,i;!r.isEmpty()&&(n=r.getType())instanceof bt&&(r=i=n.getProp("<i>"));for(var o=e(t.self,"!this",0),a=0;!o&&a<t.args.length;++a)o=e(t.args[a],"!"+a,0);if(o){i&&(o="["+o+"]");var p=new s.TypeParser(o),u=p.parseType(!0);return t.computeRet=u.apply?u:function(){return u},t.computeRetSource=o,!0}}}function w(t,e){return t.defProp(e.name,e)}function E(t){return"Identifier"==t.type?t.name:"AssignmentPattern"==t.type?E(t.left):"ObjectPattern"==t.type?"{"+t.properties.map(function(t){return E(t.value)}).join(", ")+"}":"ArrayPattern"==t.type?"["+t.elements.map(function(t){return t?E(t):""}).join(", ")+"]":"RestElement"==t.type?"..."+E(t.argument):"_"}function A(t){return"VariableDeclaration"==t.type&&"var"!=t.kind||"FunctionDeclaration"==t.type||"ClassDeclaration"==t.type}function S(t,e){return{inner:t,outer:e||t}}function P(t){var e=t.getSymbolType();if(e)return e.asPropName()}function N(t){switch(t){case"+":case"-":case"~":return Tt.num;case"!":return Tt.bool;case"typeof":return Tt.str;case"void":case"delete":return K}}function C(t){switch(t){case"==":case"!=":case"===":case"!==":case"<":case">":case">=":case"<=":case"in":case"instanceof":return!0}}function L(t){if(t.regex)return at(Tt.protos.RegExp);switch(typeof t.value){case"boolean":return Tt.bool;case"number":return Tt.num;case"string":return Tt.str;case"object":case"function":return t.value?at(Tt.protos.RegExp):K}}function I(t,e){if(t==e||e==K)return t;if(t==K)return e;var r=new Z;return t.propagate(r),e.propagate(r),r}function O(t,e){for(var r=0;r<t.params.length;r++){var n=t.params[r];"Identifier"!=n.type&&F(n,e,t.scope.fnType.args[r])}}function _(t,e){return e.hasProp(t.name)||Tt.topScope.defProp(t.name,t)}function F(t,e,r){var n=Lt[t.type];n&&n(t,e,r)}function j(t){var e=g(t);return e.fnType?e.fnType.self:e}function R(t){t.isEmpty()&&t.propertyOf&&(t.propertyOf.getProp(t.propertyName).addType(new gt,X),R(t.propertyOf))}function D(t,e,r){!r&&t.id&&(r=t.id.name);var n,s,i=Tt.protos.Object;if(t.superClass)if("Literal"==t.superClass.type&&null==t.superClass.value)i=null;else{var o,a=q(t.superClass,e);n=a.getFunctionType(),n&&(o=n.getProp("prototype").getObjType())?i=o:(n=a,s=a.getProp("prototype"))}var p=new gt(i,r&&r+".prototype");return s&&s.propagate(new ft(p)),m(n,s||i,function(){for(var n,s=t.body.body,i=0;i<s.length;i++)"constructor"==s[i].kind&&(n=s[i].value);var o=t.objType=n?q(n,e):new xt(r,K,[],null,K);o.originNode=t.id||n||t;var a=at(p,o);o.self.addType(a),o.defProp("prototype",t).addType(p);for(var i=0;i<s.length;i++){var u,h=s[i];if("constructor"!=h.kind){var c=Ct(h,e);"<i>"==c||"set"==h.kind?u=K:(u=(h.static?o:p).defProp(c,h.key),u.initializer=!0,"get"==h.kind&&(u=new st(a,[],null,u))),q(h.value,e,u);var l=u.getFunctionType();l&&l.self.addType(a)}}return o})}function M(t,e,r){var n=t.length>1&&t.length<6;if(n){for(var s,i=!0,o=0;o<t.length;o++){var a=t[o];a?"Literal"!=a.type||s&&s!=typeof a.value?i=!1:s=typeof a.value:n=!1}i&&(n=!1)}if(n){for(var p=[],o=0;o<t.length;++o)p.push(r(t[o],e));return new bt(p)}if(t.length<2)return new bt(t[0]&&r(t[0],e));for(var u=new Z,o=0;o<t.length;o++)t[o]&&r(t[o],e).propagate(u);return new bt(u)}function V(t){return function(e,r,n,s){var i=t(e,r,s);return n&&i.propagate(n),i}}function B(t){return function(e,r,n,s){return n||(n=new Z),t(e,r,n,s),n}}function q(t,e,r,n){var s=It[t.type];return s?s(t,e,r,n):K}function U(t){return"VariableDeclaration"==t.type?t.declarations[0].id:t}function W(t,e,r){var n=Array.isArray(t);return n&&1==t.length&&(t=t[0],n=!1),n?null==r?function(e){return t.indexOf(e.origin)>-1}:function(n,s){return s&&s.start>=e&&s.end<=r&&t.indexOf(n.origin)>-1}:null==r?function(e){return e.origin==t}:function(n,s){return s&&s.start>=e&&s.end<=r&&n.origin==t}}function z(t){Dt=!0;var e=d(t);if(e)for(var r=0;r<e.length;++r){var n=e[r].getProp(t);if(!n.isEmpty())return n}return K}function G(t,e){var r=new gt(!0);r.defProp("done").addType(Tt.bool),e.propagate(r.defProp("value"));var n=new xt(null,K,t?[t]:[],t?["?"]:[],r),s=new gt(Tt.definitions.ecma6&&Tt.definitions.ecma6.generator_prototype||!0);return s.defProp("next").addType(n),s}function $(t,e){return t.generator?t.computeRet?G(t.yieldval,e):(!0===t.generator&&(t.generator=G(t.yieldval,e)),t.generator):e}function H(t,e,r){var n=Q(t,r).getFunctionType();if(!n)return K;var s=n.retval;if(n.computeRet){for(var i=0,o=[];i<e.length;++i)o.push(Q(e[i],r));var a=K;"MemberExpression"==t.type&&(a=Q(t.object,r)),s=n.computeRet(a,o,e)}return $(n,s)}function Q(t,e){var r=Ft[t.type];return r?r(t,e):K}var Y=t.toString=function(t,e,r){return!t||t==r||e&&e<-3?"?":t.toString(e,r)},K=t.ANull=i.mixin({addType:function(){},propagate:function(){},getProp:function(){return K},forAllProps:function(){},hasType:function(){return!1},isEmpty:function(){return!0},getFunctionType:function(){},getObjType:function(){},getSymbolType:function(){},getType:function(){},gatherProperties:function(){},propagatesTo:function(){},typeHint:function(){},propHint:function(){},toString:function(){return"?"}}),X=1,Z=t.AVal=function(){this.types=[],this.forward=null,this.maxWeight=0};Z.prototype=o(K,{addType:function(t,e){if(e=e||100,this.maxWeight<e){if(this.maxWeight=e,1==this.types.length&&this.types[0]==t)return;this.types.length=0}else if(this.maxWeight>e||this.types.indexOf(t)>-1)return;this.signal("addType",t),this.types.push(t);var r=this.forward;r&&y(function(n){for(var s=0;s<r.length;++s)n(t,r[s],e)})},propagate:function(t,e){if(!(t==K||t instanceof yt&&this.forward&&this.forward.length>2)){e&&100!=e&&(t=new dt(t,e)),(this.forward||(this.forward=[])).push(t);var r=this.types;r.length&&y(function(n){for(var s=0;s<r.length;++s)n(r[s],t,e)})}},getProp:function(t){if(l(t))return K;var e=(this.props||(this.props=Object.create(null)))[t];return e||(e=this.props[t]=new Z,this.propagate(new et(t,e))),e},forAllProps:function(t){this.propagate(new nt(t))},hasType:function(t){return this.types.indexOf(t)>-1},isEmpty:function(){return 0===this.types.length},getFunctionType:function(){for(var t=this.types.length-1;t>=0;--t)if(this.types[t]instanceof xt)return this.types[t]},getObjType:function(){for(var t=null,e=this.types.length-1;e>=0;--e){var r=this.types[e];if(r instanceof gt){if(r.name)return r;t||(t=r)}}return t},getSymbolType:function(){for(var t=this.types.length-1;t>=0;--t)if(this.types[t]instanceof kt)return this.types[t]},getType:function(t){return 0===this.types.length&&!1!==t?this.makeupType():1===this.types.length?this.types[0]:u(this.types)},toString:function(t,e){if(0==this.types.length)return Y(this.makeupType(),t,e);if(1==this.types.length)return Y(this.types[0],t,e);var r=J(this.types);return r.length>2?"?":r.map(function(r){return Y(r,t,e)}).join("|")},makeupPropType:function(t){var e=this.propertyName,r=t.proto&&t.proto.hasProp(e);if(r){var n=r.getType();if(n)return n}if("<i>"!=e){var s=t.hasProp("<i>");if(s)return s.getType()}else if(t.props["<i>"]!=this)for(var i in t.props){var o=t.props[i];if(!o.isEmpty())return o.getType()}},makeupType:function(){var t=this.propertyOf&&this.makeupPropType(this.propertyOf);if(t)return t;if(!this.forward)return null;for(var e=this.forward.length-1;e>=0;--e){var r=this.forward[e].typeHint();if(r&&!r.isEmpty())return Dt=!0,r}for(var n=Object.create(null),s=null,e=0;e<this.forward.length;++e){var i=this.forward[e].propHint();i&&"length"!=i&&"<i>"!=i&&"✖"!=i&&i!=Tt.completingProperty&&(n[i]=!0,s=i)}if(!s)return null;var o=d(s);if(o){var a=[];t:for(var e=0;e<o.length;++e){var p=o[e];for(var i in n)if(!p.hasProp(i))continue t;p.hasCtor&&(p=at(p)),a.push(p)}var h=u(a);if(h)return Dt=!0,h}},typeHint:function(){return this.types.length?this.getType():null},propagatesTo:function(){return this},gatherProperties:function(t,e){for(var r=0;r<this.types.length;++r)this.types[r].gatherProperties(t,e)},guessProperties:function(t){if(this.forward)for(var e=0;e<this.forward.length;++e){var r=this.forward[e].propHint();r&&t(r,null,0)}var n=this.makeupType();n&&n.gatherProperties(t)}});var J=t.simplifyTypes=function(t){var e=[];t:for(var r=0;r<t.length;++r){for(var n=t[r],s=0;s<e.length;s++){var i=p(n,e[s],0);if(i){e[s]=i;continue t}}e.push(n)}return e},tt=t.constraint=function(t){var e=function(){this.origin=Tt.curOrigin,this.construct.apply(this,arguments)};e.prototype=Object.create(K);for(var r in t)t.hasOwnProperty(r)&&(e.prototype[r]=t[r]);return e},et=tt({construct:function(t,e){this.prop=t,this.target=e},addType:function(t,e){t.getProp&&t.getProp(this.prop).propagate(this.target,e)},propHint:function(){return this.prop},propagatesTo:function(){if("<i>"==this.prop||!/[^\w_]/.test(this.prop))return{target:this.target,pathExt:"."+this.prop}}}),rt=t.PropHasSubset=t.DefProp=tt({construct:function(t,e,r){this.prop=t,this.type=e,this.originNode=r},addType:function(t,e){if(t instanceof gt){var r=t.defProp(this.prop,this.originNode);r.origin||(r.origin=this.origin),this.type.propagate(r,e)}},propHint:function(){return this.prop}}),nt=tt({construct:function(t){this.c=t},addType:function(t){t instanceof gt&&t.forAllProps(this.c)}}),st=t.IsCallee=tt({construct:function(t,e,r,n){this.self=t,this.args=e,this.argNodes=r,this.retval=n,this.disabled=Tt.disabledComputing},addType:function(t,e){if(t instanceof xt){for(var r=0;r<this.args.length;++r)r<t.args.length&&this.args[r].propagate(t.args[r],e),t.arguments&&this.args[r].propagate(t.arguments,e);t.isArrowFn()||this.self.propagate(t.self,this.self==Tt.topScope?90:e);var n=t.computeRet,s=t.retval;if(n)for(var i=this.disabled;i;i=i.prev)(i.fn==t||t.originNode&&i.fn.originNode==t.originNode)&&(n=null);if(n){var o=Tt.disabledComputing;Tt.disabledComputing=this.disabled,s=n(this.self,this.args,this.argNodes),Tt.disabledComputing=o}$(t,s).propagate(this.retval,e)}},typeHint:function(){for(var t=[],e=0;e<this.args.length;++e)t.push("?");return new xt(null,this.self,this.args,t,K)},propagatesTo:function(){return{target:this.retval,pathExt:".!ret"}}}),it=tt({construct:function(t,e,r,n){this.propName=t,this.args=e,this.argNodes=r,this.retval=n,this.disabled=Tt.disabledComputing},addType:function(t,e){var r=new st(t,this.args,this.argNodes,this.retval);r.disabled=this.disabled,t.getProp(this.propName).propagate(r,e)},propHint:function(){return this.propName}}),ot=t.IsCtor=tt({construct:function(t,e){this.target=t,this.noReuse=e},addType:function(t,e){t instanceof xt&&(Tt.parent&&!Tt.parent.options.reuseInstances&&(this.noReuse=!0),t.getProp("prototype").propagate(new pt(!this.noReuse&&t,this.target),e))}}),at=t.getInstance=function(t,e){if(!1===e)return new gt(t);e||(e=t.hasCtor),t.instances||(t.instances=[]);for(var r=0;r<t.instances.length;++r){var n=t.instances[r];if(n.ctor==e)return n.instance}var s=new gt(t,e&&e.name);return s.origin=t.origin,t.instances.push({ctor:e,instance:s}),s},pt=t.IsProto=tt({construct:function(t,e){this.ctor=t,this.target=e},addType:function(t,e){t instanceof gt&&((this.count=(this.count||0)+1)>8||(t==Tt.protos.Array?this.target.addType(new bt):this.target.addType(at(t,this.ctor))))}}),ut=tt({construct:function(t){this.fn=t},addType:function(t,e){if(t instanceof gt&&!t.hasCtor){t.hasCtor=this.fn;var r=new lt(t,this.fn);r.addType(this.fn),t.forAllProps(function(t,e,n){n&&e.propagate(r)})}}}),ht=tt({construct:function(t,e){this.other=t,this.target=e},addType:function(t,e){t==Tt.str?this.target.addType(Tt.str,e):t==Tt.num&&this.other.hasType(Tt.num)&&this.target.addType(Tt.num,e)},typeHint:function(){return this.other}}),ct=t.IfObj=tt({construct:function(t){this.target=t},addType:function(t,e){t instanceof gt&&this.target.addType(t,e)},propagatesTo:function(){return this.target}}),lt=tt({construct:function(t,e){this.obj=t,this.ctor=e},addType:function(t){t instanceof xt&&t.self&&t.self.addType(at(this.obj,this.ctor),4)}}),ft=tt({construct:function(t){this.obj=t},addType:function(t){t instanceof gt&&this.obj.proto==Tt.protos.Object&&this.obj.replaceProto(t)}}),dt=tt({construct:function(t,e){this.inner=t,this.weight=e},addType:function(t,e){this.inner.addType(t,Math.min(e,this.weight))},propagatesTo:function(){return this.inner.propagatesTo()},typeHint:function(){return this.inner.typeHint()},propHint:function(){return this.inner.propHint()}}),yt=t.Type=function(){};yt.prototype=o(K,{constructor:yt,propagate:function(t,e){t.addType(this,e)},hasType:function(t){return t==this},isEmpty:function(){return!1},typeHint:function(){return this},getType:function(){return this}});var mt=t.Prim=function(t,e){this.name=e,this.proto=t};mt.prototype=o(yt.prototype,{constructor:mt,toString:function(){return this.name},getProp:function(t){return this.proto.hasProp(t)||K},gatherProperties:function(t,e){this.proto&&this.proto.gatherProperties(t,e)}});var gt=t.Obj=function(t,e){if(this.props||(this.props=Object.create(null)),this.proto=!0===t?Tt.protos.Object:t,t&&t!=Tt.protos.Object&&!e&&t.name&&!(this instanceof xt)){var r=/^(.*)\.prototype$/.exec(this.proto.name);r&&(e=r[1])}this.name=e,this.maybeProps=null,this.origin=Tt.curOrigin};gt.prototype=o(yt.prototype,{constructor:gt,toString:function(t){if(null==t&&(t=0),t<=0&&this.name)return this.name;var e=[],r=!1;for(var n in this.props)if("<i>"!=n){if(e.length>5){r=!0;break}t?e.push(n+": "+Y(this.props[n],t-1,this)):e.push(n)}return e.sort(),r&&e.push("..."),"{"+e.join(", ")+"}"},hasProp:function(t,e){c(t)&&(t=this.normalizeIntegerProp(t));var r=this.props[t];if(!1!==e)for(var n=this.proto;n&&!r;n=n.proto)r=n.props[t];return r},defProp:function(t,e){var r=this.hasProp(t,!1);if(r)return e&&!r.originNode&&(r.originNode=e),r;if(l(t))return K;c(t)&&(t=this.normalizeIntegerProp(t));var n=this.maybeProps&&this.maybeProps[t];return n?(delete this.maybeProps[t],this.maybeUnregProtoPropHandler()):(n=new Z,n.propertyOf=this,n.propertyName=t),this.props[t]=n,n.originNode=e,n.origin=Tt.curOrigin,this.broadcastProp(t,n,!0),n},getProp:function(t){var e=this.hasProp(t,!0)||this.maybeProps&&this.maybeProps[t];if(e)return e;if(l(t))return K;c(t)&&(t=this.normalizeIntegerProp(t));var r=this.ensureMaybeProps()[t]=new Z;return r.propertyOf=this,r.propertyName=t,r},normalizeIntegerProp:function(t){return"<i>"},broadcastProp:function(t,e,r){if(r&&(this.signal("addProp",t,e),this instanceof St||f(t,this)),this.onNewProp)for(var n=0;n<this.onNewProp.length;++n){var s=this.onNewProp[n];s.onProtoProp?s.onProtoProp(t,e,r):s(t,e,r)}},onProtoProp:function(t,e,r){var n=this.maybeProps&&this.maybeProps[t];n&&(delete this.maybeProps[t],this.maybeUnregProtoPropHandler(),this.proto.getProp(t).propagate(n)),this.broadcastProp(t,e,!1)},replaceProto:function(t){this.proto&&this.maybeProps&&this.proto.unregPropHandler(this),this.proto=t,this.maybeProps&&this.proto.forAllProps(this)},ensureMaybeProps:function(){return this.maybeProps||(this.proto&&this.proto.forAllProps(this),this.maybeProps=Object.create(null)),this.maybeProps},removeProp:function(t){var e=this.props[t];delete this.props[t],this.ensureMaybeProps()[t]=e,e.types.length=0},forAllProps:function(t){this.onNewProp||(this.onNewProp=[],this.proto&&this.proto.forAllProps(this)),this.onNewProp.push(t);for(var e=this;e;e=e.proto)for(var r in e.props)t.onProtoProp?t.onProtoProp(r,e.props[r],e==this):t(r,e.props[r],e==this)},maybeUnregProtoPropHandler:function(){if(this.maybeProps){for(var t in this.maybeProps)return;this.maybeProps=null}!this.proto||this.onNewProp&&this.onNewProp.length||this.proto.unregPropHandler(this)},unregPropHandler:function(t){for(var e=0;e<this.onNewProp.length;++e)if(this.onNewProp[e]==t){this.onNewProp.splice(e,1);break}this.maybeUnregProtoPropHandler()},gatherProperties:function(t,e){for(var r in this.props)"<i>"!=r&&":"!=r.charAt(0)&&t(r,this,e);this.proto&&this.proto.gatherProperties(t,e+1)},getObjType:function(){return this}});var vt="undefined"!=typeof StopIteration,xt=t.Fn=function(t,e,r,n,s,i){gt.call(this,Tt.protos.Function,t),this.self=e,this.args=r,this.argNames=n,this.retval=s,this.generator=i};xt.prototype=o(gt.prototype,{constructor:xt,toString:function(t){null==t&&(t=0);for(var e=this.generator?"fn*(":"fn(",r=0;r<this.args.length;++r){r&&(e+=", ");var n=this.argNames[r];n&&"?"!=n&&(e+=n+": "),e+=t>-3?Y(this.args[r],t-1,this):"?"}return e+=")",this.retval.isEmpty()||(e+=" -> "+(t>-3?Y(this.retval,t-1,this):"?")),e},getProp:function(t){if("prototype"==t){var e=this.hasProp(t,!1);if(!e){e=this.defProp(t);var r=new gt(!0,this.name&&this.name+".prototype");r.origin=this.origin,e.addType(r,10)}return e}return gt.prototype.getProp.call(this,t)},defProp:function(t,e){if("prototype"==t){var r=this.hasProp(t,!1);return r||(r=gt.prototype.defProp.call(this,t,e),r.origin=this.origin,r.propagate(new ut(this)),r)}return gt.prototype.defProp.call(this,t,e)},getFunctionType:function(){return this},isArrowFn:function(){return this.originNode&&"ArrowFunctionExpression"==this.originNode.type}});var bt=t.Arr=function(t){gt.call(this,Tt.protos.Array);var e=this.defProp("<i>");if(Array.isArray(t)){this.tuple=t.length;for(var r=0;r<t.length;r++){var n=this.defProp(String(r));t[r].propagate(n),n.propagate(e)}}else t&&(this.tuple=0,t.propagate(e))};bt.prototype=o(gt.prototype,{constructor:bt,toString:function(t){if(null==t&&(t=0),t<=-3)return"[?]";var e="";if(this.tuple){for(var r,n=0;n in this.props;n++){var s=Y(this.getProp(String(n)),t-1,this);r=null==r?s:r==s&&s,e+=(e?", ":"")+s}r&&(e=r)}else e=Y(this.getProp("<i>"),t-1,this);return"["+e+"]"},normalizeIntegerProp:function(t){return+t<this.tuple?t:"<i>"}});var kt=t.Sym=function(t,e){mt.call(this,Tt.protos.Symbol,"Symbol"),this.symName=t,this.originNode=e};kt.prototype=o(mt.prototype,{constructor:kt,asPropName:function(){return":"+this.symName},getSymbolType:function(){return this}}),t.getSymbol=function(t,e){var r=t.replace(/[^\w$\.]/g,"_"),n=Tt.symbols[r];return n?(e&&!n.originNode&&(n.originNode=e),n):Tt.symbols[r]=new kt(r,e)},t.Context=function(e,r){this.parent=r,this.props=Object.create(null),this.protos=Object.create(null),this.origins=[],this.curOrigin="ecma5",this.paths=Object.create(null),this.definitions=Object.create(null),this.purgeGen=0,this.workList=null,this.disabledComputing=null,this.curSuperCtor=this.curSuper=null,this.symbols=Object.create(null),t.withContext(this,function(){if(Tt.protos.Object=new gt(null,"Object.prototype"),Tt.topScope=new St,Tt.topScope.name="<top>",Tt.protos.Array=new gt(!0,"Array.prototype"),Tt.protos.Function=new xt("Function.prototype",K,[],[],K),Tt.protos.Function.proto=Tt.protos.Object,Tt.protos.RegExp=new gt(!0,"RegExp.prototype"),Tt.protos.String=new gt(!0,"String.prototype"),Tt.protos.Number=new gt(!0,"Number.prototype"),Tt.protos.Boolean=new gt(!0,"Boolean.prototype"),Tt.protos.Symbol=new gt(!0,"Symbol.prototype"),Tt.str=new mt(Tt.protos.String,"string"),Tt.bool=new mt(Tt.protos.Boolean,"bool"),Tt.num=new mt(Tt.protos.Number,"number"),Tt.curOrigin=null,e)for(var t=0;t<e.length;++t)s.load(e[t])})},t.Context.prototype.startAnalysis=function(){this.disabledComputing=this.workList=this.curSuperCtor=this.curSuper=null};var Tt=null;t.cx=function(){return Tt},t.withContext=function(t,e){var r=Tt;Tt=t;try{return e()}finally{Tt=r}},t.TimedOut=function(){this.message="Timed out",this.stack=(new Error).stack},t.TimedOut.prototype=Object.create(Error.prototype),t.TimedOut.prototype.name="infer.TimedOut";var wt;t.withTimeout=function(t,e){var r=+new Date+t,n=wt;if(n&&n<r)return e();wt=r;try{return e()}finally{wt=n}},t.addOrigin=function(t){Tt.origins.indexOf(t)<0&&Tt.origins.push(t)};var Et=20,At=1e-4,St=t.Scope=function(t,e,r,n){gt.call(this,t||!0),this.prev=t,this.originNode=e,this.isBlock=!!r,this.isCatch=!!n};St.prototype=o(gt.prototype,{constructor:St,defVar:function(t,e){for(var r=this;;r=r.proto){var n=r.props[t];if(n)return n;if(!r.prev)return r.defProp(t,e)}}});var Pt={},Nt=t.scopeGatherer=n.make({VariablePattern:function(t,e){e.inner&&w(e.inner,t)},AssignmentPattern:function(t,e,r){r(t.left,e,"Pattern"),r(t.right,e.outer,"Expression")},AssignmentExpression:function(t,e,r){"MemberExpression"==t.left.type?r(t.left,e,"Expression"):r(t.left,S(!1,e),"Pattern"),r(t.right,e,"Expression")},MemberPattern:function(t,e,r){r(t,e.outer)},Function:function(t,e,r){for(var n=t.scope=new St(e,t),s=[],i=[],o=0;o<t.params.length;++o){var a=t.params[o];if(i.push(E(a)),"Identifier"==a.type)s.push(w(n,a));else{var p=new Z;s.push(p),p.originNode=a,r(a,S(n),"Pattern")}}if(n.fnType=new xt(t.id&&t.id.name,new Z,s,i,K,t.generator),n.fnType.originNode=t,t.id){w("FunctionDeclaration"==t.type?e:n,t.id)}r(t.body,n,t.expression?"Expression":"Statement")},BlockStatement:function(t,e,r){!t.scope&&t.body.some(A)&&(e=t.scope=new St(e,t,!0)),n.base.BlockStatement(t,e,r)},CatchClause:function(t,e,r){if(e=t.scope=new St(e,t,!1,!0),"Identifier"==t.param.type){var n=w(e,t.param);r(t.body,e,"Statement");var s=Tt.definitions.ecma5;s&&n.isEmpty()&&at(s["Error.prototype"]).propagate(n,6)}else r(t.param,S(e),"Pattern")},VariableDeclaration:function(t,e,r){for(var n="var"==t.kind?g(e):e,s=0;s<t.declarations.length;++s){var i=t.declarations[s];r(i.id,S(n,e),"Pattern"),i.init&&r(i.init,e,"Expression")}},ClassDeclaration:function(t,e,r){w(e,t.id),t.superClass&&r(t.superClass,e,"Expression");for(var n=0;n<t.body.body.length;n++)r(t.body.body[n],e)},ForInStatement:function(t,e,r){!t.scope&&A(t.left)&&(e=t.scope=new St(e,t,!0)),n.base.ForInStatement(t,e,r)},ForStatement:function(t,e,r){!t.scope&&t.init&&A(t.init)&&(e=t.scope=new St(e,t,!0)),n.base.ForStatement(t,e,r)},ImportDeclaration:function(t,e){for(var r=0;r<t.specifiers.length;r++)w(e,t.specifiers[r].local)}});Nt.ForOfStatement=Nt.ForInStatement;var Ct=t.propName=function(t,e){var r=t.property||t.key;if(!t.computed&&"Identifier"==r.type)return r.name;if("Literal"==r.type){if("string"==typeof r.value)return r.value;if("number"==typeof r.value)return String(r.value)}if(e){var n=P(q(r,e));if(n)return t.propName=n}else if(t.propName)return t.propName;return"<i>"},Lt=t.inferPatternVisitor={Identifier:function(t,e,r){r.propagate(_(t,e))},MemberExpression:function(t,e,r){var n=q(t.object,e),s=Ct(t,e);n.propagate(new rt(s,r,t.property))},RestElement:function(t,e,r){F(t.argument,e,new bt(r))},ObjectPattern:function(t,e,r){for(var n=0;n<t.properties.length;++n){var s=t.properties[n];F(s.value,e,r.getProp(Ct(s)))}},ArrayPattern:function(t,e,r){for(var n=0;n<t.elements.length;n++)t.elements[n]&&F(t.elements[n],e,r.getProp(String(n)))},AssignmentPattern:function(t,e,r){F(t.left,e,I(r,q(t.right,e)))}},It=t.inferExprVisitor={ArrayExpression:V(function(t,e){return M(t.elements,e,q)}),ObjectExpression:V(function(t,e,r){for(var n,s=Tt.protos.Object,i=0;i<t.properties.length;++i){var o=t.properties[i];if("__proto__"==o.key.name)if("Literal"==o.value.type&&null==o.value.value)s=null;else{var a=q(o.value,e),p=a.getObjType();p?s=p:n=a}}var u=t.objType=new gt(s,r);return n&&n.propagate(new ft(u)),u.originNode=t,m(null,n||s,function(){for(var r=0;r<t.properties.length;++r){var n=t.properties[r],s=n.key;if(!l(n.key.name)){var i,o=Ct(n,e);if("<i>"==o||"set"==n.kind)i=K;else{var a=i=u.defProp(o,s);a.initializer=!0,"get"==n.kind&&(i=new st(u,[],null,a))}q(n.value,e,i,o),"FunctionExpression"==n.value.type&&n.value.scope.fnType.self.addType(u,2)}}}),u}),FunctionExpression:V(function(t,e,r){var s=t.scope,i=s.fnType;return r&&!i.name&&(i.name=r),O(t,s),t.expression?q(t.body,s,s.fnType.retval=new Z):n.recursive(t.body,s,null,Ot,"Statement"),"ArrowFunctionExpression"==t.type&&j(e).propagate(i.self),b(t,i)||T(i),t.id&&s.getProp(t.id.name).addType(i),i}),ClassExpression:V(D),SequenceExpression:V(function(t,e){for(var r=0,n=t.expressions.length-1;r<n;++r)q(t.expressions[r],e,K);return q(t.expressions[n],e)}),UnaryExpression:V(function(t,e){return q(t.argument,e,K),N(t.operator)}),UpdateExpression:V(function(t,e){return q(t.argument,e,K),Tt.num}),BinaryExpression:V(function(t,e){if("+"==t.operator){var r=q(t.left,e),n=q(t.right,e);if(r.hasType(Tt.str)||n.hasType(Tt.str))return Tt.str;if(r.hasType(Tt.num)&&n.hasType(Tt.num))return Tt.num;var s=new Z;return r.propagate(new ht(n,s)),n.propagate(new ht(r,s)),s}return q(t.left,e,K),q(t.right,e,K),C(t.operator)?Tt.bool:Tt.num}),AssignmentExpression:V(function(t,e,r){var n,s;if("MemberExpression"==t.left.type?(s=Ct(t.left,e),r||(r="Identifier"==t.left.object.type?t.left.object.name+"."+s:s)):r||"Identifier"!=t.left.type||(r=t.left.name),t.operator&&"="!=t.operator&&"+="!=t.operator?(q(t.right,e,K),n=Tt.num):n=q(t.right,e,null,r),"MemberExpression"==t.left.type){var i=q(t.left.object,e);if("prototype"==s&&v(e,20),"<i>"==s){var o=t.left.property.name,a=e.props[o],p=a&&a.iteratesOver;if(p){v(e,20);var u="MemberExpression"==t.right.type&&t.right.computed&&t.right.property.name==o;return p.forAllProps(function(t,e,r){r&&"prototype"!=t&&"<i>"!=t&&i.propagate(new rt(t,u?e:K))}),n}}i.propagate(new rt(s,n,t.left.property)),R(i),"FunctionExpression"==t.right.type&&i.propagate(t.right.scope.fnType.self,2)}else F(t.left,e,n);return n}),LogicalExpression:B(function(t,e,r){q(t.left,e,r),q(t.right,e,r)}),ConditionalExpression:B(function(t,e,r){q(t.test,e,K),q(t.consequent,e,r),q(t.alternate,e,r)}),NewExpression:B(function(t,e,r,n){"Identifier"==t.callee.type&&t.callee.name in e.props&&v(e,20);for(var s=0,i=[];s<t.arguments.length;++s)i.push(q(t.arguments[s],e));var o=q(t.callee,e),a=new Z;o.propagate(new ot(a,n&&/\.prototype$/.test(n))),a.propagate(r,90),o.propagate(new st(a,i,t.arguments,new ct(r)))}),CallExpression:B(function(t,e,r){for(var n=0,s=[];n<t.arguments.length;++n)s.push(q(t.arguments[n],e));var i=g(e).fnType;if("MemberExpression"==t.callee.type){var o=q(t.callee.object,e),a=Ct(t.callee,e);i&&("call"==a||"apply"==a)&&i.args.indexOf(o)>-1&&v(e,30),o.propagate(new it(a,s,t.arguments,r))}else if("Super"==t.callee.type&&Tt.curSuperCtor)t.callee.superType=Tt.curSuperCtor,Tt.curSuperCtor.propagate(new st(j(e),s,t.arguments,r)),j(e).propagate(r,90);else{var p=q(t.callee,e);i&&i.args.indexOf(p)>-1&&v(e,30);var u=p.getFunctionType();u&&u.instantiateScore&&i&&v(e,u.instantiateScore/5),p.propagate(new st(Tt.topScope,s,t.arguments,r))}}),MemberExpression:B(function(t,e,r){var n,s=Ct(t);if("<i>"==s){var i=q(t.property,e),o=P(i);o?s=t.propName=o:i.hasType(Tt.num)||(n=6)}q(t.object,e).getProp(s).propagate(r,n)}),Identifier:V(function(t,e){if("arguments"==t.name){var r=g(e,!1);!r.fnType||t.name in r.props||r.defProp(t.name,r.fnType.originNode).addType(new bt(r.fnType.arguments=new Z))}return e.getProp(t.name)}),ThisExpression:V(function(t,e){return j(e)}),Super:V(function(t){return t.superType=Tt.curSuper||K}),Literal:V(function(t){return L(t)}),TemplateLiteral:V(function(t,e){for(var r=0;r<t.expressions.length;++r)q(t.expressions[r],e,K);return Tt.str}),TaggedTemplateExpression:B(function(t,e,r){for(var n=[new bt(Tt.str)],s=0;s<t.quasi.expressions.length;++s)n.push(q(t.quasi.expressions[s],e));q(t.tag,e,new st(Tt.topScope,n,t.quasi.expressions,r))}),YieldExpression:V(function(t,e){var r=K,n=g(e).fnType;return n&&(n.retval==K&&(n.retval=new Z),n.yieldval||(n.yieldval=new Z),r=n.retval),t.argument&&(t.delegate?q(t.argument,e,new it("next",[],null,new et("value",r))):q(t.argument,e,r)),n?n.yieldval:K})};It.ArrowFunctionExpression=It.FunctionExpression;var Ot=t.inferWrapper=n.make({Expression:function(t,e){q(t,t.scope||e,K)},FunctionDeclaration:function(t,e,r){var n=t.scope,s=n.fnType;O(t,n),r(t.body,n,"Statement"),b(t,s)||T(s),e.getProp(t.id.name).addType(s)},Statement:function(t,e,r){r(t,t.scope||e)},VariableDeclaration:function(t,e){for(var r=0;r<t.declarations.length;++r){var n=t.declarations[r];if("Identifier"==n.id.type){var s=e.getProp(n.id.name);n.init&&q(n.init,e,s,n.id.name)}else n.init&&F(n.id,e,q(n.init,e))}},ClassDeclaration:function(t,e){e.getProp(t.id.name).addType(D(t,e,t.id.name))},ReturnStatement:function(t,e){if(t.argument){var r=K,n=g(e).fnType;n&&(n.retval==K&&(n.retval=new Z),r=n.retval),q(t.argument,e,r)}},ForInStatement:function(t,e,r){var n=q(t.right,e);if("Identifier"==t.right.type&&t.right.name in e.props||"MemberExpression"==t.right.type&&"prototype"==t.right.property.name){v(e,5);var s=U(t.left);"Identifier"==s.type?(s.name in e.props&&(e.getProp(s.name).iteratesOver=n),n.getProp("<i>").propagate(_(s,e))):F(s,e,n.getProp("<i>"))}r(t.body,e,"Statement")},ForOfStatement:function(t,e,r){var n,s=U(t.left);"Identifier"==s.type?n=_(s,e):F(s,e,n=new Z),q(t.right,e,new it(":Symbol.iterator",[],null,new it("next",[],null,new et("value",n)))),r(t.body,e,"Statement")}}),_t=t.parse=function(t,n,s){n&&!Array.isArray(n)||(n=s);var i;try{i=e.parse(t,n)}catch(e){i=r.parse_dammit(t,n)}return i};t.analyze=function(e,r,s){"string"==typeof e&&(e=_t(e)),r||(r="file#"+Tt.origins.length),t.addOrigin(Tt.curOrigin=r),s||(s=Tt.topScope),Tt.startAnalysis(),n.recursive(e,s,null,Nt),Tt.parent&&Tt.parent.signal("preInfer",e,s),n.recursive(e,s,null,Ot),Tt.parent&&Tt.parent.signal("postInfer",e,s),Tt.curOrigin=null},t.purge=function(t,e,r){var n=W(t,e,r);++Tt.purgeGen,Tt.topScope.purge(n);for(var s in Tt.props){for(var i=Tt.props[s],o=0;o<i.length;++o){var a=i[o],p=a.props[s];p&&!n(p,p.originNode)||i.splice(o--,1)}i.length||delete Tt.props[s]}},Z.prototype.purge=function(t){if(this.purgeGen!=Tt.purgeGen){this.purgeGen=Tt.purgeGen;for(var e=0;e<this.types.length;++e){var r=this.types[e];t(r,r.originNode)?this.types.splice(e--,1):r.purge(t)}if(this.types.length||(this.maxWeight=0),this.forward)for(var e=0;e<this.forward.length;++e){var n=this.forward[e];t(n)?(this.forward.splice(e--,1),this.props&&(this.props=null)):n.purge&&n.purge(t)}}},K.purge=function(){},gt.prototype.purge=function(t){if(this.purgeGen==Tt.purgeGen)return!0;this.purgeGen=Tt.purgeGen;for(var e in this.props){var r=this.props[e];t(r,r.originNode)&&this.removeProp(e),r.purge(t)}},xt.prototype.purge=function(t){if(!gt.prototype.purge.call(this,t)){this.self.purge(t),this.retval.purge(t);for(var e=0;e<this.args.length;++e)this.args[e].purge(t)}};var Ft=t.typeFinder={ArrayExpression:function(t,e){return M(t.elements,e,Q)},ObjectExpression:function(t){return t.objType},ClassExpression:function(t){return t.objType},FunctionExpression:function(t){return t.scope.fnType},ArrowFunctionExpression:function(t){return t.scope.fnType},SequenceExpression:function(t,e){return Q(t.expressions[t.expressions.length-1],e)},UnaryExpression:function(t){return N(t.operator)},UpdateExpression:function(){return Tt.num},BinaryExpression:function(t,e){if(C(t.operator))return Tt.bool;if("+"==t.operator){var r=Q(t.left,e),n=Q(t.right,e);if(r.hasType(Tt.str)||n.hasType(Tt.str))return Tt.str}return Tt.num},AssignmentExpression:function(t,e){return Q(t.right,e)},LogicalExpression:function(t,e){var r=Q(t.left,e);return r.isEmpty()?Q(t.right,e):r},ConditionalExpression:function(t,e){var r=Q(t.consequent,e);return r.isEmpty()?Q(t.alternate,e):r},NewExpression:function(t,e){
var r=Q(t.callee,e).getFunctionType(),n=r&&r.getProp("prototype").getObjType();return n?at(n,r):K},CallExpression:function(t,e){return H(t.callee,t.arguments,e)},MemberExpression:function(t,e){var r=Ct(t),n=Q(t.object,e).getType();return n?n.getProp(r):"<i>"==r?K:z(r)},MethodDefinition:function(t){var e=Ct(t),r=j(t.value.scope).getType();return r?r.getProp(e):K},Identifier:function(t,e){return e.hasProp(t.name)||K},ThisExpression:function(t,e){return j(e)},Literal:function(t){return L(t)},Super:V(function(t){return t.superType}),TemplateLiteral:function(){return Tt.str},TaggedTemplateExpression:function(t,e){return H(t.tag,t.quasi.expressions,e)},YieldExpression:function(t,e){var r=g(e).fnType;return r?r.yieldval:K}},jt=t.searchVisitor=n.make({Function:function(t,e,r){n.base.Function(t,t.scope,r)},CatchClause:function(t,e,r){n.base.CatchClause(t,t.scope,r)},Property:function(t,e,r){t.computed&&r(t.key,e,"Expression"),t.key!=t.value&&r(t.value,e,"Expression")},Statement:function(t,e,r){r(t,t.scope||e)},ImportSpecifier:function(t,e,r){r(t.local,e)},ImportDefaultSpecifier:function(t,e,r){r(t.local,e)},ImportNamespaceSpecifier:function(t,e,r){r(t.local,e)}});t.fullVisitor=n.make({MemberExpression:function(t,e,r){r(t.object,e,"Expression"),r(t.property,e,t.computed?"Expression":null)},Property:function(t,e,r){t.computed&&r(t.key,e,"Expression"),r(t.value,e,"Expression")}},jt),t.findExpressionAt=function(t,e,r,s,i){var o=i||function(t,e){return("Identifier"!=e.type||"✖"!=e.name)&&Ft.hasOwnProperty(e.type)};return n.findNodeAt(t,e,r,o,jt,s||Tt.topScope)},t.findExpressionAround=function(t,e,r,s,i){var o=i||function(t,r){return!(null!=e&&r.start>e)&&(("Identifier"!=r.type||"✖"!=r.name)&&Ft.hasOwnProperty(r.type))};return n.findNodeAround(t,r,o,jt,s||Tt.topScope)},t.expressionType=function(t){return Q(t.node,t.state)},t.parentNode=function(t,e){function r(e,i,o){if(e.start<=t.start&&e.end>=t.end){var a=s[s.length-1];if(e==t)throw{found:a};a!=e&&s.push(e),n.base[o||e.type](e,i,r),a!=e&&s.pop()}}var s=[];try{r(e,null)}catch(t){if(t.found)return t.found;throw t}};var Rt=t.findTypeFromContext={ArrayExpression:function(t,e,r){return r(t,!0).getProp("<i>")},ObjectExpression:function(t,e,r){for(var n=0;n<t.properties.length;++n){var s=e.properties[n];if(s.value==e)return r(t,!0).getProp(Ct(s))}},UnaryExpression:function(t){return N(t.operator)},UpdateExpression:function(){return Tt.num},BinaryExpression:function(t){return C(t.operator)?Tt.bool:Tt.num},AssignmentExpression:function(t,e,r){return r(t.left)},LogicalExpression:function(t,e,r){return r(t,!0)},ConditionalExpression:function(t,e,r){if(t.consequent==e||t.alternate==e)return r(t,!0)},CallExpression:function(t,e,r){for(var n=0;n<t.arguments.length;n++){if(t.arguments[n]==e){var s=r(t.callee).getFunctionType();if(s instanceof xt)return s.args[n];break}}},ReturnStatement:function(t,e,r){var s=n.findNodeAround(e.sourceFile.ast,e.start-1,"Function");if(s){var i="FunctionDeclaration"!=s.node.type?r(s.node,!0).getFunctionType():s.node.scope.fnType;if(i)return i.retval.getType()}},VariableDeclarator:function(t,e,r){if(t.init==e)return r(t.id)}};Rt.NewExpression=Rt.CallExpression,t.typeFromContext=function(e,r){var n=t.parentNode(r.node,e),s=null;if(Rt.hasOwnProperty(n.type)){var i=Rt[n.type];s=i&&i(n,r.node,function(n,s){var i={node:n,state:r.state};return(s?t.typeFromContext(e,i):t.expressionType(i))||K})}return s||t.expressionType(r)};var Dt=!1;t.resetGuessing=function(t){Dt=t},t.didGuess=function(){return Dt},t.forAllPropertiesOf=function(t,e){t.gatherProperties(e,0)},t.findRefs=function(e,r,s,i,o){function a(t,r,n){if(t.name==s&&(t!=e.id||"FunctionDeclaration"!=e.type))for(var a=r;a;a=a.prev)if(a==i&&o(t,r,n),s in a.props)return}n.ancestor(e,{Identifier:a,VariablePattern:a},t.fullVisitor,r)};var Mt=n.make({Function:function(t,e,r){r(t.body,t.scope,t.expression?"Expression":"Statement")},Statement:function(t,e,r){r(t,t.scope||e)}});t.findPropRefs=function(t,e,r,s,i){function o(t){for(;t&&t!=r;){if(t.props[s]||t.maybeProps&&t.maybeProps[s])return!1;t=t.proto}return t}for(;r&&!r.props[s]&&(!r.maybeProps||!r.maybeProps[s]);)r=r.proto;if(!r)throw new Error("Couldn't locate property in the base object type.");n.simple(t,{MemberExpression:function(t,e){t.computed||Ct(t)!=s||o(Q(t.object,e).getType())&&i(t.property,e)},ObjectExpression:function(t,e){if(Q(t,e).getType()==r)for(var n=0;n<t.properties.length;++n)Ct(t.properties[n])==s&&i(t.properties[n].key,e)},MethodDefinition:function(t){Ct(t)==s&&t.value&&o(j(t.value.scope).getType())&&i(t.key,t.value.scope)}},Mt,e)};var Vt=t.scopeAt=function(t,e,r){var s=n.findNodeAround(t,e,function(t,e){return e.scope});return s?s.node.scope:r||Tt.topScope};t.forAllLocalsAt=function(t,e,r,n){Vt(t,e,r).gatherProperties(n,0)},s=t.def=s.init({},t)}),function(t){"object"==typeof exports&&"object"==typeof module?t(require("../lib/infer"),require("../lib/tern"),require("../lib/comment"),require("acorn"),require("acorn/dist/walk")):"function"==typeof define&&define.amd?define(["../lib/infer","../lib/tern","../lib/comment","acorn/dist/acorn","acorn/dist/walk"],t):t(tern,tern,tern.comment,acorn,acorn.walk)}(function(t,e,r,n,s){"use strict";function i(t,e){function n(t){r.ensureCommentsBefore(e,t)}s.simple(t,{VariableDeclaration:n,FunctionDeclaration:n,MethodDefinition:n,Property:n,AssignmentExpression:function(t){"="==t.operator&&n(t)},CallExpression:function(t){o(t)&&n(t)},ExportNamedDeclaration:function(t){n(t)},ExportDefaultDeclaration:function(t){n(t)}})}function o(t){return"MemberExpression"==t.callee.type&&"Object"==t.callee.object.name&&"defineProperty"==t.callee.property.name&&t.arguments.length>=3&&"string"==typeof t.arguments[1].value}function a(e,r){b(e.sourceFile.text,r),s.simple(e,{VariableDeclaration:function(t,e){var r=t.declarations[0].id;t.commentsBefore&&"Identifier"==r.type&&h(t,t.commentsBefore,e,e.getProp(t.declarations[0].id.name))},FunctionDeclaration:function(t,e){t.commentsBefore&&h(t,t.commentsBefore,e,e.getProp(t.id.name),t.scope.fnType)},ClassDeclaration:function(t,e){t.commentsBefore&&h(t,t.commentsBefore,e,e.getProp(t.id.name),t.objType)},AssignmentExpression:function(e,r){e.commentsBefore&&h(e,e.commentsBefore,r,t.expressionType({node:e.left,state:r}))},ObjectExpression:function(e,r){for(var n=0;n<e.properties.length;++n){var s=e.properties[n],i=t.propName(s);"<i>"!=i&&s.commentsBefore&&h(s,s.commentsBefore,r,e.objType.getProp(i))}},Class:function(e,r){var n=e.objType.getProp("prototype").getObjType();if(n)for(var s=0;s<e.body.body.length;s++){var i,o=e.body.body[s];o.commentsBefore&&("constructor"==o.kind?h(o,o.commentsBefore,r,e.objType):"<i>"!=(i=t.propName(o))&&h(o,o.commentsBefore,r,n.getProp(i)))}},CallExpression:function(e,r){if(e.commentsBefore&&o(e)){var n=t.expressionType({node:e.arguments[0],state:r}).getObjType();if(n&&n instanceof t.Obj){var s=n.props[e.arguments[1].value];s&&h(e,e.commentsBefore,r,s)}}},ExportNamedDeclaration:function(t,e){t.commentsBefore&&t.declaration&&"FunctionDeclaration"===t.declaration.type&&h(t.declaration,t.commentsBefore,e,e.getProp(t.declaration.id.name),t.declaration.scope.fnType)},ExportDefaultDeclaration:function(t,e){t.commentsBefore&&t.declaration&&"FunctionDeclaration"===t.declaration.type&&h(t.declaration,t.commentsBefore,e,e.getProp(t.declaration.id.name),t.declaration.scope.fnType)}},t.searchVisitor,r)}function p(e){var r=e["!typedef"],n=t.cx(),s=e["!name"];if(r)for(var i in r)n.parent.mod.jsdocTypedefs[i]=g(t.def.parse(r[i],s,i),i)}function u(t){for(var e,r=1;r<t.length;r++){var n=t[r],s=n.match(/^[\s\*]*/)[0];if(s!=n)if(null==e)e=s;else{for(var i=0;i<e.length&&e.charCodeAt(i)==s.charCodeAt(i);)++i;i<e.length&&(e=e.slice(0,i))}}for(t=t.map(function(t,r){if(t=t.replace(/\s+$/,""),0==r&&null!=e)for(var n=0;n<e.length;n++){var s=t.indexOf(e.slice(n));if(0==s)return t.slice(e.length-n)}return null==e||0==r?t.replace(/^[\s\*]*/,""):t.length<e.length?"":t.slice(e.length)});t.length&&!t[t.length-1];)t.pop();for(;t.length&&!t[0];)t.shift();return t}function h(e,r,n,s,i){x(e,n,s,r);var o=t.cx();!i&&s instanceof t.AVal&&s.types.length&&((i=s.types[s.types.length-1])instanceof t.Obj&&i.origin==o.curOrigin&&!i.doc||(i=null));for(var a=r.length-1;a>=0;a--){var p=u(r[a].split(/\r\n?|\n/)).join("\n");if(p){s instanceof t.AVal&&(s.doc=p),i&&(i.doc=p);break}}}function c(t,e){for(;/\s/.test(t.charAt(e));)++e;return e}function l(t){if(!n.isIdentifierStart(t.charCodeAt(0)))return!1;for(var e=1;e<t.length;e++)if(!n.isIdentifierChar(t.charCodeAt(e)))return!1;return!0}function f(t,e,r,n){for(var s=[],i=[],o=!1,a=!0;r=c(e,r),!a||e.charAt(r)!=n;a=!1){var p=e.indexOf(":",r);if(p<0)return null;var u=e.slice(r,p);if(!l(u))return null;s.push(u),r=p+1;var h=y(t,e,r);if(!h)return null;r=h.end,o=o||h.madeUp,i.push(h.type),r=c(e,r);var f=e.charAt(r);if(++r,f==n)break;if(","!=f)return null}return{labels:s,types:i,end:r,madeUp:o}}function d(e,r,n){var s=m(e,r,n);return s?"[]"==r.slice(s.end,s.end+2)?{madeUp:s.madeUp,end:s.end+2,type:new t.Arr(s.type)}:s:null}function y(e,r,n){for(var s,i=!1,o=!1;;){var a=d(e,r,n);if(!a)return null;if(o=o||a.madeUp,i?a.type.propagate(i):s=a.type,n=c(r,a.end),"|"!=r.charAt(n))break;n++,i||(i=new t.AVal,s.propagate(i),s=i)}var p=!1;return"="==r.charAt(n)&&(++n,p=!0),{type:s,end:n,isOptional:p,madeUp:o}}function m(e,r,s){s=c(r,s);var i,o=!1;if(r.indexOf("function(",s)==s){var a=f(e,r,s+9,")"),p=t.ANull;if(!a)return null;if(s=c(r,a.end),":"==r.charAt(s)){++s;var u=y(e,r,s+1);if(!u)return null;s=u.end,p=u.type,o=u.madeUp}i=new t.Fn(null,t.ANull,a.types,a.labels,p)}else if("["==r.charAt(s)){var h=y(e,r,s+1);if(!h)return null;if(s=c(r,h.end),o=h.madeUp,"]"!=r.charAt(s))return null;++s,i=new t.Arr(h.type)}else if("{"==r.charAt(s)){var l=f(e,r,s+1,"}");if(!l)return null;i=new t.Obj(!0);for(var d=0;d<l.types.length;++d){var m=i.defProp(l.labels[d]);m.initializer=!0,l.types[d].propagate(m)}s=l.end,o=l.madeUp}else if("("==r.charAt(s)){var h=y(e,r,s+1);if(!h)return null;if(s=c(r,h.end),")"!=r.charAt(s))return null;++s,i=h.type}else{var v=s;if(!n.isIdentifierStart(r.charCodeAt(s)))return null;for(;n.isIdentifierChar(r.charCodeAt(s));)++s;if(v==s)return null;var x=r.slice(v,s);if(/^(number|integer)$/i.test(x))i=t.cx().num;else if(/^bool(ean)?$/i.test(x))i=t.cx().bool;else if(/^string$/i.test(x))i=t.cx().str;else if(/^(null|undefined)$/i.test(x))i=t.ANull;else if(/^array$/i.test(x)){var h=null;if("."==r.charAt(s)&&"<"==r.charAt(s+1)){var b=y(e,r,s+2);if(!b)return null;if(s=c(r,b.end),o=b.madeUp,">"!=r.charAt(s++))return null;h=b.type}i=new t.Arr(h)}else if(/^object$/i.test(x)){if(i=new t.Obj(!0),"."==r.charAt(s)&&"<"==r.charAt(s+1)){var k=y(e,r,s+2);if(!k)return null;if(s=c(r,k.end),o=o||k.madeUp,","!=r.charAt(s++))return null;var T=y(e,r,s);if(!T)return null;if(s=c(r,T.end),o=k.madeUp||T.madeUp,">"!=r.charAt(s++))return null;T.type.propagate(i.defProp("<i>"))}}else{for(;46==r.charCodeAt(s)||n.isIdentifierChar(r.charCodeAt(s));)++s;var w,E=r.slice(v,s),A=t.cx(),S=A.parent&&A.parent.mod.jsdocTypedefs;S&&E in S?i=S[E]:(w=t.def.parsePath(E,e).getObjType())?i=g(w,E):(A.jsdocPlaceholders||(A.jsdocPlaceholders=Object.create(null)),i=E in A.jsdocPlaceholders?A.jsdocPlaceholders[E]:A.jsdocPlaceholders[E]=new t.Obj(null,E),o=!0)}}return{type:i,end:s,madeUp:o}}function g(e,r){if(e instanceof t.Fn&&/(?:^|\.)[A-Z][^\.]*$/.test(r)){var n=e.getProp("prototype").getObjType();if(n instanceof t.Obj)return t.getInstance(n)}return e}function v(t,e,r){if(r=c(e,r||0),"{"!=e.charAt(r))return null;var n=y(t,e,r+1);if(!n)return null;var s=c(e,n.end);return"}"!=e.charAt(s)?null:(n.end=s+1,n)}function x(t,e,r,n){for(var s,i,o,a,p,u,h=0;h<n.length;++h)for(var c,l=n[h],f=/(?:\n|$|\*)\s*@(type|param|arg(?:ument)?|returns?|this|class|constructor)\s+(.*)/g;c=f.exec(l);)if("class"!=c[1]&&"constructor"!=c[1]){if("this"==c[1]&&(u=y(e,c[2],0)))p=u,a=!0;else if(u=v(e,c[2]))switch(a=!0,c[1]){case"returns":case"return":o=u;break;case"type":s=u;break;case"param":case"arg":case"argument":var d=c[2].slice(u.end).match(/^\s*(\[?)\s*([^\]\s=]+)\s*(?:=[^\]]+\s*)?(\]?).*/);if(!d)continue;var m=d[2]+(u.isOptional||"["===d[1]&&"]"===d[3]?"?":"");(i||(i=Object.create(null)))[m]=u}}else p=a=!0;a&&w(s,p,i,o,t,r)}function b(e,r){for(var n,s=t.cx(),i=/\s@typedef\s+(.*)/g;n=i.exec(e);){var o=v(r,n[1]),a=o&&n[1].slice(o.end).match(/^\s*(\S+)/);if(a&&o.type instanceof t.Obj){for(var p=e.slice(n.index+n[0].length);n=/\s+@prop(?:erty)?\s+(.*)/.exec(p);){var u,h=v(r,n[1]);h&&(u=n[1].slice(h.end).match(/^\s*(\S+)/))&&h.type.propagate(o.type.defProp(u[1])),p=p.slice(n[0].length)}s.parent.mod.jsdocTypedefs[a[1]]=o.type}}}function k(e,r){var n=t.cx().parent.mod.docComment.weight;e.type.propagate(r,n||(e.madeUp?E:void 0))}function T(t){return"FunctionExpression"==t.type||"ArrowFunctionExpression"==t.type}function w(e,r,n,s,i,o){var a;if("VariableDeclaration"==i.type){var p=i.declarations[0];p.init&&T(p.init)&&(a=p.init.scope.fnType)}else"FunctionDeclaration"==i.type?a=i.scope.fnType:"AssignmentExpression"==i.type?T(i.right)&&(a=i.right.scope.fnType):"CallExpression"==i.type||T(i.value)&&(a=i.value.scope.fnType);if(a&&(n||s||r)){if(n)for(var u=0;u<a.argNames.length;++u){var h=a.argNames[u],c=n[h];!c&&(c=n[h+"?"])&&(a.argNames[u]+="?"),c&&k(c,a.args[u])}if(s&&(a.retval==t.ANull&&(a.retval=new t.AVal),k(s,a.retval)),!0===r){var l=a.getProp("prototype").getObjType();r=l&&{type:t.getInstance(l,a)}}r&&k(r,a.self)}else e&&k(e,o)}var E=1;e.registerPlugin("doc_comment",function(t,e){t.mod.jsdocTypedefs=Object.create(null),t.on("reset",function(){t.mod.jsdocTypedefs=Object.create(null)}),t.mod.docComment={weight:e&&e.strong?101:void 0,fullDocs:e&&e.fullDocs},t.on("postParse",i),t.on("postInfer",a),t.on("postLoadDef",p)})});